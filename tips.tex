%! TEX root = CS_tips.tex

%% Some random tips for bash and common commands. You'll find computer languages and git tips too.
%%
%% Copyright 2020 Riccardo Milani
%%
%% Licensed under the "THE BEER-WARE LICENSE" (Revision 42):
%% Riccardo Milani wrote this file. As long as you retain this notice you
%% can do whatever you want with this stuff. If we meet some day, and you think
%% this stuff is worth it, you can buy me a beer or coffee in return


\documentclass[a4paper,12pt,%
              final%
              %draft%
              ]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fancyvrb}

\usepackage{xcolor}
\definecolor{BlueX}{RGB}{0,62,92}
\xdefinecolor{lGreenRT}{RGB}{0,180,110}

\usepackage[top=2cm, bottom=2cm, left=1cm, right=1cm]{geometry}

%\renewcommand{\ttdefault}{pcr}
\usepackage{listings}
\lstset{%
  basicstyle=\ttfamily,
  keywordstyle=\color{lGreenRT},
}
\usepackage[normalem]{ulem}

\usepackage{hyperref}

\usepackage[inline]{enumitem}
%
\begin{document}

% Title
\begin{center}
\bfseries \scshape \Huge \color{BlueX}%
Tips \& stuff
\end{center}
%
\vspace*{\baselineskip}

Some tips about terminal commands (\texttt{sed}, \texttt{grep}\ldots) and languages (\texttt{C}, \texttt{python}\ldots) are given here. For terminal commands, mind that you can access the related \emph{man}ual/help page by running
\begin{lstlisting}[language=bash]
man <cmd>
\end{lstlisting}
or sometimes
\begin{lstlisting}[language=bash]
<cmd> --help
\end{lstlisting}

\emph{Notations and conventions.} You will find stuff inside angle brackets (like this \verb|<.>|): this is something that you can choose. You will also find other stuff within square brackets (like this \verb|[.]|, and they can be nested): this indicates something that is optional.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Shell}
\label{sec:shell}
There are different version of shells scripting, such as \texttt{bash}, \texttt{sh}, \texttt{zsh}; they have some differences in commands and syntax (but I do not know them \verb|\o/|). I will use \texttt{bash}.

\subsection{Shell (\texttt{bash}) basics}
In this section, we cover basic stuff about the shell. For useful terminal commands and tools, see the next sub-sections.
\begin{itemize}
  \item Of course I'm not the first to write tips, and certainly not the one who knows the most, so here a couples of tips lists, especially about shortcuts: \href{https://www.techrepublic.com/article/20-terminal-shortcuts-developers-need-to-know/}{here} and \href{https://www.howtogeek.com/howto/ubuntu/keyboard-shortcuts-for-bash-command-shell-for-ubuntu-debian-suse-redhat-linux-etc/}{here} and \href{https://devhints.io/bash}{here}.
    \begin{itemize}
      \item Cut \& yank: \texttt{<C-K>} cut (or \emph{k}ill) from cursor to end of line, \texttt{<C-U>} cut from cursor to beginning of line, \texttt{<C-W>} cut (blank-delimited) word just before the cursor, \texttt{<C-Y>} yank (paste).
      \item \texttt{<C-S-E>}: expand alias.
      \item \texttt{<C-R>}: search in the command history while typing.
      \item \texttt{<A-.>}: insert arguments of the previous (run) command;
      \item \texttt{<C-X-E>}: continue editing the bash command you are writing in the predefined editor.
      \item \texttt{!}: repeat stuff as explained \href{https://www.redhat.com/sysadmin/bash-bang-commands}{here}.
      \item Use braces (curly brackets) \verb|{ }| to save typing. Examples
        \begin{itemize}
          \item \verb|cp file_{orig,bkp}| expands to \verb|cp file_orig file_bkp|
          \item \verb|evince work{1,2,3}.pdf| expands to \verb|evince work1.pdf work2.pdf work3.pdf|
        \end{itemize}
    \end{itemize}
  \item Variables
    \begin{itemize}
      \item To set / declare a variable just use implicit declaration: \verb|foo="BAR"|.
      \item For strings with whitespaces in them, one should quote them otherwise they will be split and the subsequent parts of the string after a whitespace will be treated as commands. For instance: \verb|string="A string with spaces"|
      \item To access the value of a variable use the dollar sign, \verb|$|, e.g. \verb|foo=bar; echo $foo| prints \texttt{bar}
        \begin{itemize}
          \item It is good practice to put the name of the variable inside braces: \verb|${foo}|. This avoids substitution problems. E.g., suppose we have \verb|foo=bar| and want to write \texttt{baz} just after the value of \texttt{foo}
            \begin{itemize}
              \item The following will try to get the value of variable \texttt{foobaz} which does not exist, hence printing nothing
\begin{lstlisting}[language=bash]
echo $foobaz
# Prints nothing
\end{lstlisting}
              \item Using braces, one obtains the wished result
\begin{lstlisting}[language=bash]
echo ${foo}baz
# Prints barbaz
\end{lstlisting}
            \end{itemize}
        \end{itemize}
      \item Scope: the scope of a standard variable is its script. But there are way to change this
        \begin{itemize}
          \item Local variables: variable declared in this way inside a function, are only visible inside the same function: \verb|local foo="Bar"|
          \item Environment variables: use \texttt{export}
\begin{lstlisting}[language=bash]
# Typical usage
export $PATH=/new/path:$PATH
# For a function, use -f
function foo() { echo "Ciao"; }
export -f foo
# Remove export property
export -n foo
\end{lstlisting}
        \end{itemize}
      \item Some built-in variables:
        \begin{itemize}
          \item \verb|$#|: number of arguments passed to the script
          \item \verb|$<n>|: argument \texttt{n}. It is 1-based, in fact \verb|$0| expands to shell / script's name
          \item \verb|$@|: all arguments. You can use it in a list: \verb|for arg in "${@}"|. When quoted, it extends to singularly quoted arguments: \verb|"$@"| expands to \verb|"$1" "$2"|\ldots
          \item \verb|$*|: all arguments. It is similar to \verb|$@|, however, when quoted, it extends to all arguments quoted inside the same quotes: \verb|"$*"| expands to \verb|"$1 $2 ..."|
          \item \verb|$!|: expands to the last run process's ID
          \item \verb|$?|: return value of last command. You can store it \verb|ret_val=$?| or use it directly
\begin{lstlisting}[language=bash]
some_command
if [ $? -eq 0 ]; then
  echo OK
else
  echo FAIL
fi
\end{lstlisting}
        \end{itemize}
      \item Variables are not usually typed (there is no distinction between integers, string,\ldots). However, sometimes we'd like to have this, one can then use \texttt{declare}. Some options and tricks:
        \begin{itemize}
          \item \verb|-r|: declare a \emph{r}eadonly variable
          \item \verb|-i|: declare an \emph{i}nteger variable (gives 0 if not integer)
          \item \verb|-a|: declare an \emph{a}rray
          \item \verb|-f|: declare a \emph{f}unction
          \item \verb|-e|: declare an ``\emph{e}xport'' (that's actually what \texttt{export var} does)
        \end{itemize}
\begin{lstlisting}[language=bash]
declare -i n_iter
n_iter=5
declare -r ro="readonly"
\end{lstlisting}
      \item Command \verb|let <expression>| can be used to define arithmetic variables
\begin{lstlisting}[language=bash]
let "foo = 1" "bar = foo + 2" "foo++"; echo "$foo, $bar" # 2, 3
\end{lstlisting}
    \end{itemize}
  \item Functions
\begin{lstlisting}[language=bash]
function foo() {
  # Variable
  foo="Foo"
  # Local variable, recommended
  local bar="Bar"
  # Using arguments
  first_arg=$1
  second_arg=$2
}
\end{lstlisting}
  \item Default applications: often we don't know the name of the programs that we use, for instance, for opening a pdf. Here some of them
    \begin{itemize}
      \item \texttt{evince} for pdf.
      \item \texttt{eog} for images.
      \item \texttt{nautilus} for file explorer.
    \end{itemize}
  \item Customize your terminal
    \begin{itemize}
      \item Pimp your \texttt{bash} by modifying the file \texttt{.bashrc} in your home (load modules that you want by default, set global variables,\ldots) and define personal shortcuts in \texttt{.bash\_aliases}, again in your home (verify that it is loaded in \texttt{.bashrc}).
      \item Preceding a terminal command with a backslash will tell the shell to run the command itself and not the alias with the same name if it exists.
      \item In \texttt{bash}, the keyboard combo \texttt{Ctrl+Alt+E} expands aliases and variables that you writing.
    \end{itemize}
  \item Run in background:
    \begin{itemize}
      \item Add a \verb|&| after a command to run it back ground, meaning that it won't block the terminal while running, so that you can still use the terminal window for other stuff. This is quite useful when opening GUI programs (e.g.\ \texttt{evince}).
      \item Precede your commands with \texttt{nohup} in order to have them running ever after the terminal window / session is closed. More \href{https://linux.101hacks.com/unix/nohup-command/}{here} or \href{https://hexadix.com/use-nohup-execute-commands-background-keep-running-exit-shell-promt/}{here}.
    \end{itemize}
  \item \texttt{echo}: print to screen
    \begin{itemize}
      \item Change colors: see \href{https://stackoverflow.com/questions/5947742/how-to-change-the-output-color-of-echo-in-linux}{here} (remember \verb|-e| and to ``close'' the color)
      \item Fonts: see \href{https://askubuntu.com/questions/528928/how-to-do-underline-bold-italic-strikethrough-color-background-and-size-i}{here} (see before)
    \end{itemize}
  \item Operator \texttt{*} expands to all the files whose name does not start with "\texttt{.}". Hence, hidden files (as well as current directory "\texttt{.}", and parent directory "\texttt{..}" are not included).
  \item Arithmetic operations: \verb|$((4*n+3))|, notice that once inside the variables do not need the \$ sign. As it is the case for operator \verb|[| (cf. \autoref{ssec:shell_tools}), \verb|((| is a shortcut for a command, precisely \href{https://www.computerhope.com/unix/bash/let.htm}{\texttt{let}}. On shell such as \texttt{bash} only integers arithmetics are allowed. Many alternatives are available, for instance using \texttt{awk} (\autoref{ssec:awk}) or \texttt{python} (\autoref{sec:python}) or \texttt{bc} (\autoref{ssec:shell_tools}). Others may be found \href{https://unix.stackexchange.com/questions/40786/how-to-do-integer-float-calculations-in-bash-or-other-languages-frameworks}{here}.
  \item Pipes: \verb!|! connects standard output of one command to standard input of another.
  \item File descriptors:
    \begin{enumerate}[start=0,label={\texttt{\arabic*} :}]
      \item Standard input
      \item Standard output
      \item Standard error
    \end{enumerate}
  \item Use output of commands (for instance, to define a variable or a command)
    \begin{itemize}
      \item Brackets: \verb|$(cmd)|
      \item Backticks: \verb|`cmd`|
    \end{itemize}
  \item \href{https://www.gnu.org/software/bash/manual/bash.html#Redirections}{Redirection}: use \verb|>| to redirect, \verb|>&| to duplicate and redirect
    \begin{itemize}
      \item Redirect \texttt{stdout} to \texttt{stderr}: \verb|<cmd> 1>&2|
      \item Redirect \texttt{stdout} and \texttt{stderr} to file: first we redirect \texttt{stdout} to a file then we tell to copy \texttt{stderr} to \texttt{stdout}
\begin{lstlisting}[language=bash]
<cmd> > file.log 2>&1
\end{lstlisting}
      \item Discard output: \texttt{<cmd> > /dev/null}.
      \item Pipe \texttt{stderr}. Aim: discard \texttt{stdout} and pipe \texttt{stderr}. \href{https://stackoverflow.com/questions/2342826/how-can-i-pipe-stderr-and-not-stdout}{Actions}: redirect \texttt{stderr} to \texttt{stdout}, discard \texttt{stdout}, pipe.
\begin{lstlisting}[language=bash]
cmd 2>&1 >/dev/null | pipe_receiver
\end{lstlisting}
      \item \verb|>| can be used to write to file: \verb|echo "Hello world!" > hello.txt| will write into the provided file. If the file already exists it will be replaced, otherwise it will be created. If you want to \emph{append} to the file just use \verb|>>|.
      \item You may want to check out \texttt{tee} in \ref{ssec:shell_tools}.
    \end{itemize}
  \item Input:
    \begin{itemize}
      \item \emph{Here}-strings: feed the content of a variable to a command with \verb|<<<|: \verb|grep [] <<< $var|
      \item \emph{Here}-documents: feed the content of a file created on-the-run to a command with  \verb|<<|:
\begin{lstlisting}[language=bash]
grep [] <<EOF
First line
Second line
EOF
\end{lstlisting}
        The keyword \texttt{EOF} is arbitrary (one can choose it freely) and delimits the beginning and the end of the document
    \end{itemize}
  \item Strings manipulation:
    \begin{itemize}
      \item A quick \href{https://sookocheff.com/post/bash/bash-string-operators/}{guide}, or the official \href{https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html}{manual}.
      \item Extract substring: \verb|${string:position:length}|. For more details have a look \href{https://stackoverflow.com/questions/1405611/how-to-extract-the-first-two-characters-of-a-string-in-shell-scripting}{here}.
      \item Remove pattern
        \begin{itemize}
          \item Starting match: shortest \verb|${variable#pattern}|; longest \verb|${variable##pattern}|
          \item Ending match: shortest \verb|${variable%pattern}|; longest \verb|${variable%%pattern}|
        \end{itemize}
      \item Replace pattern: first \verb|${variable/pattern/replace}|; all \verb|${variable//pattern/replace}|
      \item Operator \verb|=~|: \verb|${string} =~ ${regex}| gives true if \verb|string| matches the provided regex syntax.
    \end{itemize}
  \item In a script, adding at the beginning \verb|set -e| will make the script exit immediately as soon as one of its commands finishes with a non-zero status (when it fails).
  \item For option management \verb|getopts| is recommended, see \autoref{ssec:shell_tools}.
  \item Arrays: have a look \href{https://opensource.com/article/18/5/you-dont-know-bash-intro-bash-arrays}{here}.
    \begin{itemize}
      \item Definition: Use parentheses and whitespace as delimiter:
\begin{lstlisting}[language=bash]
arr=(one two three)
\end{lstlisting}
      \item Split string into array
        \begin{itemize}
          \item If delimiter is whitespace, simply use parentheses
\begin{lstlisting}[language=bash]
str="one two three"
arr=($str)
\end{lstlisting}
          \item Use \verb|read -a|, and \verb|IFS| to set the delimiter (default is whitespace). In recent version of bash, one can use \verb|readarray|
\begin{lstlisting}[language=bash]
str="one,two,three"
IFS="," read -a arr <<< $str
\end{lstlisting}
        \end{itemize}
      \item Access with \verb|${arr[$i]}|
      \item Get length: \verb|${#arr[@]}|
    \end{itemize}
  \item Conditional statements:
    \begin{itemize}
      \item Typical structure
\begin{lstlisting}[language=bash]
if <cond>
then
# These first two lines might be written in only one, join
# with semi-colon as follows:
# if <cond>; then
  <cmd>
else
  <cmd>
fi
\end{lstlisting}
      \item The above \verb|<cond>| can be written in several ways, see \href{https://unix.stackexchange.com/questions/306111/what-is-the-difference-between-the-bash-operators-vs-vs-vs}{here}. Some examples:
\begin{lstlisting}[language=bash]
if [ <cond> ]
if test <cond> # Same as above
if [[ <cond> ]]
if ((<cond>)) # Arithmetic evaluation
if (cmd) # Command run in a subshell
if cmd # Command run
\end{lstlisting}
      \item Remember: 0 is true, other is false
      \item \texttt{test} or operator \verb|[| (square brackets): test if an expression is true. A quick \href{https://www.computerhope.com/unix/test.htm}{guide}. But the \texttt{man} page is clear and concise, just use this one. A little syntax:
        \begin{itemize}
          \item Conditional \verb|!| negate, \verb!-a|-o! and/or
          \item Strings: \verb!-z|-n! true if zero | nonzero, compare with \verb|=| and \verb|!=|
          \item Integers: \verb|-eq| equal, \verb|-ne| not-equal, \verb!-gt|-ge! (resp.\ \verb!-lt|-le!) greater than | greater or equal (resp.\ less)
          \item Files: \verb!-ot|-nt! older|newer than, \verb|-e| exists, \verb|-f| regular file, \verb|-d| directory
          \item Combine: \verb|[ a = a ] && [ b = b ]|, for or use \verb!||!. To construct multilevel conditions, one should escape parentheses
          \item Mind: variable are split, hence, you might want to put them in quotes. Consider \verb|foo bar| vs.\ \verb|"foo bar"|
        \end{itemize}
      \item Operator \verb|[[| (double square brackets) is a \texttt{bash} improvement of \texttt{test}, and allows more stuff (see this \href{https://stackoverflow.com/a/47576482}{comparison}), such as:
        \begin{itemize}
          \item An important difference is that variable are NOT split
          \item Combine: \verb|[[ a = a && b = b ]]|
          \item \verb|$lhs =~ <regex>|: check if \verb|$lhs| match the given pattern
        \end{itemize}
      \item Empty and unset variables:
        \begin{itemize}
          \item Check for an UNSET variable: \verb|[ -z "${var+x}" ]| (from \href{https://stackoverflow.com/questions/3601515/how-to-check-if-a-variable-is-set-in-bash}{here})
          \item Check for an EMPTY variable: \verb|[[ -z $var ]]| or \verb|[[ ! $var ]]| (from \href{https://serverfault.com/questions/7503/how-to-determine-if-a-bash-variable-is-empty}{here})
          \item Check out this \href{https://stackoverflow.com/questions/3869072/test-for-non-zero-length-string-in-bash-n-var-or-var}{comparison}
\begin{lstlisting}[language=bash]
if [[ $var ]]; then
  # var is set and it is not empty
fi
if [[ ! $var ]]; then
  # var is not set or set to an empty string
fi
\end{lstlisting}
        \end{itemize}
    \end{itemize}
  \item Loops:
    \begin{itemize}
      \item For loops: have a look \href{https://www.cyberciti.biz/faq/bash-for-loop/}{here}. Quick examples:
\begin{lstlisting}[language=bash]
for n in one two three; do [...] done
# {START..END} or {START..END..INCREMENT}
for n in {1..10}; do [...] done
for n in {1..10..2}; do [...] done
# 3-expression form (( INIT; COND; STEP )), C-like
for (( n=0; n<10; n++ )); do [...] done
\end{lstlisting}
      \item While loops: \verb|while []; do [] done|
      \item Emulating do-while: see first two answers \href{https://stackoverflow.com/questions/16489809/emulating-a-do-while-loop-in-bash}{here}
      \item Combine loops and arrays: some examples
\begin{lstlisting}[language=bash]
for n in (one two three); do [...] done
#
list=(one two three)
for n in ${list[@]}; do [...] done # Items only
for i in ${!list[@]}; do [...] done # Indices only
for n in ${list[@]:1}; do [...] done # Items only, skip the first
\end{lstlisting}
    \end{itemize}
  \item Notifications and dialogue windows: we really like the old-school terminal, but sometimes nice GUI stuffs and visual aides make life easier. Consider this: you launch a script which takes a really long time, so from the terminal you switch to do other stuff. It would be nice to be alerted when the said script finishes. I am still working on an audio signal, but consider these two options:
    \begin{itemize}
      \item \verb|notify-send "Title" "Body"|: a little notification pop-up
      \item More advanced: \verb|zenity|, Achieve notification, pop-up, interactive windows,\ldots Some stuff \href{https://renenyffenegger.ch/notes/Linux/shell/commands/zenity}{here}. Try \verb|zenity --<type> --text "Body"| where \texttt{type} can assume \texttt{notification}, \texttt{info}, \texttt{warning}, \texttt{error}, \texttt{text-info}, \texttt{progress}, \texttt{file-selection}, \texttt{list}, \texttt{entry}, \texttt{scale} and others. All but \texttt{notification} stop the flow of the script.
        \begin{itemize}
          \item Control the size with \verb|--width=<n>| and \verb|--height=<n>|
          \item \verb|--window-icon=/pat/to/icon|: choose an icon for your widget
          \item \verb|--timeout=<n>|: how long the widget should stay
        \end{itemize}
    \end{itemize}
  \item Quitting
    \begin{itemize}
      \item \verb|exit [error_number]|: quit the current section. That's exactly what you wish, if you are in a script or in a \texttt{ssh} connection. However, if you try it in a terminal or in a function, it will close the terminal.
      \item In order to quit a function without closing the terminal / script, use \verb|kill -INT $$|
    \end{itemize}
  \item Parallelize loops:
    \begin{itemize}
      \item Use background commands with \verb|&|: see \href{https://unix.stackexchange.com/questions/103920/parallelize-a-bash-for-loop/103922}{here}
\begin{lstlisting}[language=bash]
for {...}; do
  do_something() &
done
\end{lstlisting}
        Mind that this will spawn as many sub-processes as iterations in the loops, no matter the number of available cores
      \item As before, but limiting the number of processes: see \href{https://stackoverflow.com/questions/38774355/how-to-parallelize-for-loop-in-bash-limiting-number-of-processes}{here}
\begin{lstlisting}[language=bash]
num_procs=$1
# The prompt escape for number of jobs currently running
num_jobs="\j"
for {...}; do
  while (( ${num_jobs@P} >= num_procs )); do
    wait -n
  done
  do_something() &
done
\end{lstlisting}
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Debugging \texttt{bash}}
\begin{itemize}
  \item Tools:
  \begin{itemize}
    \item The \href{https://bashdb.sourceforge.net/}{BASH Debugger Project}, or \texttt{bashdb} is a debugger (no kidding?!) with syntax similar to \texttt{gdb}
    \item \href{https://github.com/koalaman/shellcheck}{Shell Check}, it can be integrated in \texttt{vim}
    \item An \href{https://marketplace.visualstudio.com/items?itemName=rogalmic.bash-debug}{extension} for \texttt{VisualStudio}
  \end{itemize}
  \item Some \href{https://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/debugging.html}{insights}
  \item Native options:
    \begin{itemize}
      \item What
        \begin{itemize}
          \item \verb|-e|: exit as soon as an error is detected (command returning non-zero code)
          \item \verb|-n|: check for syntax errors without running the script
          \item \verb|-v|: echo every command before executing it
          \item \verb|-x|: echo the result of each command
          \item \verb|-u|: make the script fail if an undefined variables is used
          \item \verb|-o pipefail|: prevent error in a pipeline from being masked
        \end{itemize}
      \item How
        \begin{itemize}
          \item As command line options: \verb|sh -v my_script.sh|
          \item Add to certain zones only via \verb|set -x; [...] set +x|
\begin{lstlisting}[language=sh]
do_stuff
set -x # Activate option
# The option is ON for the following commands
do_something
set +x # Deactivate option
# The option is OFF for the following commands
do_something_else
\end{lstlisting}
        \end{itemize}
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{sed}}
Bases:
\begin{itemize}
  \item Some info could be found in the \href{https://www.gnu.org/software/sed/manual/sed.html}{manual} or in \href{http://www.grymoire.com/Unix/Sed.html}{this tutorial}; \href{https://www.tutorialspoint.com/unix/unix-regular-expressions.htm}{this} could be useful as well.
  \item A general knowledge of the regex could be very useful. Take a look at this \href{https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285}{cheatsheet}
    \begin{itemize}
      \item \verb|^pattern|: matches any string that starts with \texttt{pattern}. \verb|pattern$|: matches any string that ends with \texttt{pattern}
    \end{itemize}
  \item General usage: \verb|sed [options] "[range] <command>" old_file new_file|. Double quotes \texttt{"..."} may be replaced by single quotes \texttt{'...'}.
    \begin{itemize}
      \item If no \verb|new_file| is given, the result is printed to \texttt{stdout}.
    \end{itemize}
\end{itemize}

Commands:
\begin{itemize}
  \item Common commands may be found \href{https://www.gnu.org/software/sed/manual/sed.html#Common-Commands}{here}, less common ones \href{https://www.gnu.org/software/sed/manual/sed.html#Other-Commands}{here}, the \href{https://www.gnu.org/software/sed/manual/html_node/sed-commands-list.html}{list} from the manual
  \item Search and replace, \verb|s|:
\begin{lstlisting}[language=bash]
sed -i "s/<pattern>/<replaced>/" file
\end{lstlisting}
  \item Replace all the lines matching \verb|pattern| with \verb|Pattern was here| - this works on the entire line, \verb|c <text>| or \verb|c\<newline><text>|:
\begin{lstlisting}[language=bash]
sed -i "/pattern/c Pattern was here/" file
\end{lstlisting}
  \item Delete all lines containing \verb|pattern| - this works on the entire line:
\begin{lstlisting}[language=bash]
sed -i "/pattern/d" file
\end{lstlisting}
  \item Insert before line, \verb|i <text>| or \verb|i\<newline><text>|
\begin{lstlisting}[language=bash]
sed -i "/pattern/i Next line is pattern/" file
\end{lstlisting}
  \item Append after line, \verb|a <text>| or \verb|a\<newline><text>|
\begin{lstlisting}[language=bash]
sed -i "/pattern/a Previous line was pattern/" file
\end{lstlisting}
  \item Apply multiple commands at the same time:
    \begin{itemize}
      \item Separate them with semicolons: \verb|sed 'cmd1 ; cmd2' file|
      \item Separate them with \verb|-e|: \verb|sed -e 'cmd1' -e 'cmd2' file|
      \item Group sever commands together with braces: \verb|{cmd1 ; cmd2}|
    \end{itemize}
\end{itemize}

Ranges: ranges are optional and it is the way to tell \verb|sed| to apply the provided commands only to those lines specified by the range. Some examples
\begin{itemize}
  \item \verb|4,10|: lines 4 to 10
  \item \verb|4,+6|: line 4 and the following 6 lines
  \item \verb|4,10!|: everything except lines 4 to 10
  \item \verb|4~3|: starting from line 4, every 3 lines
  \item \verb|/pattern/|: all the lines matching \verb|pattern|
\end{itemize}

Options and tricks:
\begin{itemize}
  \item The option \verb|-i[<suffix>]|, \verb|--in-place=[<suffix>]| allows to overwrite the file once it is modified. If \verb|suffix| is provided a backup is created with the chosen extension;
    \begin{itemize}
      \item \verb|-i.bak| creates a backup file,
      \item The option \verb|--follow-symlinks|, available only with \verb|-i| activated, enables to modify the original file;
    \end{itemize}
  \item Option \verb|-n| avoid printing. This might be used in combination with the command \texttt{p} (print) to have a \texttt{grep}-like results where one can also replace. \href{https://unix.stackexchange.com/a/278377}{E.g.}:
\begin{lstlisting}[language=bash]
# Replace foo by FOO (using groups)
sed -n "s/^.*foo\([0-9]\+\).*$/FOO\1/p" file
\end{lstlisting}
  \item If in one line there are more occurrences, only the first one is matched. Appending \texttt{g} will make \texttt{sed} match all the occurrences.
\begin{lstlisting}[language=bash]
sed -i "s/<pattern>/<replaced>/g" file
\end{lstlisting}
  \item Character \verb|&| expands to matched string.
  \item Match exactly the word: from regex, \verb|\b| delimits boundaries of the word. Hence, (although \verb|\<word\>| seems to work, as well (\texttt{vim}, anyone?)):
\begin{lstlisting}[language=bash]
$ echo "bar embarassment" | sed "s/\bbar\b/no bar/g"
no bar embarassment
\end{lstlisting}
  \item Parentheses used in regex syntax (for groups \verb|(.)|, repetitions \verb|{.}|) should be escaped by a backslash: e.g. \verb|\(agroup\)|. Access groups content with \verb|\<n>| where \verb|n| is the number of the group. Or, add option \verb|-E|.
  \item Use \texttt{bash} variables: prefer the double-quotes \verb|"| instead of the single ones \verb|'|:
\begin{lstlisting}[language=bash]
sed "s/${pattern}/${replaced}/" file
\end{lstlisting}
  \item \verb|$| means last line when dealing with ranges, or end of the line when dealing with patterns.
  \item Mind that command \verb|d| erases the entire line, if you want to delete only the pattern, you can replace it with an empty string.
  \item Write at the beginning of the line: match the beginning (special character \verb|^|) and replace. For instance, in \texttt{C} comments all the lines containing \texttt{Comment} (mind that we have to escape character \verb|/|)
\begin{lstlisting}[language=bash]
sed '/Comment/ s/^/\/\//' test.c
\end{lstlisting}
  \item Replace only the first occurrence of \verb|pattern|: a bit tricky, find the right range (from line zero to first occurrence) then replace
\begin{lstlisting}[language=bash]
sed '0,/pattern/ s/pattern/new pattern/' file
\end{lstlisting}
  \item Replace only the last occurrence of pattern: I'm still working on that. A long and dirty workaround may be to use \verb|tac|, then replace \emph{first} occurrence and finally \verb|tac| again.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{grep}}
\label{ssec:grep}
\verb|grep [options] <pattern> [files]|

Some useful options:
\begin{itemize}
  \item \texttt{-r}: recursive, then \texttt{files} can be a directory;
  \item \texttt{-R}: as above, but follow links;
  \item \texttt{-w}: match only complete \emph{w}ords;
  \item \texttt{-c}: just print the \emph{c}ount of the lines with a match;
  \item \texttt{-v}, \verb|--invert-match|: get lines with that do \emph{not} match the \texttt{pattern};
  \item \texttt{-e}, \verb|--regexp=<pattern>|: look for \texttt{pattern}. This can be used, for example if \texttt{pattern} starts with a dash (\texttt{-}); similar options are \verb!-E|F|G|P!
  \item \texttt{-i}, \verb|--ignore-case|: search is case-\emph{i}nsensitive;
  \item \texttt{-I: exclude binary files;}
  \item \texttt{-h}: without filename (mnemonic: \emph{h}ead)
  \item \texttt{-H}: with filename (mnemonic: \emph{H}ead)
  \item \texttt{-n}: show line number;
  \item \texttt{-m <n>}: print only the first \texttt{n} occurrences of the \texttt{pattern};
  \item \texttt{-B <n>}: print \texttt{<n>} lines \emph{B}efore the match (included);
  \item \texttt{-A <n>}: print \texttt{<n>} lines \emph{A}fter the match (included);
  \item \texttt{-C <n>}: print \texttt{<n>} lines of the \emph{C}ontext of the match;
  \item \texttt{-l}, \verb|--files-with-matches|: \emph{l}ist only the file names in which at least one match is found;
  \item \texttt{-L}, \verb|--files-without-matches|: \emph{L}ist only the file names in which no match is found;
  \item \texttt{-q}: \emph{q}uiet, return just the exit status code (0 or 1 corresponding to, respectively, true or false) according to whether it have found a match or not;
  \item \verb|--include=<pattern>|: consider only files matching \texttt{pattern}. For example for only \TeX{} sources
  \item \verb|--label=<label>|: show matches from \texttt{stdin} as coming from file \texttt{label}. This is nice to have when combining with \texttt{find} (cf.\ \autoref{ssec:find})
\begin{lstlisting}[language=bash]
grep --include=\*.tex -r "O Bella Ciao" .
\end{lstlisting}
  \item \verb|--exclude=<pattern>|: do not consider files matching \texttt{pattern};
  \item \verb|--exclude-dir=<dir>|: exclude files in directory \texttt{dir};
\end{itemize}

Tricks:
\begin{itemize}
  \item Start from the end: \verb!tac <files> | grep [options] <pattern>! (Add a pipe to \texttt{tac} to recover the original order).
  \item Print even if the match is not found \verb!grep -E '^|<pattern>' <file>!. Special character \verb|^| means "beginning of the line", hence it is always found. Why should one use it? with the option \verb|--color| (usually enabled by default) \verb|grep| highlights the matches. Here, the command find the beginning of the line, which cannot be highlighted, hence it prints the line, if it finds the pattern as well it will highlight it.
  \item Non-greedy: add ``\texttt{?}'' after quantifier: e.g.\ \verb|^.*?}| *everything until first closing brace.
\end{itemize}

Types:
\begin{itemize}
  \item \texttt{-G}, \verb|--basic-regexp|, simple regexp, default
  \item \texttt{-E}, \verb|--extended-regexp|
  \item \texttt{-P}, \verb|--perl-regexp|
  \item \texttt{-F}, \verb|--fixed-strings|, exclude regexp
\end{itemize}

\texttt{grep}'ing non-text files:
\begin{itemize}
  \item Archives: The version \texttt{zgrep} (with the same options) allows to search into compressed/\emph{z}ipped files.
  \item PDF: two ways, see this \href{https://unix.stackexchange.com/questions/6704/how-can-i-grep-in-pdf-files}{SO question}, they both involve some external utilities
    \begin{itemize}
      \item Using \texttt{pdfgrep}: just use it as you would use \texttt{grep}
      \item Using \texttt{pdftotext}: convert pdf to text, pipe it, and \texttt{grep} it. By defaults it creates a \texttt{.txt} file, so mind the dash which makes it skip this
\begin{lstlisting}[language=bash]
pdftotext to_search.pdf - | grep pattern
# Combined with find
find /path -name '*.pdf' -exec sh -c \
  'pdftotext "{}" - | grep -H --label="{}" --color " pattern"' \;
\end{lstlisting}
    \end{itemize}
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{find}}
\label{ssec:find}
It allows to find files in a tree and apply a command to them:
\begin{lstlisting}[language=bash]
find [options] <path> <command>
\end{lstlisting}
If no command is given, \texttt{-print} is executed. Some examples and options:
\begin{itemize}
  \item Check if file \texttt{filename} is in \texttt{mydir} or one of its subdirectories (\texttt{-print} is considered, thus it works similarly to \texttt{ls})
\begin{lstlisting}[language=bash]
find <mydir> -name <filename>
\end{lstlisting}
  \begin{itemize}
    \item In the previous examples, use \verb|-wholename| (instead of simply \verb|-name|) if you provide the path as well
    \item \verb|-regex|: similar to \texttt{name} but one can use regex syntax to write the pattern. The type can be chosen with \verb|-regextype| (ex. \texttt{sed}). Notice that \texttt{find} always prepends \verb|./| to the path so you may want to start your pattern with something like \verb|.*/|
    \item Case-insensitive search: use \verb|-iname| or \verb|-iregex| as you would use their parent options
  \end{itemize}
  \item Filter on the file type: option \verb|-type <t>| where \texttt{<t>} can be, for example, \texttt{d} (directory), \texttt{f} (regular file), \texttt{l} (symbolic link)\dots
  \item \texttt{!}, \texttt{-not}: negation of the expression that follows. E.g.: \texttt{find . -not -name foo} print all the files in the current directory with a name different than \texttt{foo}.
    \begin{itemize}
      \item Exclude a path:
\begin{lstlisting}[language=bash]
find . -name notmyfile -not -path <dir_excl>
\end{lstlisting}
        This is somehow too simple and \texttt{find} will still search into the sub-directories of \verb|dir_excl|. You may find other solutions \href{https://stackoverflow.com/questions/4210042/how-to-exclude-a-directory-in-find-command}{here} (the accepted answer with \verb|-prune|may not always work).
    \end{itemize}
  \item \verb|-maxdepth <n>|: limit the tree descent level of the search
  \item Apply a command to all the matching files: e.g.\ run a bash script, grep only certain files
\begin{lstlisting}[language=bash]
find . -name "*.log" -exec script.sh {} \;
find . -name "*.log" -exec script.sh {} +
find . -name "*.log" -exec grep -Hn --color "pattern" {} +
\end{lstlisting}
    \verb|{}| stands for the matching files; the first version will execute as many calls as the numbers of matching files, the second (tries to) appends all the files in an single list of arguments (hence saving the calls to the script). If you would like to use a pipe in your \texttt{exec} command, use \texttt{sh} like below, or have a look \href{https://stackoverflow.com/questions/307015/how-do-i-include-a-pipe-in-my-linux-find-exec-command}{here}.
\begin{lstlisting}[language=bash]
find . -name "*.log" -exec sh -c "tac {} | grep -m1 pattern" \;
#
find /path -name '*.pdf' -exec sh -c \
  'pdftotext "{}" - | grep -H --label="{}" --color " pattern"' \;
\end{lstlisting}
  \begin{itemize}
    \item Mind that \texttt{find} does not know the content of \texttt{.bashrc} and alike, hence one could not use aliases (its \texttt{ls} command might be stripped-down with respect to what one is used to, you may want to consider adding some user-friendly options).
  \end{itemize}
  \begin{itemize}
    \item \verb|-ok|: like \texttt{exec} but ask the permission first
    \item \verb|-execdir|: like \texttt{exec} but run the command from the subdirectory that contains the matched file.
  \end{itemize}
  \item Delete all the matching files: e.g.\ delete all the \texttt{.log} files \texttt{find . -name *.log -delete}
    \begin{itemize}
      \item \texttt{-delete} calls \texttt{rm} under the hood, in fact it is practically equivalent to \texttt{-exec rm}. Hence it will fail if one tries to delete directory. In this case, use the long way: \verb|-exec rm -r {} \;|. You may add \verb|-prune| to avoid some warnings/errors. Moreover, one may add quote around braces to avoid errors with names that contains whitespaces.
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Compressing: \texttt{tar} \& \texttt{zip}}
\subsubsection{\texttt{tar}}
\texttt{tar} is a utility which creates archives
\begin{itemize}
  \item Basic usage:
    \begin{itemize}
      \item \verb|c|, \verb|-c|, \verb|--create|: create. Remember to put all the files that you want in your archive in one go.
\begin{lstlisting}[language=bash]
tar -cf archived.tar file/to/archive
\end{lstlisting}
      \item \verb|x|, \verb|-x|, \verb|--extract|, \verb|--get|: extract
\begin{lstlisting}[language=bash]
tar -xf archived.tar
\end{lstlisting}
      \item As you have already understood, \verb|-f| stands for file(name).
    \end{itemize}
  \item Additional options:
    \begin{itemize}
      \item \verb|t|, \verb|-t|, \verb|--list|: list the files.
      \item \verb|r|, \verb|-r|, \verb|--append|: add files to an existing archive. Does not work on compressed files.
      \item \verb|u|, \verb|-u|, \verb|--update|: add to the archive only the files which are already present and which have been modified.
      \item \verb|A|, \verb|-A|, \verb|--catenate|, \verb|--concatenate|: concatenate archives.
      \item Symbolic links: by default, \texttt{tar} keeps the links. If in the archive one wants a \emph{copy} of the \emph{original} file to which the link points to, option \verb!-h|--deeference! should be used.
      \item \verb|-C|, \verb|--directory <path>|: execute from \verb|path| (e.g.\ decompress inside a given directory)
    \end{itemize}
  \item Compression algorithms:
    \begin{itemize}
      \item Zip (compress), \verb|-z|, \verb|--gzip|, \verb|--gunzip|, \verb|--ungzip|: use compression algorithms. The option has to be used also when extracting compressed archived. Usually, compressed archived have \verb|.tar.gz| or \verb|.tgz| as extension.
      \item \verb|-j|, \verb|--bzip2|
      \item \verb|-J|, \verb|xz|
    \end{itemize}
  \item Compress an existing tarball: see \href{https://unix.stackexchange.com/questions/457949/how-to-turn-a-tar-file-to-a-tgz-file}{here}
\begin{lstlisting}[language=bash]
gzip < my_files.tar > my_files.tgz
\end{lstlisting}
\end{itemize}

\subsubsection{\texttt{zip}}
A cross-platform extension for compressed files is \texttt{zip}.
\begin{itemize}
  \item To compress simply run
\begin{lstlisting}[language=bash]
zip [options] <compressed_file>.zip <files_to_compress>
\end{lstlisting}
    \begin{itemize}
      \item If \verb|<compressed_file>.zip| already exists, files are added
    \end{itemize}
  \item To deflate, run \verb|unzip <compressed_file>.zip|
  \item By default it adds links as hard-files (and not as links). Use option \verb|-y| to store as link
  \item \verb|-r| (mneno: \emph{r}ecursive): include also (sub)directories and their files
  \item \verb|-j| (mnemo: \emph{j}unk): ignore subdirectory structure
\end{itemize}

\subsubsection{\texttt{gzip}}
\texttt{gzip} is a compression format for Unixes.
\begin{lstlisting}[language=bash]
gzip [options] <compressed_file>.gz <files_to_compress>
\end{lstlisting}

\subsubsection{\texttt{7zip}}
\begin{itemize}
  \item Base command is \texttt{7z*}, it can be installed with \texttt{p7zip}
  \item Create zip
\begin{lstlisting}[language=bash]
7za a <compressed_file>.7z <files_to_compress>
\end{lstlisting}
  \item Extract zip: \texttt{command} can be \texttt{e} (extract without directories), or \texttt{x} (with full paths)
\begin{lstlisting}[language=bash]
7za <command> <compressed_file>.7z
\end{lstlisting}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{awk}}
\label{ssec:awk}
\texttt{awk} is a text-processing utility that allows to perform easily operations line-by-line with column (here called \emph{fields}) manipulations. A tutorial is given \href{https://www.tutorialspoint.com/awk/index.htm}{here}.
\begin{itemize}
  \item Basis: \verb|awk [opt] 'BEGIN{[...]} {[...]} END{[...]}' <file>|
    \begin{itemize}
      \item The commands in the curly brackets after \texttt{BEGIN} are executed before starting the reading of the file,
      \item The commands in the unnamed curly brackets are executed at each line,
      \item The commands in the curly brackets after \texttt{END} are executed once the file has been read,
      \item Each of these three sections is optional;
    \end{itemize}
  \item A conditional statement (called \emph{pattern}) may be put just before the unnamed braces. Binary operations or comparisons can be used. If present, the commands inside are applied only to the rows verifying the pattern; if not, to all the rows. E.g.
    \begin{itemize}
      \item print the third row: \verb|awk 'NR==3{print;exit}' file.txt|
      \item print lines containing \texttt{apple}: \verb|awk 'BEGIN{print "We eat an"}/apple/' file.txt| (print is implied)
      \item More than one pattern might be used. No particular syntax is needed: nothing, a space or a newline will do the trick
\begin{lstlisting}[language=bash]
awk \
  '/apple/{print "Found apple"}/banana/{print "Found banana"}' \
  infile
\end{lstlisting}
    \end{itemize}
  \item Select the \texttt{n}-th field \verb|$<n>|. Remark: it is 1-based (first field is indexed by 1), and \verb|$0| expands to the whole line.
  \item Printing: it is usually achieved by command \texttt{print}. Some notes
    \begin{itemize}
      \item Columns are accessed with a dollar \verb|$|, for variables just use their name
\begin{lstlisting}[language=bash]
awk '{print $NF}' file # Print last column only
awk -v T=8 'END{print "2 times T = " 2*T}' file
\end{lstlisting}
      \item One can use redirection such as \verb|>|, \verb|>>| as explained in \autoref{sec:shell} to write to file. E.g.
\begin{lstlisting}[language=bash]
awk 'BEGIN{print Ciao > "ciao.txt"}' file
\end{lstlisting}
      \item \texttt{print} it also prints a new line stamp at the end
      \item \texttt{printf}, very similar to the \texttt{C} function, it can be used to choose the format. Differently from \texttt{print}, it does not insert a new line. E.g. (mind the \verb|\n|)
\begin{lstlisting}[language=bash]
awk '{printf("I want %5.2f bananas\n", 1.652)}' file
\end{lstlisting}
    \end{itemize}
  \item Useful options:
    \begin{itemize}
      \item The file name is given as argument of the command or with \verb|-f <file>|, or \verb|--file=<file>|.
      \item \verb|-F <char>|, \verb|--field-separator="<char>"|: \verb|char| is the column separator (space is default);
      \item Pass an argument: \verb|-v var_name=<value>|
      \item When using \texttt{gawk} (the GNU implementation of \texttt{awk}) one can asks for in-place replacement: \verb|-i inplace|.
    \end{itemize}
  \item Built-in variables:
    \begin{itemize}
      \item \verb|NF|: number of fields / columns in the current row (hence \verb|$NF| is the last column of the row)
      \item \verb|NR|: row number, mind that it is incremented if several files are read (1 based).
      \item \verb|FNR|: row number relative to current file. It resets to 1 every time a new file is read.
      \item \verb|FS|: field separator
      \item \verb|FILENAME|: should I explain?
      \item \verb|ENVIRON|: array with environment variables (e.g.\ try \verb|ENVIRON["USER"]|).
    \end{itemize}
  \item Tricks:
    \begin{itemize}
      \item \href{https://www.gnu.org/software/gawk/manual/html_node/String-Functions.html}{String-Manipulation functions}
      \item Operator "match", \verb|~| (tilde): \verb|<string>~<pattern>| true if \verb|string| matches \verb|pattern|. The negation is \verb|!~|. Hence, the following emulates \texttt{grep }(well, not exactly since we search in the second column only, but you get the idea)
\begin{lstlisting}[language=bash]
awk '$2~/<pattern>/{print $0}' file.txt
\end{lstlisting}
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Shell commands and tools}
\label{ssec:shell_tools}
\begin{itemize}
  \item \texttt{echo}: print a line to standard output. E.g. \verb|echo "Ciao World"|. It includes a newline at the end. It could be used via piping to provide an input parameter to a command.
    \begin{itemize}
      \item Variables can be used. Suppose you have \verb|what="cute puppy"|, then one can use
\begin{lstlisting}[language=bash]
echo "I want a ${what}"
\end{lstlisting}
      \item For redirection to files have a look at \autoref{sec:shell}.
      \item \verb|-n|: do not to insert a new line at the end.
      \item \verb|-e|: interpret a backslashed character, e.g. \verb|\n| will be considered as newline
      \item Overwrite: use \verb|\b| (needs option \verb|-e|) to go back a character. For entire lines, have a look \href{https://stackoverflow.com/questions/11283625/overwrite-last-line-on-terminal}{here}.
    \end{itemize}
  \item \href{https://man7.org/linux/man-pages/man1/script.1.html}{\texttt{script}}: save a shell session (commands and outputs) to a file
\begin{lstlisting}[language=bash]
script session.log
[commands here]
exit
\end{lstlisting}
    \begin{itemize}
      \item End the recording with \texttt{exit}
      \item \verb|-q|: quiet mode (do not print \texttt{script}-related ``greetings'')
      \item \verb|-a|: \emph{a}ppend to file
      \item \verb|-c <cmd>|: record command \verb|cmd| only (without starting an interactive session)
    \end{itemize}
  \item \verb|eval [args]|: \verb|args| are concatenated to build and run a command. Variables can be used:
\begin{lstlisting}[language=bash]
cmd="ls"
echo "I will now $cmd in dir"
eval $cmd dir
\end{lstlisting}
  \item Working with remote servers:
    \begin{itemize}
      \item \texttt{ssh}
        \begin{itemize}
          \item Connect to server: \verb|ssh [opt] [user@]server|. A new session open (a password may be requested). Use option \verb|-X| (or \verb|-Y|) to enable forwarding of the GUI, that is enabling GUI programs on the server
          \item For connections that requires an identification, one may skip the typical ``insert the password'' method by adding a \texttt{ssh} key to the authorized one. See \href{https://www.digitalocean.com/community/tutorials/how-to-configure-ssh-key-based-authentication-on-a-linux-server}{here} how:
\begin{lstlisting}[language=bash]
ssh-copy-id username@remote_host
\end{lstlisting}
            or simply add your public key to \verb|$HOME/.ssh/authorized_keys| of the server
          \item Run command on a server: \verb|ssh [opt] [user@]server cmd| (or \verb|'cmd'|)
        \end{itemize}
      \item Transfer data, \texttt{rsync} or \texttt{scp}: \verb|rsync file.txt server:/home/user/path/to|. Notice the colon.
        \begin{itemize}
          \item \texttt{scp}: it's the inter-server equivalent of \texttt{cp}, it has basically the same options and usage
            \begin{itemize}
              \item In order to copy hidden files append a dot "\texttt{.}". E.g.:
\begin{lstlisting}[language=bash]
scp -r [...] source/. user@server:dest/
\end{lstlisting}
                If \texttt{source} is the current directory it is better to do (incompatibility introduced by 2019 standard): \verb|scp -r [...] $(pwd) user@server:dest/|. However, a good alternative for this kind of needs is \verb|rsync|
            \end{itemize}
          \item \texttt{rsync}: has a syntax similar to \texttt{mv} or \texttt{cp}. As the name suggests, it is a sort of synchronization tool, hence you can customize the effect so that only most recent and freshly edited files are moved. Indeed, it can be use entirely locally, for instance to update a copy / backup. If no destination is provided, \texttt{rsync} will behave similarly to \texttt{ls}.
            \begin{itemize}
              \item \verb|--copy-links|: copy as file \texttt{vs.} \verb|--links|: copy as link.
              \item \verb|--info=progress2|: progress bar for global transfer (not per file)
              \item \verb|--exclude=<pattern>|: exclude files matching the pattern. \verb|--exclude-from=<file>|: read a file where each line is a pattern, if a file matches one of them, it is excluded
              \item \verb|--include=<pattern>|: it's more a \emph{NEVER EXCLUDE} than an include. For an \emph{include-only}--like process, look \href{https://unix.stackexchange.com/questions/2161/rsync-filter-copying-one-pattern-only}{here}: basically, exclude everything, then include back and include back again the \emph{only}
\begin{lstlisting}[language=bash]
rsync --include='*.pdf' --include='*/' --exclude='*' \
  src dest
\end{lstlisting}
            \end{itemize}
          \item ATTENTION: \texttt{scp} and \texttt{rsync} load the \texttt{.bashrc} and fail if it produces an output to \texttt{stdout} (for instance, if they contain commands such as \texttt{echo}). The workaround is to move those commands into \texttt{.bash\_profile} (or just send the output to \verb|/dev/null| if it is not important)
        \end{itemize}
    \end{itemize}
  \item \texttt{chmod}: change file permissions. See this \href{https://www.pluralsight.com/blog/it-ops/linux-file-permissions}{article}
    \begin{itemize}
      \item Typically, when looking at the permission of a file / repository via \texttt{ls -l}, the results is given by a 10-character chain divided
        \begin{itemize}
          \item The first character indicates the type of file: \verb|-| regular file, \verb|d| directory or \verb|l| link
          \item The remaining characters are subdivided in 3 groups: the first refers to the permissions of the owner of the files, the second to the permission of the group, the third to the permissions of other users
          \item The first element of each group refers to reading permission, \verb|r| if granted, \verb|-| otherwise; the second element to the writing one, \verb|w| or \verb|-|, the third to the execution permission, \verb|x| or \verb|-|
          \item E.g., \verb|drwxr-xr--| signifies a directory on which the owner has reading, writing and execution permissions; the group reading and execution; other users reading only
        \end{itemize}
      \item Typical commands:
        \begin{itemize}
          \item Extended format: \verb|chmod [options] <target><operator><permission> filename|
            \begin{itemize}
              \item \verb|target| can be one of or a combination of the following characters: \verb|u| to change user permissions, \verb|g| group, \verb|o| other permissions. \verb|a| is valid and is equivalent to \verb|ugo|
              \item \verb|operator| is one of the followings: \verb|+| to add permissions, \verb|-| to remove, \verb|=| to force permission to be exactly what provided
              \item \verb|permission| is one of or a combination of the following characters: \verb|r| to express reading permission, \verb|w| writing one, \verb|x| execution one.
              \item \verb|-R| option to recursively apply in the case of a directory
              \item E.g., \verb|chmod ug+x foo|: add to file \texttt{fool} execution permission for user and group
            \end{itemize}
          \item Numerical format: \verb|chmod <X><Y><Z> filename|
            \begin{itemize}
              \item \verb|X| is a digit that refers to user permissions, \verb|Y| to group ones, \verb|Z| to other users one
              \item In numerical format, no permission (e.g., \verb|-|) corresponds to 0, execution permission to 1, writing to 2, and reading to 4
              \item Sums are allowed, hence 5=1+4 means execution and reading permissions
              \item This command sets the permissions, hence is equivalent to the usage of \verb|=| from the previous format
              \item To obtain \verb|-rwxr-xr--| one should use 754
            \end{itemize}
        \end{itemize}
    \end{itemize}
  \item Download with command line: \texttt{wget} and \texttt{curl}
    \begin{itemize}
      \item Basic stuff \href{https://linuxconfig.org/download-file-from-url-on-linux-using-command-line}{here}
      \item With proxy \href{https://www.cyberciti.biz/faq/linux-unix-curl-command-with-proxy-username-password-http-options/}{here}; \verb|-x| option with \texttt{curl}; with \texttt{wget} you may want to export environmental variable \verb|http[s]_proxy|.
    \end{itemize}
  \item \verb|date [+"FMT"]|: get current date/time. Some of the instructions to build the format string follow:
    \begin{itemize}
      \item \verb|%H|, \verb|%M|, \verb|%S|: hours, minutes, seconds
      \item \verb|%T|, \verb|%r|, \verb|%R|: \verb|%H:%M:%S|, hour in 12-hours format, hour in 24-hours format
      \item \verb|%Y| (\verb|%y|), \verb|%m|, \verb|%W|, \verb|%d|: year (last two digits only), month, week, day
      \item \verb|%F|, \verb|%D|: equivalent to \verb|%Y-%m-%d| and \verb|%m/%d/%y| respectively
      \item \verb|%x|, \verb|%X|: respectively, date and hours according to region setting
    \end{itemize}
  \item Send email from terminal (because, why not. And yes, I have tried it in order to transfer a file from the cluster to my machine): look \href{https://www.tecmint.com/send-email-attachment-from-linux-commandline/}{here}, a quick \href{https://www.interserver.net/tips/kb/linux-mail-command-usage-examples/}{tutorial}.
\begin{lstlisting}[language=bash]
echo "Message Body Here" | \
    mailx -s "Subject Here" -a attachment.txt user@example.com
echo "Message Body Here" | \
    mail -s "Subject Here" -A attachment.txt user@example.com
\end{lstlisting}
    \begin{itemize}
      \item Other useful options:
        \begin{itemize}
          \item \verb|-c me@me.me|: CC-address
          \item \verb|-b me@me.me|: BCC-address
          \item \verb|-r me@me.me|: sender address
        \end{itemize}
      \item Use file as body of the message: option \verb|-q file.txt|. \textbf{However}, this might not work as expected: if the command finds non-standard charcters, even new-lines (!) instead of using the text it will attach it as a binary file. The following might work (see this \href{https://unix.stackexchange.com/a/522868/502731}{SO discussion}):
\begin{lstlisting}[language=bash]
tr -cd "[:print:]\n" < file.txt | \
    mailx -s "Subject Here" user@example.com
\end{lstlisting}
    \end{itemize}
  \item \texttt{wc}: \texttt{shell} command to perform some basic counting operations on a file (mnemonic: \emph{w}ord \emph{c}ount):
\begin{lstlisting}[language=bash]
wc [options] <file>
\end{lstlisting}
    \begin{itemize}
      \item \verb|-c|: print number of bytes;
      \item \verb|-w|: print number of words;
      \item \verb|-l|: print number of lines;
      \item \verb|-m|: print number of characters;
      \item \verb|-L|: print max line length;
      \item It usually (at least with \verb|-l|) re-prints the file name. To avoid use: \verb|wc -l < file.txt| (notice \verb|<|);
    \end{itemize}
  \item \texttt{sort [OPTIONS] [FILE]}
    \begin{itemize}
      \item if \texttt{FILE} is \texttt{-} or not given, it uses \texttt{stdin}
      \item \verb|-r|: \texttt{r}everse
      \item \verb|-u|: \texttt{u}nique
      \item \verb|-t <SEP>|: use \texttt{SEP} instead of blank space as field separator
      \item \verb|-f|: case insensitive
      \item \ldots and many others, check the man.
    \end{itemize}
  \item \texttt{uniq}: filter for repeated adjacent lines. Let me stress: only adjacent lines are checked
    \begin{itemize}
      \item \verb|-c|: prefix line with number of occurrences
      \item \verb|-d|: print repeated lines only
      \item \verb|-u|: print unique lines only
    \end{itemize}
  \item \verb|touch <file>|: modify the file access and/or modification date. If the file doesn't exist, an empty one will be created (unless specific options are given). For more details and all the options, have a look at its \texttt{man} page.\\
  Why should one use it?
    \begin{itemize}
      \item Changing the modification date of a file will force a smart compiler such as \verb|make| to re-run the compilation.
    \end{itemize}
  \item \href{http://www.imagemagick.org/script/convert.php}{\texttt{convert}}: very powerful tool for manipulating images (part of the \href{https://imagemagick.org/index.php}{\texttt{ImageMagick}} suite, some \href{http://www.imagemagick.org/script/command-line-processing.php}{tips})
    \begin{itemize}
      \item Convert: \verb|convert test.<ext1> test.<ext2>| the extension can be \texttt{pdf}, \texttt{jpg}, \texttt{png},\ldots
      \item Rotate: \verb|-rotate <deg>|
      \item Put images side by side: use \href{https://legacy.imagemagick.org/Usage/montage/}{\texttt{montage}} (which is part of the \texttt{ImageMagick} suite, \href{https://imagemagick.org/script/montage.php}{indeed}), see \href{https://stackoverflow.com/questions/20737061/merge-images-side-by-side-horizontally}{here}. E.g.\ \verb|montage img_[01234].png -tile 2x2 -geometry 10x10 out.png|, where \verb|-tile| gives set the structure of the final image and \verb|-geometry| the spacing between images
      \item Choose density|quality (and hence the final size): option \verb|-density <n>| (its unit is \texttt{dpi})
      \item Reduce size: \verb|-size <n>%| the output will have be the \verb|n|\% of the initial size
      \item Mirror image: \verb|-flip| vertical (meaning top becomes bottom) axis, \verb|-flop| horizontal axis (meaning right becomes left)
      \item Extract images from an animated \texttt{gif}: \verb|convert in.gif out.png| and it will save images like \texttt{out-0.png}, \texttt{out-1.png}, \texttt{out-2.png}\ldots
      \item Write text on image: see \href{https://stackoverflow.com/questions/23236898/add-text-on-image-at-specific-point-using-imagemagick}{here}
    \end{itemize}
  \item See node architecture: \href{https://linux.die.net/man/1/lstopo}{\texttt{lstopo}}
\begin{lstlisting}[language=bash]
# Try also png for instance
lstopo --output-format svg > topology.svg
# Without graphic support
lstopo-no-graphics --output-format txt > topology.txt
\end{lstlisting}
  \item \href{https://github.com/DavidFirth/pdfjam#using}{\texttt{pdfjam}}: nice and easy utility to modify \texttt{pdf} files
    \begin{itemize}
      \item Extract and/or merge: Examples of accepted ranges: \texttt{'1,6-9'}, \texttt{'-2,4,6'}
\begin{lstlisting}[language=bash]
pdfjam [options] -- file_1.pdf ['<page_range>'] \
                   [file_2.pdf ['<page_range>'] ...]
\end{lstlisting}
      \item Rotate: Commands specified for certain angles are available: \verb!pdf90|180|270 <in.pdf>!
      \item Landscape mode: \verb|--landscape|
      \item Keep size: \verb|--fitpaper true|
      \item Autorotate oversized pages: \verb|--totateoversize true|
      \item More than one page per page: \verb|--nup <cols>x<rows>|, e.g., \verb|--nup 2x1|
      \item In fact, under the hood \texttt{pdfjam} calls \LaTeX{} and loads the pdf into a page. This is enough most of the time, however, if the pdf has non-standard dimensions, let say smaller than A4, this will result in a blank A4 page with the pdf at the center. To fit to the size, use \texttt{ghostscript} (for the pages, the option \texttt{-sPageList} is also available and accepts ranges)
      \item A similar utility with a wider range of capabilities is \href{https://www.ghostscript.com/doc/current/Use.htm}{\texttt{ghostscript}}
        \begin{itemize}
          \item \texttt{ghostscript} can output in many forms, called \emph{devices} (even OCR!), \href{https://ghostscript.com/docs/9.54.0/Devices.htm}{here's how}
        \end{itemize}
    \end{itemize}
\begin{lstlisting}[language=bash]
gs -dBATCH -dNOPAUSE -dSAFER -sDEVICE=pdfwrite -dPSFitPage \
   -dFirstPage=2 -dLastPage=5 -o out.pdf in.pdf
\end{lstlisting}
  \item Job management:
    \begin{itemize}
      \item \verb|kill [options] <job_ID>|: kill (send \texttt{SIGTERM} to) the job denoted by \verb|<job_ID>|.
      \item \verb|pgrep [options] <pattern>|: print info, especially the job-IDs, of all the jobs matching \verb|<pattern>|. Option \verb|-l| lists the names as well (and not only the IDs).
      \item \verb|pkill [options] <pattern>|: as \verb|kill| but looks for matches in job names before (as \verb|pgrep|).
      \item Options for \verb!pgrep|pkill!
        \begin{itemize}
          \item \verb|-c|: count
          \item \verb!-l|-a!: lists names/fully
          \item \verb!-n|-o!: newest/oldest only
          \item \verb|-x|: select if name is exact
          \item \verb|-u UID|: only for user \verb|UID|
          \item \verb|-s SIG|: send signal \verb|SIG|
        \end{itemize}
    \end{itemize}
  \item \verb|[h]top|: \verb|top| (and its user-friendly version \verb|htop|) gives an overview of a running system. One can find, for instance and just to name the most useful features, which jobs are running and how much memory or processors are used.
    \begin{itemize}
      \item Filter: use option \verb|-p <ID>|. Using the job name instead of the ID is more convenient: have a look at \href{https://unix.stackexchange.com/a/347544}{this}: \verb|top -p `pgrep -d "," <name>`|.
    \end{itemize}
  \item \texttt{du}: shows the space used by the directories (and files) (mnemonic: \emph{d}isc \emph{u}sage)
    \begin{itemize}
      \item \verb!-a|--all!: show the space of every files, not only the directories
      \item \verb!-h|--human-readable!: use convenient units (MB,GB,\ldots)
      \item \verb!-d|--max-depth=<n>!: how many levels down the directory-tree \texttt{du} should search
      \item \verb|--exlude=<pattern>|: well, I think you get it
    \end{itemize}
  \item \texttt{df}: check disk space info about the system (mnemonic: \emph{d}isk \emph{f}ree / \emph{f}ilesystem)
  \item \texttt{time}: run programs and summarize system resource usage (from \texttt{man}). \verb|time my_script.sh|; get the execution time of the script. More insight \href{https://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1/556411#556411}{here}.
  \item \texttt{uname}: print system info
  \item ``Safely remove'' disks from command line: use \texttt{udisksctl} as explained \href{https://askubuntu.com/questions/532586/what-is-the-command-line-equivalent-of-safely-remove-drive}{here}:
\begin{lstlisting}[language=bash]
udisksctl unmount -b /dev/sdX
udisksctl power-off -b /dev/sdX
\end{lstlisting}
  \item Con\emph{cat}enate files and print to standard output (basically print the content to screen)
    \begin{itemize}
      \item \verb|cat [<opt>] file [file2 [...]]|
      \item \verb|tac [<opt>] file [file2 [...]]| as above but reverse order of the lines
    \end{itemize}
  \item Print a small part of a file
    \begin{itemize}
      \item \texttt{head}: print the first part of a file
        \begin{itemize}
          \item \verb|-n [-]N|: first \texttt{N} lines; if \verb|-| given, all but the last \texttt{N}
          \item \verb|-c [-]N|: as above but bytes instead of lines
        \end{itemize}
      \item \texttt{tail}: print the last part of a file
        \begin{itemize}
          \item \verb|-n [+]N|: last \texttt{N} lines; if \verb|+| given, all but the first \texttt{N}
          \item \verb|-c [+]N|: as above but bytes instead of lines
          \item \verb|-f|: output appended as file grows (kinda of syncing)
        \end{itemize}
    \end{itemize}
  \item \verb|cp [options] <source> [dest]|: copy \texttt{source} into \texttt{dest} (if omitted, "\texttt{.}")
    \begin{itemize}
      \item \verb|-t|: target. \verb|cp -t dest -- <source>| is equivalent to \verb|cp <source> [dest]|
      \item \verb|-r|: recursive, useful for directories
      \item \verb|-u|: copy only if there is no file with the same name in \texttt{dest} or if \texttt{source} is newer (mnemonic: \emph{u}nique)
      \item \verb|-p|: preserve mode, ownership, and time-stamps
      \item \verb|-l|: (hard) link source instead of copy
      \item \verb|-L|: if \texttt{source} is a (symbolic) link, copy the file it points to instead of copying the link
    \end{itemize}
  \item \verb|crontab|: job scheduling. It allows one to regularly run some commands or scripts. Tutorial \href{https://www.adminschoice.com/crontab-quick-reference}{here} or \href{https://www.computerhope.com/unix/ucrontab.htm}{here}.
  \item \texttt{tee}: read from standard input and write to standard output \textbf{\&} files. Useful when you want to save the output of a command to file but you still want to read it on screen. E.g.
\begin{lstlisting}[language=bash]
echo "This'll be printed to screen and inside f.txt" | tee f.txt
\end{lstlisting}
    \begin{itemize}
      \item \verb|-a|: append to file.
      \item Print to screen \& pipe: \verb!./script | tee /dev/tty | ./script_with_pipe!
    \end{itemize}
  \item \texttt{bc}: shell calculator (mnemonic: \texttt{b}asic \texttt{c}alculator)
    \begin{itemize}
      \item Some examples \href{https://www.geeksforgeeks.org/bc-command-linux-examples/}{here}.
      \item How to
        \begin{itemize}
          \item Simply run \texttt{bc} and an interactive interface will open (similar to what you get when you run \texttt{python}). Type \texttt{quit} for\ldots yeah, quitting.
          \item If you do not need extensive calculation but have just a one-liner expression, just pass it to \texttt{bc}: \verb!echo "20+5" | bc! or \verb|bc <<< "20+5"|
        \end{itemize}
      \item Operators like \verb|++|, \verb|*=|, etc.\ are accepted
      \item Give option \verb|-l| to load the standard math library and, for instance, deal with floating point calculation and use standard functions (e.g.\ sine \verb|s(x)|).
    \end{itemize}
  \item \texttt{tr}: \emph{tr}anslate, squeeze and/or delete characters from standard input. Basically performs string operations on standard input. Some options and examples
    \begin{itemize}
      \item \verb!echo Maaan | tr a e!: change \texttt{a}'s into \texttt{e}'s, hence the result is \texttt{Meeen}.
      \item \verb|-d|: \emph{d}elete. \verb!echo Maaan | tr -d a! gives \texttt{Mn}
      \item \verb|-s|: \emph{s}queeze. \verb!echo Maaan | tr -s a e! replaces each sequence of repeated \texttt{a}'s with a single occurrence of \texttt{e}, hence it gives \texttt{Men}.
    \end{itemize}
  \item \texttt{xargs}: use standard output to build commands (you can think of it as a more powerful way of piping). Have a look at some tutorials \href{https://shapeshed.com/unix-xargs/}{here} and \href{https://www.thegeekstuff.com/2013/12/xargs-examples/}{here}. Typical call is (the 0-related flags deal with files with spaces in their names)
\begin{lstlisting}[language=bash]
find . -name foo -print0 | xargs -0 rm
\end{lstlisting}
    \begin{itemize}
      \item \texttt{-t}: print the command
      \item \texttt{-p}: prompt a user-confirmation before executing the command
      \item \texttt{-n <n>}: group the inputs by \texttt{n}. That is, instead of (braces added for the sake of explanation) \verb|{1} {2} {3} {4}|, with \texttt{-n 2} one gets \verb|{1 2} {3 4}|.
      \item \texttt{-I}: enables \texttt{xargs} to execute multiple commands. In this case, \verb|%| is the placeholder for the input (sort of \verb|{}| in \verb|find -exec|)
      \item \texttt{-a <file>}: read from \texttt{file} instead of standard output
    \end{itemize}
  \item \texttt{cut}: cut out part of the content of the input. Typical call is:
\begin{lstlisting}[language=bash]
cut -f 2-5 text.txt
\end{lstlisting}
    print only columns (\texttt{f}ields) 2 to 5 of the content of file \verb|text.txt|.
    \begin{itemize}
      \item \verb|-f <list>| (or \verb|--fields|): print only fields in the list
      \item \verb|-b <list>| (or \verb|--bytes|): same as above but with bytes
      \item \verb|-c <list>| (or \verb|--characters|): same as above but with characters
      \item \verb|-d <,>|: use \verb|<,>| as delimiter for fields
      \item List examples: \texttt{n} or \texttt{n-m} or \texttt{-n} or \texttt{n-}
    \end{itemize}
  \item \texttt{comm}: compare two files: \verb|comm -<n> <(sort file_1) <(sort file_2)|
    \begin{itemize}
      \item Files must be \textbf{sorted}
      \item Variable \texttt{n} is a combination of \texttt{1}, \texttt{2}, and \texttt{3}. \texttt{1} / \texttt{2} means suppress lines unique to \verb|file_1/2|, \texttt{3} means suppress shared lines
      \item Keep lines from \verb|file_1| only \verb|comm -23 <(sort file_1) <(sort file_2)|
      \item Keep lines from \verb|file_2| only \verb|comm -13 <(sort file_1) <(sort file_2)|
    \end{itemize}
  \item \texttt{getopts}: built-in command of \texttt{bash} which allows to parse options and arguments passed to a script. Two quick and well-done tutorials can be found \href{https://www.computerhope.com/unix/bash/getopts.htm}{here} and \href{https://sookocheff.com/post/bash/parsing-bash-script-arguments-with-shopts/}{here}. We provide a hand-made example in the appendix, \autoref{lst:getopt_ex}.
    \begin{itemize}
      \item Typically, one calls \verb|while getopts ":<option_list>" opt; do [...] done|. One may want to use a \verb|case| environment to deal with the options.
      \item Here above, \verb|option_list| contains the list of accepted options. If the option is followed by a \verb|:| (colon) it means that it requires arguments. The argument is stored in the macro \verb|$OPTARG|.
      \item \verb|\?| stands for an invalid/unknown option, \verb|:| (colon) for an option for which an argument is required but not provided.
    \end{itemize}
  \item Extract from path (considered as a string): \texttt{dirname} (root) and \texttt{basename}. E.g.: consider the following \texttt{path/to/file.txt}. Then \texttt{dirname} returns \texttt{path/to}, whereas \texttt{basename} \texttt{file.txt}.
  \item Convert from HEX to RGB colors from command line
\begin{lstlisting}[language=bash]
hex="11001A"
printf "%d %d %d\n" 0x${hex:0:2} 0x${hex:2:2} 0x${hex:4:2}
\end{lstlisting}
  \item \href{https://pandoc.org/}{\texttt{pandoc}}: convert from and to (almost) any markup languages, such as \LaTeX{}, \texttt{markdown}, \texttt{html}, Word, \texttt{reStructured Text}, \texttt{epub}, \texttt{pdf},\ldots
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Debugging tools}
\subsection{\texttt{valgrind}}
Some useful options:
\begin{itemize}
  \item Log file: \verb|--log-file=<filename>|
  \item Check and track memory leaks: \verb|--leak-check=full| \verb|--track-origins=yes|
    \begin{itemize}
      \item Reachable / possibly-lost: \verb!--show-reachable=yes|no --show-possibly-lost=yes|no!
    \end{itemize}
  \item Profiling: \verb|--tool=callgrind|. A file with a name similar to \path{callgrind.out.<pid>} (where \texttt{pid} is a long number) is created with all the events registered. One can open it with \texttt{qcachegrind} or \texttt{kcachegrind}
    \begin{itemize}
      \item \href{https://www.cs.cmu.edu/afs/cs.cmu.edu/project/cmt-40/Nice/RuleRefinement/bin/valgrind-3.2.0/docs/html/cl-manual.html}{Manual}
      \item \href{https://stackoverflow.com/a/50781312/12152457}{How to interpret \texttt{qcachegrind}}
      \item Profiling a subset of the program: one might be interested in profiling only a part of the program, or even only a function (for instance to have results that are not polluted by other functions, to speed up a little bit). This can be done in several ways:
        \begin{itemize}
          \item Add \texttt{callgrind} macros to the code, see \href{https://cta-redmine.irap.omp.eu/projects/gammalib/wiki/How_to_use_valgrind}{here} (use option \verb|--collect-atstart=no|)
\begin{lstlisting}[language=c]
#include <valgrind/callgrind.h>

int main()
{
  foo1();
  CALLGRIND_START_INSTRUMENTATION;
  CALLGRIND_TOGGLE_COLLECT;
  bar1();
  CALLGRIND_TOGGLE_COLLECT;
  CALLGRIND_STOP_INSTRUMENTATION;
  foo2();
}
\end{lstlisting}
          \item Toggle the collection at entry/exit of a function: use options \verb|--collect-atstart=no| \verb|"--toggle-collect=bar1(int, int)"|. It is very picky, hence keep the quotes, put the full signature with arguments separated by a comma and a space; for class methods: \verb|Foo::bar1()|. See \href{https://valgrind-users.narkive.com/2YLNcvE8/callgrind-toggle-collect-on-a-class-function}{here} and \href{https://stackoverflow.com/questions/13688185/callgrind-profile-a-specific-part-of-my-code}{here}
          \item Start the program and activate with \verb|callgrind_control -i on|
        \end{itemize}
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{gdb}}
\label{sec:gdb}
\begin{itemize}
  \item Calling functions such as \texttt{fabs}, \texttt{sin},...: \texttt{((double(*)(double))<foo>)(x)}
  \item Setting watchpoints which stay after the end of the current function:
\begin{verbatim}
$ print pt
  (double *) 0x75e12
$ watch *(double *) 0x75e12
\end{verbatim}
  \item Print all current variables: \texttt{info args} (try also \texttt{info locals})
  \item Logging output \href{https://sourceware.org/gdb/onlinedocs/gdb/Logging-Output.html}{here}
    \begin{itemize}
      \item Enable/Disable logging: \verb!$ set logging on|off!
      \item Change name of the log file (default is \texttt{gdb.txt}): \verb|$ set logging file <name>|
      \item Overwrite: \verb!$ set logging overwrite on|off!
      \item Redirect only to file: \verb!$ set logging redirect on|off!
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{git}}
\label{sec:git}
A nice, user-friendly introduction to \texttt{git} is available \href{https://www.atlassian.com/git/tutorials/learn-git-with-bitbucket-cloud}{here}. And the official documentation is \href{https://git-scm.com/doc}{here}.

Intro: for those who do not know, \texttt{SHA1} is either the ID (long or short, it does not matter) of the commit, which one can get via a \texttt{git log}, or a tree-path relative to the \texttt{HEAD} (e.g.: latest commit=\texttt{HEAD}, second to last=\verb|HEAD^| or \verb|HEAD~1|, ($n+1$)-th to last=\verb|HEAD~n|). More info \href{https://git-scm.com/docs/git-cherry-pick}{here}.

For inexperienced users who want to perform simple tasks, such as looking at the changelogs and commit history, or creating commits, the user-friendly, GUI programs such as \texttt{git-cola} (manage the current status of your git repository) and \texttt{gitk} (looking at the commit tree and moving around it) are advisable.

\emph{Bonus.} This could seem totally unrelated, but, here is one the most visited question on \texttt{StackOverflow} (more than 2 million times!) which deals with \href{https://stackoverflow.com/questions/11828270/how-do-i-exit-the-vim-editor}{How to exit the \texttt{Vim} editor}. You may want to have a look at this question which has more than 8 million views and it is indeed \texttt{git}-related: \href{https://stackoverflow.com/questions/927358/how-do-i-undo-the-most-recent-local-commits-in-git}{How do I undo the most recent local commits in \texttt{git}?}

\begin{itemize}
  \item Run \verb|git| commands from another directory: \verb|git -C <path> <cmd>| (mnemonic: as in \verb|make|). Originally it was: \verb|--git-dir=<path> --work-dir=<path>|.
  \item \verb|git add <file_name>|: move the modifications in \verb|file_name| to commit stage (that is, they will be include in the next commit)
    \begin{itemize}
      \item The option \texttt{-p}, aka cherry-picking, splits the \verb|file_name| into chucks, so that you can choose which modifications are to be staged. For each of them, you will have to tell \texttt{git} what to do with it: if it is to keep, answer \texttt{y}; if not, \texttt{n}. Other answers are possible, for example use \texttt{s} (for split) reduce the chunk size / split the current chunk into sub-chunks. \href{https://stackoverflow.com/questions/1122210/can-i-modify-git-adds-hunk-size}{Here} you can find the meaning of all of the possible answers. This could be done easily with \texttt{git-cola}.
    \end{itemize}
  \item \texttt{git commit}: creates a new commit with the staged modifications. This operation is easily done in \texttt{git-cola}.
    \begin{itemize}
      \item \verb|-m "Commit title"|: a simple and fast way to create a commit;
      \item \texttt{-a}: all the modified files, even those which are not staged yet are added to the commit;
      \item Forgot a file in your last commit or want to modify it? \verb|git commit --amend| add the staged modifications to the last commit.
      \item Commit with the same message as the original (after a reset, or with the \verb|--amend| option): \verb|git commit -c ORIG_HEAD|.
    \end{itemize}
  \item Writing good commit messages
    \begin{itemize}
      \item \href{https://www.conventionalcommits.org/en/v1.0.0/}{Conventional commits}: a style-guide for writing commits messages. The main structure is ``\texttt{<type>[(scope)][!]: <Short description>}'' where:
        \begin{itemize}
          \item \texttt{type} is one of the following: \texttt{fix}, \texttt{feat}, \texttt{chore}, \texttt{docs}, \texttt{improvement}, \texttt{perf}, \texttt{refactor}, \texttt{test}, \texttt{ci}, \texttt{build}
          \item \texttt{scope}, in parentheses, is optional and tells to which part of the repository the modifications are applied
          \item \texttt{!} is optional and signals that the commit is important, for instance introduces a new cool features, remove the support for a particular case/library\ldots
          \item Example: ``\texttt{feat(api)!: Add access to low-level config}''
          \item Why should you write like this? It provides a template which is quite easy to understand. Moreover, some tools allows one to automatically analyze the commit history and extract insightful information based on this syntax and can provide a changelog.
        \end{itemize}
      \item Link a commit to an issues: it suffices to quote the issue number anywhere in the commit message as such \verb|#xxx| where \texttt{xxx} is the issue number. Moreover, one can directly close an issue with a similar strategy, more details \href{https://docs.github.com/en/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue}{here}: for instance put \verb|close #xxx| in the commit message
    \end{itemize}
  \item Choosing good branch names:
    \begin{itemize}
      \item More generally, \href{https://nvie.com/posts/a-successful-git-branching-model/}{here} is an article about a good branching convenstions / strategies.
      \item It is suggested to prepend categories to branch names, e.g., \verb|features/new_cool_dev|. One could choose the category according the same principles of conventional commits described above. An interesting \href{https://dev.to/varbsan/a-simplified-convention-for-naming-branches-and-commits-in-git-il4}{article}.
      \item Sometimes, using category in branch names is recognized by git platforms which can improve the displaying for instance of the PR associated to the branch.
      \item In every modern git platform one can open branches directly associated with an issue.
    \end{itemize}
  \item Tagging: e.g., adding things like \texttt{v1.0}, have a look \href{https://git-scm.com/book/en/v2/Git-Basics-Tagging}{here}
    \begin{itemize}
      \item Add: \verb|git tag -a <tagname> -m"<message>"|
      \item Publish: by default, the git push command doesn't transfer tags to remote servers. You will have to explicitly push tags to a shared server: \verb|git push origin <tagname>|, or for all tags at once \verb|git push origin --tags|
      \item Delete: it should be done in two steps. First, delete locally \verb|git tag -d <tagname>|, then publish \verb|git push origin --delete <tagname>|
    \end{itemize}
  \item For all merging-related commands (\texttt{am}, \texttt{merge}, \texttt{cherry-pick}, \texttt{rebase}, \verb|pull --rebase|...), if errors occur, you can use
    \begin{itemize}
      \item \verb|git <command> --continue|: the problems have been solved, tells \texttt{git} to continue what it was doing,
      \item \verb|git <command> --abort|: cancel the operation and return to the pre-sequence state, the situation before \texttt{git <command>} was called,
      \item \verb|git <command> --quit|: similar to \texttt{abort}, but do not reset the \texttt{HEAD} back to the original branch. The index and working tree are also left unchanged,
      \item \verb|git <command> --skip|: in some commands, e.g.\ the \texttt{rebase}-related ones, skip (do not apply) the current commit, and continue.
    \end{itemize}
  \item \verb|git reset [options] SHA1|, \href{https://git-scm.com/docs/git-reset}{here}:
    \begin{itemize}
      \item \verb|--soft|, Does not touch the index or the working tree at all, but resets the \texttt{HEAD} to \texttt{SHA1},
      \item \verb|--mixed|, (default) Resets the index but not the working tree (the files do not change),
      \item \verb|--hard|, Resets the index \emph{and} the working tree;
    \end{itemize}
  \item \verb|git rebase -i SHA1|: (\texttt{-i} stands for interactive) enables to modify (delete, move up or down the log tree, fix up, squash, reword) the commits from \texttt{SHA1} to \texttt{HEAD};
  \item Modify an old commit (for which \verb|--amend| would not work): use a \texttt{rebase -i}
    \begin{itemize}
      \item For basic modifications: look \href{https://stackoverflow.com/questions/1186535/how-to-modify-a-specified-commit}{here};
      \item For splitting a commit or complex modifications: follow \href{https://stackoverflow.com/questions/6217156/break-a-previous-commit-into-multiple-commits}{here} (I suggest to \texttt{rebase} to one commit before the one you want to modify).
    \end{itemize}
  \item (Re)set the remote reference (from where git pulls) for the branch \verb|branch_name|
\begin{lstlisting}[language=bash]
git branch [<branch_name>] --set-upstream-to new_remote/remote_branch
\end{lstlisting}
    If \verb|branch_name| is not provided, the current branch will be used as default;
  \item Working with remote repositories
    \begin{itemize}
      \item Getting the latest commits: \verb|git pull|. One may want to add the \verb|--rebase| option so that your non yet published commits stay on top of the tree.
      \item Publish the latest local commits: \verb|git push|. It is always better to do a \verb|git pull --rebase| before pushing in order to avoid conflicts.
    \end{itemize}
  \item Pushing
    \begin{itemize}
      \item Push a new branch: \verb|git push -u origin <branch>|: \verb|-u| set the upstream reference at the same time
      \item Push a new project to \href{https://github.com/}{GitHub} for the first time: follow \href{https://help.github.com/en/github/importing-your-projects-to-github/adding-an-existing-project-to-github-using-the-command-line}{this}.
      \item Damn! You have just pushed a commit and you realize just now that it needs an amend. Modify it in you local repository then force-push it, have a look \href{https://stackoverflow.com/questions/179123/how-to-modify-existing-unpushed-commit-messages}{here}.
      \item Push except the last commit: \href{https://stackoverflow.com/questions/8879375/git-push-push-all-commits-except-the-last-one}{here}, \verb|git push origin HEAD^:master|
    \end{itemize}
  \item Rename a branch:
    \begin{itemize}
      \item If on the branch to rename: \verb|git branch -m <new_name>|
      \item If on another branch: \verb|git branch -m <old_name> <new_name>|
    \end{itemize}
  \item Patching: Patches are objects that stores the differences between two \texttt{git} states.
    \begin{itemize}
      \item There are two kinds of patches:
        \begin{itemize}
          \item Raw (I don't know if that's the official definition, but I think that gives the idea): they are simply the output of \verb|git diff|.
          \item Mailbox format: patches of this kind, in addition to the raw difference, also contain information additional information, e.g., the author. This type is typically used when sharing patches.
        \end{itemize}
      \item Create patches:
        \begin{itemize}
          \item Raw format: just save the output of \verb|git diff|, for instance with a simple redirection: e.g., \verb|git diff > test.patch|
          \item \href{https://git-scm.com/docs/git-format-patch}{Mailbox format}: \verb|git format-patch [options] <SHA1>|. Create patches from \texttt{SHA1} to most recent commit
            \begin{itemize}
              \item \texttt{-<n>}: create only \texttt{n} patches (always starting from \texttt{SHA1});
              \item \verb|--start-number <n>|: the patches are numbered starting from \texttt{n};
              \item \texttt{-N}: commits are unnumbered.
              \item \verb|-o <out_dir>|: output directory
            \end{itemize}
        \end{itemize}
      \item Apply patches
        \begin{itemize}
          \item \href{https://git-scm.com/docs/git-apply}{\texttt{git apply}}: works both on raw and mailbox formats.
          \item \href{https://git-scm.com/docs/git-am}{\texttt{git am [options] path/to/patch}}: apply a mailbox patch.
            \begin{itemize}
              \item Differently, form the simple \texttt{apply}, \textbf{it also adds a related commit to the tree}.
              \item \texttt{-3}: if the patch does not apply cleanly for a certain file, falls back to the version of the most recent common commit between the current tree and the one coming with the patch, and propose a 3-way merge (current, patch, and ancestor),
              \item \verb|--reject|: when the application fails, tells \texttt{git} to apply as many modifications as possible and to temporarily skip the impossible ones. The rejected modification will be stored in \texttt{*.rej} files. The application has to be completed manually (you will have to personally modify the files)
            \end{itemize}
        \end{itemize}
    \end{itemize}
  \item Get current branch: \verb|git branch --show-current|
  \item \href{https://git-scm.com/docs/git-merge}{Merge} a branch: \verb|git merge [options] <to_merge>| incorporate all the commits of \verb|o_merge| onto the current branch. Some info also on \href{https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-request-merges}{\texttt{GitHub}}.
    \begin{itemize}
      \item If the history of the current and to-be-merged branch split, then an additional, automatically-generated commit is added (it is usually called ``Merge branch [\ldots]''). To avoid that, you can try to rebase \verb|branch_to_merge| over the final brunch, and possibly use the option \verb|--ff-only|.
      \item It \verb|branch_to_merge| has more than one commits, use \verb|--squash| to merge all its commits without, however, committing the changes into the current branch.
    \end{itemize}
  \item Rebasing: see \href{https://git-scm.com/book/en/v2/Git-Branching-Rebasing}{here}
  \item Stashing: sometimes modifications are not yet ready for a commit but you have to go checkout another branch and \texttt{git} won't let you because of the modifications. That's where stashing comes in: it's a heap, a space where one can put modifications without them being in the official history. The state will be restored to \texttt{HEAD} (possibly the staged changes remain). Of course, one can recover them afterwards.
    \begin{itemize}
      \item Stash modifications: \texttt{git stash}
        \begin{itemize}
          \item Stashes are just like commit, hence one can give a message, use \verb|-m 'Message'|
          \item By default, it stashes all the modifications on any files in the \texttt{git} view. One can select a specific file \verb|git stash -- file.txt|
        \end{itemize}
      \item Recover a stash: \texttt{git stash pop}
        \begin{itemize}
          \item It actually performs to actions: apply the stash and delete it from the heap
          \item By default, it takes the stash on the top of the heap, the last sent in, however one can select a specific one \verb|git stash pop stash@{n}|
        \end{itemize}
      \item Delete a stash without applying it: \texttt{git stash drop}
        \begin{itemize}
          \item See above to choose a specific stash
        \end{itemize}
    \end{itemize}
  \item List files followed by \texttt{git}: \verb|git ls-tree <SHA1>|. Advised options:
    \begin{itemize}
      \item \verb|--full-tree|: start from the root of the repository
      \item \verb|-r|: recursive
      \item \verb|--name-only|
    \end{itemize}
  \item \texttt{git revert SHA1}: cancel the modifications done by commit \texttt{SHA1}. More info on the \href{https://git-scm.com/docs/git-revert}{man page} and \href{https://stackoverflow.com/a/4114122}{this answer}.
  \item Add a file but then ignore it. This is quite a common situation: in a multi-developer project, there is a base configuration file and each dev customize it as they wish. One would like to keep the file into the repo, and also not to follow it. The solution is explained \href{https://stackoverflow.com/questions/3319479/can-i-git-commit-a-file-and-ignore-its-content-changes}{here}: add it then change the index
\begin{lstlisting}[language=bash]
git update-index --assume-unchanged <file>
\end{lstlisting}
    To undo:
\begin{lstlisting}[language=bash]
git update-index --no-assume-unchanged <file>
\end{lstlisting}
  \item \texttt{git log}: show the commit logs. \href{https://git-scm.com/docs/git-log}{Manual}
    \begin{itemize}
      \item \texttt{-<n>}, \texttt{-n <n>}: limit the number of commits to output
      \item \verb|--since=<date>|, \verb|--after=<date>|: show commits more recent than \texttt{date}
      \item \verb|--until=<date>|, \verb|--before=<date>|: show commits older than \texttt{date}
      \item \verb|-L <start>,<end>:<file>|: show commits which modified the zone of \texttt{file} delimited by the line numbers \texttt{start} and \texttt{end}
      \item \verb|-L:<function>:<file>|: show commits which modified function \texttt{function} of \texttt{file}
      \item \verb!--<path>|<path/to/filename>!: show commits which modified the files in \texttt{path} (resp.\ the file \verb|path/to/filename|). To be put after all other options;
      \item \verb|--pretty[=<format>]|, \verb|--format=<format>|: customize the format of your output. You may want to choose predefined styles, then \texttt{format} can be chosen in \texttt{oneline}, \texttt{short}, \texttt{medium}, \texttt{full}, \texttt{fuller}, ...
    \end{itemize}
  \item \href{https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks}{\texttt{git} hooks}: hooks are scripts that are automatically triggered before/after certain events (e.g., commit, checkout, push)
      \begin{itemize}
        \item Some examples are already available in each repository. Have a look at directory \texttt{.git/hooks}, you will find a bunch of script with extension \texttt{.sample}. One can write their own script in bash, python, everything one wants. To enable one hook, just remove the \texttt{.sample} extension (e.g., \texttt{pre-commit}) and make it executable.
        \item \href{https://verdantfox.com/blog/how-to-use-git-pre-commit-hooks-the-hard-way-and-the-easy-way}{An example} for pre-commit hooks. Also, check out the \href{https://github.com/pre-commit/pre-commit-hooks}{\texttt{pre-commit} framework}.
      \end{itemize}
  \item Commit cherry-picking (\href{https://git-scm.com/docs/git-cherry-pick}{manual}): apply a specific commit from another branch
\begin{lstlisting}[language=bash]
git cherry-picking <commit>
\end{lstlisting}
    \begin{itemize}
      \item Example: apply to the current branch the third-to-last commit of branch \verb|branch_name|:
\begin{lstlisting}[language=bash]
git cherry-picking <branch_name>~4
\end{lstlisting}
    \end{itemize}
  \item Show config:
    \begin{itemize}
      \item Have a look at the global or local config file: \verb|~/.gitconfig| or \verb|repository/root/.git/config|
      \item List everything: \verb|git config [--global] --list|
      \item Specific key: \verb|git config [--global] --get <key_name>|
      \item Search: \verb|git config [--global] --get-regexp <pattern>|
    \end{itemize}
  \item Aliases: as for bash, one can create custom aliases to shortcut some common commands. In order to to that simply use
\begin{lstlisting}[language=bash]
git config [options] alias.<shortcut> '<cmd>'
\end{lstlisting}
        for instance
\begin{lstlisting}[language=bash]
git config [--global] alias.pr 'pull ---rebase'
\end{lstlisting}
  \item Proxy: some info are given \href{https://gist.github.com/evantoli/f8c23a37eb3558ab8765}{here}. Try to simply run (from wherever)
\begin{lstlisting}[language=bash]
git config --global http.proxy <server>:<port>
\end{lstlisting}
  \item List of files modified by a commit: from this \href{https://stackoverflow.com/a/424142/12152457}{SO's answer} (see also comments)
\begin{lstlisting}[language=bash]
git diff-tree --no-commit-id --name-only -r <sha> # For scripts
# try also --name-status: it gives info if modified, added, deleted,
# mode changes,...
# or...
git show --pretty="" --name-only <sha>
\end{lstlisting}
  \item List all authors / developers in a project: see \href{https://stackoverflow.com/questions/9597410/list-all-developers-on-a-project-in-git}{here} \verb|git shortlog -sne|
  \item Ignore files from the syncing:
    \begin{itemize}
      \item Add them to \texttt{.gitignore}. Since \texttt{.gitignore} itself is synchronized, the exclusion is global and will stay in the tree, meaning that any new clone of the repository will see it; one can also add \texttt{.gitignore} to itself;
      \item Add them to \texttt{.git/info/exclude}. This is local and impacts only the local directory and clone of the repository.
    \end{itemize}
  \item \texttt{git} \textbf{cannot} track empty directories. Hence, one should include a dummy file and add it to the tree. Some people use \verb|.gitkeep| as naming convention for this dummy file.
  \item \texttt{git bisect}: help to find the commit causing the bug by a bisection procedure
    \begin{itemize}
      \item \verb|start|: initialize the procedure.
      \item \verb|bad [commit]|: tag commit as bad (default is current).
      \item \verb|good [commit]|: tag commit as good (default is current).
      \item \verb|reset|: once you have find the buggy commit, quit the procedure and go back to were you were at the beginning.
    \end{itemize}
  \item \verb|git grep| (\href{https://git-scm.com/docs/git-grep}{Manual}): it basically works as \verb|grep| (see \autoref{ssec:grep}) but on tracked files only: \verb|git grep 'time_t' -- '*.[ch]'|. Some bonus options:
    \begin{itemize}
      \item Notice that \verb|--| marks the end of the options.
      \item \verb|--and|, \verb|--or|, \verb|--not|. Option \verb|-e| should be used.
    \end{itemize}
  \item \verb|git blame| (\href{https://git-scm.com/docs/git-blame}{Manual}): Show what revision and author last modified each line of a file. \textbf{ATTENTION:} \texttt{blame} returns info line by line; if you are just interested to know the last commit to date which modified a certain file, then use \verb|git log -- file.txt|
    \begin{itemize}
      \item ``\verb|-L <start>,<end>|'' or ``\verb|-L :<foo>|'': Annotate only the line range given by \verb|start| and \verb|end| or by the function name regex \verb|foo|
    \end{itemize}
  \item Submodules: \href{https://git-scm.com/book/en/v2/Git-Tools-Submodules}{here}.
    \begin{itemize}
      \item Typically, an useful command in \verb|git submodules update [--init]|
      \item The status of the submodules is shown when running \verb|git status|, to avoid that use option \verb|--ignore-submodules=all|
    \end{itemize}
  \item Sometimes the \texttt{.git} directory (where all the \texttt{git} magic happens) is larger than the projects itself: imaging having to store all the commits, changes,\ldots{} \href{https://stackoverflow.com/questions/5277467/how-can-i-clean-my-git-folder-cleaned-up-my-project-directory-but-git-is-sti}{Here} you find how to do a little house-keeping. \verb|git gc| might be an option, as well.
  \item \href{https://git-scm.com/docs/git-filter-branch}{\texttt{git filter-branch}}: modify the tree according to filters. This command is very powerful but it rewrites the history, so, before doing it, be sure to read the link in the dedicated item below.
  \item About \href{https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History}{rewriting \texttt{git} history}. See GitHub help about \href{https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository}{removing sensitive data}. WARNING: it is highly advised not to rewrite the history of a published repository, since collaborators that already had the sources, will certainly have issues since their history does not correspond anymore. Hence, do not use it lightly and only on not-yet published repositories / branches.

\end{itemize}

\subsection{GitLab API}
Users can manage and control a GitLab project via an API. This includes uploading files, creating commits / tags / release / branches, trigger pipeline,\ldots
\begin{itemize}
  \item To access the API an authentication method should be used: either Oauth2 or simply an access token with API rights. The commands given below will use this latter method. To create a token, go to project \texttt{Preferences}, then \texttt{Access Tokens}
  \item The (numeric) ID of the project is necessary, actually, more generally all the URL of the project. It is different from the name of the project. It can be found in the examples \texttt{Preferences > CI/CD > General pipelines > Pipeline triggers}. Keep the URL until the numeric ID.
  \item The complete guide is \href{https://docs.gitlab.com/ee/api/}{here}, but, beware it is huge!
  \item Typically, a request will take the form of a call to the project API via \texttt{curl}, just open a terminal and launch
\begin{lstlisting}[language=bash]
curl --header "PRIVATE-TOKEN: "<your_token>" \
     --request POST \
     --something \
     "https://example.gitlab.com/api/v4/projects/<ID>/<something>"
\end{lstlisting}
    where one has to use an access token and the numeric ID recovered in previous points. In what follows, we give what should replace the ``\texttt{something}'' above.
  \item \href{https://docs.gitlab.com/ee/api/projects.html#upload-a-file}{Upload a file} (it can be later used in a release):
\begin{lstlisting}[language=bash]
curl [...] --form "file=@relative/path/to/file.txt \
      "https://example.gitlab.com/api/v4/projects/<ID>/uploads"
\end{lstlisting}
    If the uploaded succeeded, the path to the online resource is returned / print to screen.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{C} \& \texttt{C++}}
\label{sec:c}
\subsection{\texttt{C}}
Just some tricks.
\begin{itemize}
  \item ATTENTION - Memory management. To some pointers and functions related to them such as \texttt{malloc}, \texttt{realloc} and \texttt{free}, are some of the most confusing things about \texttt{C}. Here, I do not pretend to explain everything, but let me tell you this, which should be a golden rule for developing in \texttt{C}: for every \texttt{malloc} that you call, remember to call also its related \texttt{free}. The impact of non-freed memory may be insignificant on certain problems, but it could quickly snowballing into something really dangerous and crash the run.
  \item It is advised by someone to use preprocessor false statements as a comment zone in which one can put anything (s)he wants to
\begin{lstlisting}[language=C]
#if 0
  This part won't be seen by the preprocessor
  Anything you want, no special caratchers needed
  Although some warning may be issued, for instance
  for unbalanced parantheses
#endif
\end{lstlisting}
  \item Operator \verb|?| (ternary operator): it is a shortcut for a simple \texttt{if} statement.
\begin{lstlisting}[language=C]
/* condition */ ? /* if true, do this */ : /* otherwise, this */
\end{lstlisting}
    For instance it could be useful when one wants to define a \texttt{const} variable which however depends on a certain condition.
\begin{lstlisting}[language=C]
  const int max = (n > m) ? n : m;
\end{lstlisting}
    Notice that in this case, if \verb|m| or \verb|n| are calls to functions, they are evaluated twice, one for the comparison, and one for the assignment. Hence, if the calls are time-consuming, you might want to use temporary variables.
  \item \href{https://www.improgrammer.net/type-casting-c-language/}{Casting}: it is a way to change the type of a variable.
    \begin{itemize}
      \item Sometimes it is hidden: \verb|float a = 1;|. Because of its format, \verb|1| is actually interpreted as an integer and then cast into a floating-point number.
      \item Casting could be done explicitly:
\begin{lstlisting}[language=C]
old_type a = [...];
new_type b = (new_type)a;
\end{lstlisting}
      \item The compiler will always try to cast, but if there is no correlation between the two data types unexpected behaviour and loss of precision may happen. Consider for instance
\begin{lstlisting}[language=C]
float a  = 1.1;
int   ab = (int) a;
\end{lstlisting}
    \end{itemize}
  \item Memory / arrays tricks
    \begin{itemize}
      \item Fastest (?, possibly if one runs sequentially) to reset an array:
\begin{lstlisting}[language=C]
memset(dest, 0, dest_len*sizeof(<dest_type>))
\end{lstlisting}
        (destination, value to copy, number of bits to consider). Notice that since it works on the single bits, this works only with zero, namely that would not work to fill an array with ones (or any value, indeed). Mnemonic: \verb|dest = 0|.
      \item Fastest (?, possibly if one runs sequentially) to copy an array into another: structure similar to the one above. Mnemonic: \verb|receive = send|
\begin{lstlisting}[language=C]
memcpy(receive, send, <n_element_to_copy>*sizeof(<send_type>))
\end{lstlisting}
    \end{itemize}
  \item Booleans:
    \begin{itemize}
      \item Originally, \verb|0| means false and \verb|1| (well, actually, any integer different than zero) means true.
      \item Since \verb|C99|, the type \verb|_Bool| is introduced.
      \item The standard library \verb|stdbool.h| introduces \verb|bool| (which expands to \verb|_Bool|), \verb|false| (expands to \verb|0|) and \verb|true| (expands to \verb|1|).
    \end{itemize}
  \item Loops:
    \begin{itemize}
      \item \texttt{break} exits the innermost loop only (\texttt{for} or \texttt{while}). If one wants to exit all of them, a flag (a \verb|_Bool|/\verb|bool|) should be used.
      \item \texttt{continue} skips the rest of the current iteration, increases the counter and goes to the next iteration (stays in the loop!)
    \end{itemize}
  \item File reading/writing: \href{https://www.programiz.com/c-programming/c-file-input-output}{here}.
  \item Preprocessor
    \begin{itemize}
      \item Compile with \verb|-E| to get the source file preprocessed.
      \item \href{https://gcc.gnu.org/onlinedocs/gcc-7.5.0/cpp/Stringizing.html}{\emph{Stringizing}}
        \begin{itemize}
          \item Macro to make something a string, use \verb|#|: \verb|#define str(s) #s|
          \item Double it if you want to make the content of another macro a string
\begin{lstlisting}[language=C]
#define foo 4.0
#define str(s)  #s
#define xstr(s) str(s)
// Now use xstr(foo) -> "4.0"
\end{lstlisting}
        \end{itemize}
      \item Append / Concatenate: use operator \verb|##|. Consider this\footnote{Did you actually believe that \href{https://hitchhikers.fandom.com/wiki/42}{42} was not going to appear here?! You fool!}
\begin{lstlisting}[language=C]
float pow2(float x){return x*x;}
float pow3(float x){return x*x*x;}
#define _p(a,b) pow##b(a)
[...]
float var = 42.;
float var_square = _p(var,2); // Expands to pow2(var)
float var_cube   = _p(var,3); // Expands to pow3(var)
\end{lstlisting}
    \end{itemize}
  \end{itemize}
\subsubsection{Poorman optimizations}
  Here are some simple optimizations that you can consider, you can think of them as good practices. They won't certainly have much of an impact on the total runtime (in fact, especially with the loops, the compiler will try do anticipate what you want to do and optimize it), but it is useful to have them in mind and of course, it is definitely better to use them. A great deal of them deals with cache optimizations and avoiding cache-misses, it could be interesting to have a look at how a cache is and works and how to get the most out of it. Anywho, here are some optimizations:
    \begin{itemize}
      \item Constant variables. You need to define a variable and you know for sure from the beginning that its values will not change in the current scope. It is then advisable to define them as constant: the compiler will take into consideration this piece of information and use it to optimize the program. In order to make a variable constant, just prepend \texttt{const} to the usual definition \texttt{const int n = 10;}. You try to modify a value of a constant value, you'll get an error or at least a warning. You can also make the arguments of a function constant, this may be beneficial in three ways: optimization, allow the user to identify input and output parameter, and avoid error like modifying a value that you are not supposed to. However, it is usually not advised to make an argument of a function constant if it's one value (\texttt{int}, \texttt{float},\ldots) since in this case the performance gains will be null. Still it could be beneficial for the lecture.
      \item Data locality: try to define variables as close as possible to where you are going to use them. Basically, it is sometimes better to redefine a variable in a loop at each iteration rather than define it outside and change it at each iteration.
      \item Array accessibility. Somehow related to the previous point, you are looping through a huge array with hundreds or thousands of elements. If you are going to use the value several times, redefine a pointer that points just the current item. For instance,
\begin{lstlisting}[language=C]
for (int i=0; i < 10000; i++){
  double *a_i = a + i;
  // use now a_i[0]
}
\end{lstlisting}
        This can be pretty useful if you are dealing with coordinates, for instance
\begin{lstlisting}[language=C]
for (int i=0; i < 10000; i++){
  double *a_i = a + 3*i;
  // a_i[0] will be the x-coordinate of the i-th point
  // a_i[1] the y one and a_i[2] the z one
}
\end{lstlisting}
        Why that? Well, it actually takes some time to move in the memory to recover a value so accessing \texttt{v[1]} is (slightly) faster than \texttt{v[1000]}, having to doing it several thousands of times may impact the performances.
      \item Prefer arrays to matrices: using \verb|a[i][j]| is convenient but if the dimensions are large is pretty slow, the reason is somehow related to the previous item. Anyway, the bottom line is: A unique array is much faster: \verb|a[n_cols*i+j]| (if you have to choose only one optimization to remember, choose this one, big times)
      \item Prefer looping by columns rather than by rows. Another tips about memory and matrices, the reason of it is the cache: when the computer access a location in the memory, it also loads some chunks of memory that are just next to the one it actually needs, In this way, if it will need this additional piece of memory in the next iterations (as it is often the case), it already has it and avoid loading it thus saving some time. When looping by rows, the data that we request are (often) too far away from each other and a load at each iteration is almost certain. Bottom line: (notice the switch of the indexes and, most importantly, which loop is the innermost) this
\begin{lstlisting}[language=C]
for (int i=0; i < n_rows; i++)
  for (int j=0; j < n_cols; j++)
    a[i*n_cols+j] *= 2;
\end{lstlisting}
        is better than
\begin{lstlisting}[language=C]
for (int j=0; j < n_cols; j++)
  for (int i=0; i < n_rows; i++)
    a[i*n_cols+j] *= 2;
\end{lstlisting}
      \item Loop unrolling. Well, that is almost useless since the compiler will sometimes try do it even without being asked. However, a \texttt{for} loop has an overhead. So if it is not much of a fuss, you can try to write yourself by hand the iterations. Again, nowadays loop unrolling is practically useless but it is interesting to know how things work.
      \item Keep loops as straight as possible. The compiler will try to guess what the next operation will be, try to (almost) perform consecutive iterations at the same time, load some memory which is adjacent to the one you are requesting,\ldots{} you get the idea. If it does not manage, the program has to do unload what it thought and load what you really asked, and that takes time. Hence, avoid \texttt{if} statement in loops as much as possible, avoid jumping around an array, basically keep a straight path.
      \item Short types. Sometimes you know that a certain variables will not exceed a threshold, you can then using short types, which takes less memory than standard types. For instance, looping through the components of a vector, use \texttt{short int}
\begin{lstlisting}[language=C]
for (short int i=0; i < 3; i++){
  // Do something
}
\end{lstlisting}
        (You may wonder, so why not use it all the times? Well, the maximum number that a short integer can represent is not that much and you may never reach the bound of the loop)
      \item Inline function. If a function is less than a dozen line long, consider inlining it. If this concept is new to you, know that: he code of an inline functions is copied as is where it is requested, so that by using inlined functions we don't get the overhead for the call to a function. Calling a long inlined function many times makes the executable larger (many lines of code) and that is something to avoid, hence, a dozen lines is a good thumb-rule.
      \item If dealing with synchronization in parallel mode, try to call those functions as less as possible. Instead of doing \texttt{n} times a synchronization of a vector of 3 values, prefer only one synchronization of a vector of \texttt{3*n} values.
    \end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{C++}}
Some stuff that are different from plain \texttt{C}
\begin{itemize}
  \item Pointers vs.\ References: this \href{https://stackoverflow.com/a/57492/12152457}{SO answer}, this \href{https://www.geeksforgeeks.org/when-do-we-pass-arguments-by-reference-or-pointer/}{post} about usages in functions, mind also \href{https://www.tutorialspoint.com/cplusplus/returning_values_by_reference.htm}{this} concerning references and return values.
  \item lvalues vs.\ rvalues (what we are going to say is not 100\% correct, but it gives a good idea of what those two are. Moreover, technically, there are two types of rvalue: prvalue and xvalue)
    \begin{itemize}
      \item Originally, in the plain \texttt{C} days, lvalue was an expression the may appear on the \emph{left}- or right-hand side of an assignment; rvalues \emph{can only} appear at the \emph{right}-hand side of an assignment
      \item Simply (but not entirely exactly) put: an lvalue is an expression that refers to a memory location and allows us to take the address of that memory location via the \verb|&| operator. An rvalue is an expression that is not an lvalue.
      \item Some rules
        \begin{itemize}
          \item If a function returns a value that value is considered an rvalue.
          \item If a function returns a lvalue reference (const or non-const) that value is considered an lvalue.
          \item If a function returns a rvalue reference (but there is normally no reason to do so!), that value is an rvalue.
        \end{itemize}
      \item Examples
        \begin{itemize}
          \item An rvalue cannot be used to initialize a non-const lvalue reference, while it can be used to initialize const references
            \begin{lstlisting}[language=C++]
double & pi =3.14;// wrong! A literal expr is a rvalue
double const & pi =3.14;// Ok!
            \end{lstlisting}
          \item An rvalue expression can be used to initialize a variable, but it cannot be initialized
            \begin{lstlisting}[language=C++]
int pippo();
int & pluto(int& a);
int & pluto2(const int & a);
auto p=pippo();   // ok
int & c=pluto(p); // ok function returns a lvalue here!
int & d=pluto(3); // NO! 3 is an rvalue cannot be assigned
                  // to a (lvalue) reference
int & e=pluto2(3); // ok, mind the const
// lvalues:
int i = 42;
i = 43; // ok , i is an lvalue
int* p = &i ; // ok, i is an lvalue
int& foo() ;
foo() = 42; // ok, foo() is an lvalue
int* p1 = &foo() ; // ok, foo() is an lvalue
// rvalues:
int foobar() ;
int j = 0;
j = foobar() ; // ok, foobar() is an rvalue
int* p2 = &foobar() ; // error: cannot take the
                      // address of an rvalue
j = 42; // ok, 42 i s an rvalue
            \end{lstlisting}
        \end{itemize}
    \end{itemize}
  \item Type qualifiers
    \begin{itemize}
      \item \texttt{const}: A \texttt{const} variable cannot be modified by the code.
      \item \texttt{volatile}: \texttt{volatile} variables may be modified by an external device / piece of code / hardware,\ldots This will tell the compiler that, even if in the code the such a variable does not change, it could at anytime as effect as an unknown operation, so that the compiler won't make optimizations.
      \item \texttt{const volatile}: a variable that cannot be modified by the code but can still be modified by an external action.
    \end{itemize}
  \item \texttt{const} member methods \& \texttt{mutable} attributes: A method can be defined as \texttt{const}, this means that the function cannot change the attributes of the object (you can see this as forcing the pointer \texttt{this} to be \texttt{const})\ldots \emph{UNLESS} an attribute was declared \texttt{mutable}: in that case it can be modified even in \texttt{const} methods
  \item \href{https://en.cppreference.com/w/cpp/language/lambda}{Lambda functions}: \verb|[ captures ] ( params ) <qualifier> -> ret_type { body }|
    \begin{itemize}
      \item \verb|captures|: The capture list defines the outside variables that are accessible from within the lambda function body. The list may starts with a default capture, \verb|&| by reference, or \verb|=| by copy
      \item \verb|params|, \verb|body|: as any functions
      \item The qualifier \texttt{mutable} tells that the things captured by copy are modifiable
      \item The return type \verb|ret_type| is not mandatory, otherwise it is inferred from the \texttt{return} statement.
    \end{itemize}
  \item \texttt{->} in function definition: it is used to define the return type, see above with lambda functions. This is necessary, for instance, when one wants to use \texttt{decltype} with one of the parameters. See \href{https://stackoverflow.com/a/22515589/12152457}{here}
    \begin{lstlisting}[language=C++]
template <typename T1, typename T2>
auto foo(T1 a, T2 b) -> decltype(a + b);
    \end{lstlisting}
  \item Smart pointers: they were implemented to help developers with data-leaks since their main features is that no \texttt{delete} function has to be called since \textbf{the freeing is done automatically} at the end of the variable scope. Sources: \href{https://www.geeksforgeeks.org/smart-pointers-cpp/}{here}, \href{https://www.internalpointers.com/post/beginner-s-look-smart-pointers-modern-c}{here}, and \href{https://docs.microsoft.com/en-us/cpp/cpp/smart-pointers-modern-cpp?view=msvc-170}{here}.
      \begin{itemize}
        \item Three types:
          \begin{itemize}
            \item \verb|unique_ptr|,
            \item \verb|shared_ptr|,
            \item \verb|weak_ptr|
          \end{itemize}
      \end{itemize}
  \item Literals for numbers (\texttt{<n>} tells the position of the digits so that one understands if its a pre- or suffix):
    \begin{itemize}
      \item \texttt{<n>f}: float (Attention: the default is double)
      \item \texttt{<n>l(l)}: long (long) double or integer
      \item \texttt{<n>u}: unsigned integer, may be combined with \texttt{l(l)}
      \item \texttt{<n>b}: binary
      \item \texttt{0x<n>}: hex
      \item \texttt{0<n>}: octal
      \item \texttt{<n>e<n>}: exponent form, may be combined with \texttt{l}, \texttt{f}
    \end{itemize}
\end{itemize}

\subsubsection{Data structures}
\begin{itemize}
  \item \verb|map| \& \verb|unordered_map|: Ordered (resp.\ unordered) associative container that contains key-value pairs with unique keys.
    \begin{itemize}
      \item \verb|operator[key]|: access value associated to the given key. If the given key does not exist, it adds it, even if it is a right-hand call, as in, \verb|a = m[k]|
      \item \verb|at(key)|: access value associated to the given key. If the given key does not exist, it throws.
      \item When looping, \verb|for(auto e : m)|, the elements are pairs, so that the key is accessed with \verb|e.first| and the value \verb|e.second|. In recent versions, one can even use
        \begin{lstlisting}[language=C++]
for (auto & [key, value] : m) {
  // Do stuff
}
        \end{lstlisting}
      \item Lookup: \verb|count(key)| returns the number of elements matching specific key, \verb|find(key)| returns an iterator to the element (pair) with key equivalent to the given one, if it is not found, \verb|end()| is returned.
      \item When using the unordered version, there is no guarantee about the order used when iterating as in \verb|for(auto e : m)|, hence the result is not deterministic/not repeatable, although it is the same when during the same run
    \end{itemize}
\end{itemize}

\subsubsection{Some tips about Object-Oriented Programming}
\begin{itemize}
  \item Design pattern: some resources \href{https://www.tutorialspoint.com/design_pattern/design_pattern_overview.htm}{here} and \href{https://sourcemaking.com/design_patterns}{here}
  \item Functor: an object that acts like a function.
    \begin{lstlisting}[language=C++]
class Add {
private:
    int num;
public:
    Add(int n) : num(n) {  }

    // This operator overloading enables calling
    // operator function () on objects of Add
    int operator () (int add_num) const {
        return num + add_num;
    }
};
[...]
Add add_10 = Add(10)
int res = add_10(5) // 15
    \end{lstlisting}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\texttt{OpenMP}}
\texttt{OpenMP} or \texttt{OMP} is a shared-memory interface for \texttt{C}/\texttt{C++} (and \texttt{Fortran} as well) for parallel computing. \emph{Shared-memory}, simply put, means that the memory may be accessed, read, and modified by any thread at any given moment. Most of the times, parallelize a piece of code with \texttt{OMP} comes down to prepend dedicated pragmas (\verb|#pragma omp [...]|) to \texttt{for} loops (the last two sentences were \emph{very} wrong, but it might get you on the right direction if this is the first time you have heard of parallelism and \texttt{OMP}). Now that you have the bigger picture and you are thinking "Well, that was easy, I can do it!", welcome to the hardest part, where not so rarely you have to change your piece of code in order not to have threads modifying each other's work.
  \begin{itemize}
    \item A nice training is available on the IDRIS \href{http://www.idris.fr/formations/openmp/}{website}.
    \item A \href{https://www.openmp.org/wp-content/uploads/OpenMP-4.0-C.pdf}{cheat-sheet} (for version 4.0).
    \item Unless dedicated instruction are provided (see a couple of items below), every line of code inside a parallel zone is executed by \emph{all} the threads.
    \item A killer feature is the \texttt{reduction}s: compute sums, find max/min, or any operation you'd like (as long as you define it).
    \item This is something that is true generally for any parallel framework not only \texttt{OMP}: parallel code and I/O operations (reading/writing) can become tricky pretty easily, be advised (Remember: several threads working on the same thing? Too many cooks spoil the broth).
    \item It is important to have in mind which commands are \emph{blocking}, meaning that have a hidden barrier at the end (a point at which all the threads have to meet before they are allowed to continuing the execution of the program). For instance, \verb|#pragma omp [parallel] for| is blocking (however, keep in mind the \verb|nowait| clause).
    \item Sometimes one need that one thread only may work on something at the same time. This is where \verb|#pragma omp critical| and \verb|#pragma omp atomic| come into play, where the last one provide better performances but allows only very few operations like reading, writing, and updating (e.g. \verb|sum += a[n];|).
    \item In parallel mode but this particular piece of code should be executed once and once only? Put it in dedicated pragmas like \verb|#pragma omp master| (only the master thread, usually the one with ID 0, is allowed to execute the code) or with \verb|#pragma omp single| (only the first threads arrived at that point executes it, this is your best choice most of the times). They have no barriers.
    \item Just to get it right, let us recap the difference between the last two points. With \texttt{critical} or \texttt{atomic} all the threads execute the command, but one at the time. With \texttt{single} or \texttt{master} the code is executed only once.
  \end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{python}}
\label{sec:python}
(I used to be better with \texttt{python} but I don't use it so much now, so these tips here are not many nor much useful. I'm sorry. If you agree, please contribute!)
\begin{itemize}
  \item Debugging, info \href{https://docs.python.org/2/library/pdb.html}{here}: \texttt{python -m pdb script.py}. Commands are similar to \texttt{gdb} (\ref{sec:gdb}).
  \item Virtual environments: have look \href{https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/}{here} or \href{https://docs.python.org/3/tutorial/venv.html}{here}.
    \begin{enumerate}
      \item Create: \verb|python3 -m venv <env_name>|. The argument \verb|env_name| is arbitrary: let's fix it to \verb|test|
      \item Activate: \verb|source test/bin/activate|. From now on the python version of the virtual element is loaded, you may check this with \verb|which python|. Hence, for instance, \verb|pip| will install packages in the virtual environment only
      \item Deactivate: \verb|deactivate|
      \item Remove: just \verb|rm -rf <env_name>|
    \end{enumerate}
  \item \texttt{pip}: allows you to download and update python libraries
    \begin{itemize}
      \item Typical call: \verb|pip install <package>|. Add options \verb!--upgrade|-U! to upgrade. In recent versions, \verb|python3 -m pip [...]| is advised.
      \item One may add a configuration file, see \href{https://pip.pypa.io/en/stable/topics/configuration/}{here}
      \item You'll need access to some directories, thus it is advised to have a local install: pass option \verb|--user|.
      \item Proxy: pass the option \verb|--proxy=user@server.dom:port|. However, it might not work if some dependencies have to be downloaded as well. In that case, try exporting the shell variables \verb|HTTP_PROXY=<proxy>| and \verb|HTTPS_PROXY=<proxy>|. It might be helpful to add a line in the configuration file as explained \href{https://stackoverflow.com/questions/43473041/how-to-configure-pip-per-config-file-to-use-a-proxy-with-authentification}{here}
      \item Get list of outdated packages: \verb|pip list --outdated|.
      \item Get a list of currently installed packages with versions: \verb|pip freeze > [file.txt]|
      \item Install from a requirements file (see freezing just above): \verb|pip install -r [file.txt]|
      \item When installing/upgrading problems may occur with older versions of the \texttt{C} compiler, \texttt{GCC}: try and force \texttt{C99} standard by setting \texttt{CFLAGS} before installing: \verb|export CFLAGS='-std=c99'|
      \item Select a specific version of the package: \verb|python3 -m pip install package==6.66|
    \end{itemize}
  \item A nice \href{https://medium.com/@anushkhabajpai/top-data-science-cheat-sheets-ml-dl-python-r-sql-maths-statistics-5239d4568225}{post} with cheat-sheets for several \texttt{python} libraries (as well as \texttt{R} and ML)
  \item Load custom modules: one takes advantage of \verb|sys.path| which is a list of directories where \texttt{python} looks for module. Suppose that you want to import module \texttt{myMod} which is in \texttt{/path/to}, then a typical call would be
\begin{lstlisting}[language=python]
import sys
sys.path.append('/path/to')
# or...
sys.path.insert(0, '/path/to')
# Now one can import
import myMod  # noqa: E402
\end{lstlisting}
    The comment to the import allows to avoid warnings / errors from linters if you use them
  \item Format strings: several ways are available, have a look \href{https://realpython.com/python-string-formatting/}{here}, but also \href{https://pyformat.info/}{here} and to the \href{https://docs.python.org/3.10/library/string.html#format-string-syntax}{doc}
    \begin{itemize}
      \item Old-style, ``\verb|%|'': \verb|'Hi, %s!' % 'Bob'|
        \begin{itemize}
          \item \verb|"Hi, %s! It's %s" % ('Bob','Alice')|
          \item \verb|"Hi, %(v1)s! It's %(v2)s" % {'v1':'Bob','v2':Alice'}|
        \end{itemize}
      \item New-style, \verb|str.format()|: \verb|'Hi, {}!.format('Bob')'|, \verb|'Hi, {:s}!'.format('Bob')|
        \begin{itemize}
          \item \verb|"Hi, {0}! It's {1}".format('Bob','Alice')| (or \verb|{<n>:s}| for instance))
          \item \verb|"Hi, {v1}! It's {v2}".format(v1='Bob',v2='Alice')| (or \verb|{<var>:s}| for instance)
          \item \verb|d={'v1':'Bob','v2':'Alice'}; "Hi, {v1}! It's {v2}".format_map(d)| equivalent to above item
        \end{itemize}
      \item \texttt{f}-strings, \verb|f'[.]'|: \verb|who='Bob'; greet=f'Hi, {who}!'| (or \verb|greet = f'Hi, {who:s}!'|)
        \begin{itemize}
          \item \verb|v1='Bob'; v2='Alice'; greet="Hi, {v1}! It's {v2}"|
          \item Braces need to be escaped: e.g.\ \verb|fr'{3}'| gives \verb|3|,  \verb|fr'{{3}}'| gives \verb|{3}|. Moreover, with variables:
\begin{lstlisting}[language=python]
test = "TEST"
print(f"That's a {test}")
# That's a TEST
print(f"That's a {{test}}")
# That's a {test}
print(f"That's a {{{test}}}") # 2 for escaping, 1 for variable
# That's a {TEST}
\end{lstlisting}
        \end{itemize}
      \item Raw-strings: identified by \texttt{r}, the backslash is interpreted as backslash (automatically escaped). For instance, \verb|'\n'| leads to a newline, \verb|r'\n'| leads to \verb|\n|.
      \item Combine \texttt{f}- and \texttt{r}-strings: just use \verb|fr'...'|
    \end{itemize}
  \item Mutable vs.\ immutable types
    \begin{itemize}
      \item \textbf{Mutable}: \texttt{list}, \texttt{dictionary}, \texttt{set}, \texttt{bytearray}, user-defined classes
      \item \textbf{Immutable}: \texttt{int}, \texttt{float}, \texttt{decimal}, \texttt{complex}, \texttt{bool}, \texttt{string}, \texttt{tuple}, \texttt{range}, \texttt{frozenset}, \texttt{bytes}.
      \item An example
\begin{lstlisting}[language=python]
aList, aSet = [1, 2, 3], (1, 2, 3)
print(id(aList), id(aSet))
# 44045192 43989032
aList += [4, 5]
aSet += (4, 5)
print(id(aList), id(aSet))
# 44045192 30323024
# The set ID changed!
\end{lstlisting}
    \end{itemize}
  \item \verb|pass|: does nothing. But it is useful as place holder
\begin{lstlisting}[language=python]
class This:
  pass # Remember to write this
\end{lstlisting}
  \item \verb|try ... expect| and alike: An example
\begin{lstlisting}[language=python]
try:
    # Code here
except:
    # If error happens in try zone, this code is run...
else:
    # ... otherwise, if no exception caught, run this
finally:
    # This code is always run, with or without exception
\end{lstlisting}
    \begin{itemize}
      \item One can use several \texttt{except} zones to catch different exceptions
\begin{lstlisting}[language=python]
except Exception_1:
    # If error of type Exception_1
except Exception_2:
    # If error of type Exception_2
except Exception:
    # If any other error type, except Keyboard interrupt
\end{lstlisting}
      \item Print traceback with \verb|traceback.format_exc()| from module \texttt{traceback}
    \end{itemize}
  \item Variables and members, taken from \href{https://stackoverflow.com/questions/7969949/whats-the-difference-between-globals-locals-and-vars}{here}
    \begin{itemize}
      \item \verb|globals()| always returns the dictionary of the module namespace. The dictionary typically contains all the variables defined in the \emph{global} scope.
      \item \verb|locals()| always returns a dictionary of the current namespace. Basically, as above but with \emph{local} scope.
      \item \verb|vars()| returns either a dictionary of the current namespace (if called with no argument, equivalent to \verb|locals()|) or the dictionary of the argument (that is, let \verb|a| be an instance of a class, then \verb|vars(a)| would provide all the attributes, members and/or method, of \verb|a|).
    \end{itemize}
  \item The underscore: see \href{https://dbader.org/blog/meaning-of-underscores-in-python}{here}
  \item Unpacking operators: \verb|*| iterable unpacking, and \verb|**| dictionary unpacking, see \href{https://geekflare.com/python-unpacking-operators/}{here}
  \item ``\verb|_|'': placeholder for unused arguments / returns
    \begin{itemize}
      \item It can be unpacked with \verb|*| (see above)
\begin{lstlisting}[language=python]
a = [1, 2, 3, 4, 5]
first, *_, last = a
print(first, last) # 1 5
\end{lstlisting}
    \end{itemize}
  \item \href{https://wiki.python.org/moin/Generators}{Generators}: Generator functions allow you to declare a function that behaves like an iterator, i.e.\ it can be used in a for loop. This is faster than creating lists on purpose. Brief \href{https://www.programiz.com/python-programming/generator}{intro}. Generators do not \emph{return}, they \emph{yield}. An example
\begin{lstlisting}[language=python]
def zero_or_square(n):
  for i in range(-n, n):
    if i <= 0:
      yield 0
    else:
      yield i**2

for i in zero_or_square(5):
  print(i)
\end{lstlisting}
  \item Ternary operator:
\begin{lstlisting}[language=python]
msg = "True" if condition else "False"
\end{lstlisting}
    or suppose that you have an argument which can be passed or not (hence in this case equal to \verb|None|)
\begin{lstlisting}[language=python]
msg = arg_msg or "Your message here"
\end{lstlisting}
  \item Default function arguments: if containers or complex types, prefer using \verb|None| as default parameter then defining it inside the function. See \href{https://www.geeksforgeeks.org/default-arguments-in-python/}{here}. This allows to avoid the following (often unwanted) behaviour (it happens also with mutable containers such as dictionaries):
\begin{lstlisting}[language=python]
def foo(l = [], a = 5):
  l.append(0)
  a += 1
  print(a, l)
foo() # Prints: 6 [0]
foo() # Prints: 6 [0,0]
\end{lstlisting}
  \item Classes:
    \begin{itemize}
      \item The hidden members \verb|__dict__| holds a dictionary with all the members of the class/instance. It's basically equivalent to \verb|vars| (see above)
      \item Operations with members:
        \begin{itemize}
          \item Get / Set: \verb|getattr(<obj>, <mmbr>[, <dflt>])| / \verb|setattr(<obj>, <mmbr>, <val>)|
          \item Delete: \verb|delattr(<obj>, <mmbr>)|
          \item Interrogate for existence (works with methods too): \verb|hasattr(<obj>, <mmbr>)|
        \end{itemize}
      \item Random stuff about classes (hidden) methods
        \begin{itemize}
          \item \verb|@staticmethod| vs \verb|@classmethod|: some info \href{https://www.geeksforgeeks.org/class-method-vs-static-method-python/}{here}
          \item \verb|__init__(self[,args])|: creator
          \item \verb|__call__(self[,args])|: overload operator \verb|( )|
          \item \verb|__getitem__(self, key)|: overload evaluation with operator \verb|[ ]|, e.g.\ \verb|a = obj[n]|
          \item \verb|__setitem__(self, key, val)|: overload assignment with operator \verb|[ ]|, e.g.\ \verb|obj[n] = a|
          \item \verb|__add__(self, other)|: overload operator \verb|+|, see \href{https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types}{here}.
            \begin{itemize}
              \item You may overload also \verb|-| with \verb|__sub__|, \texttt{*} with \verb|__mult__|, etc\ldots
              \item \verb|a + b| is interpreted as \verb|a.__add__(b)|. However, lets say that \texttt{a} is not an instance of your class, but \verb|b| is. In this case, only be \verb|b + a| work. In order to take into account also the Reverse case, define also \verb|__radd__| (\verb|__rsub__|,\ldots). Most of the time, if the operation is symmetric, one can simply put \verb|__radd__ = __add__|.
              \item The in-place versions of the above mentioned operators are: \verb|__iadd__| for \verb|+=|, \verb|__isub__| for \verb|-=|,\ldots
            \end{itemize}
          \item \verb|__int__(self)|: overload cast \verb|int(<n>)|. Same applies for \verb|str|, \verb|float|
            \begin{itemize}
              \item The cast to \verb|str| allows one to use function \verb|print()| directly
            \end{itemize}
          \item \verb|__eq__(self,other)|: overload \verb|==|. Similarly, \verb!__ne|lt|le|gt|ge__!
            \begin{itemize}
              \item If \texttt{eq} not present, \texttt{==} is ensured by \texttt{is} (checks the ID)
              \item As long as there is a \texttt{==}, you can use the \verb|[not] in| keyword
            \end{itemize}
        \end{itemize}
    \end{itemize}
  \item Printing colors: e.g.
\begin{lstlisting}[language=python]
class Bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKCYAN = '\033[96m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'
print(f'{Bcolors.FAIL}FAILED{Bcolors.ENDC}')
\end{lstlisting}
  \item Profiling: see \href{https://docs.python.org/3/library/profile.html}{here}, basically use \texttt{cProfile}. One can use it as script to profile another script:
\begin{lstlisting}[language=bash]
python -m cProfile script.py
\end{lstlisting}
    \begin{itemize}
      \item Options: \verb|-s <stat>| sort by statistic \texttt{stat} (e.g.\ time, number of calls,\ldots), \verb|-o output.log| output file
    \end{itemize}
  \item Memory profiling: \href{https://github.com/pythonprofilers/memory_profiler}{\texttt{memory\_profiler}}
  \item Copying in \texttt{python}, shallow- vs.\ deep-copy: \href{https://www.programiz.com/python-programming/shallow-deep-copy}{here}
    \begin{itemize}
      \item See \href{https://stackoverflow.com/a/46939443}{this SO answer} for an example of create a method \texttt{copy} for a custom class
    \end{itemize}
  \item Function arguments: have a look \href{https://www.python-course.eu/python3_passing_arguments.php}{here}
    \begin{itemize}
      \item \emph{by-value} or \emph{by-reference}? Basically if immutable \emph{by-value}, otherwise \emph{by-reference}. In fact, the real mode is \emph{by object reference}!
      \item Using \texttt{*} (star) and \texttt{**} double-star
      \item \ldots{}similarly for \texttt{args} and \texttt{kwargs}: have a look \href{https://realpython.com/python-kwargs-and-args/}{here}
      \item Consider these examples
\begin{lstlisting}[language=python]
def foo(a, *args, b=4, **kwargs):
    print(f"{a=}, {args=}, {b=}, {kwargs=}")
foo(3           ) # a=3, args=(),    b=4, kwargs={}
foo(3,5         ) # a=3, args=(5,),  b=4, kwargs={}
foo(3,5,  6     ) # a=3, args=(5,6), b=4, kwargs={}
foo(3,5,b=6     ) # a=3, args=(5,),  b=6, kwargs={}
foo(3,5,b=6,c=10) # a=3, args=(5,),  b=6, kwargs={'c': 10}

def bar(a, b, *args, **kwargs):
    print(f"{a=}, {args=}, {b=}, {kwargs=}")
bar(3           ) # Error: b required
bar(3,5         ) # a=3, args=(),    b=5, kwargs={}
bar(3,5,  6     ) # a=3, args=(6,),  b=5, kwargs={}
bar(3,5,b=6     ) # Error: multiple b
bar(3,b=6,5     ) # Error: positional after keyword
bar(3,  6,5     ) # a=3, args=(5,),  b=6, kwargs={}
bar(3,  6,5,c=10) # a=3, args=(5,),  b=6, kwargs={'c': 10}
bar(3,  6,  c=10) # a=3, args=(),    b=6, kwargs={'c': 10}
\end{lstlisting}
    \end{itemize}
  \item Type hints: one can provide types to variable, arguments and return values of a function. These hints \textbf{won't} be used by \texttt{python} (e.g.\ it isn't \texttt{C}). Type hints are for developers and for IDEs: basically they make the code simpler to read (very useful when developing code to which other user will interface) and help IDEs to infer types of objects in order to offer better prediction.
    \begin{itemize}
      \item To go further: \href{https://stackoverflow.com/a/32558710}{here}, \href{https://www.infoworld.com/article/3630372/get-started-with-python-type-hints.html}{here}
      \item Use module \href{https://docs.python.org/3/library/typing.html}{\texttt{typing}}
      \item For built-in structures, in older versions use, e.g., \texttt{Dict}, \texttt{Tuple}, \texttt{List}; otherwise in newer version just standard is accepted, e.g., \verb|dict[str, str]|
      \item For more than one possible types, use \verb|Union|. In recent versions, ``\verb!|!'' (pipe, like in \emph{or}) is accepted as well
      \item For optional arguments that can assume \verb|None| or another type, use \verb|Optional|
      \item Skip line: add comment \verb|# type: ignore|
      \item An example below
\begin{lstlisting}[language=python]
from typing import List, Dict
# Variables: the followings are equivalent
n: int = 10
#
n: int
n = 10
#
n = 10 # type: int # Another comment
#
l : List[int] = list(range(5))
#
d : Dict[str, int] = {'Brazil': 5, "Italy": 4, "France": 2}
# Functions
def fib(n : int, label : str) -> int:
  a, b = 0, 1
  while b < n:
    a, b = b, a + b
  print(label)
  return a
\end{lstlisting}
      \item Let us be clear: \texttt{python} basically discards type hints, hence the following won't raise any warnings nor errors: \verb|name : int = 'Ajeje'|
      \item \href{https://mypy.readthedocs.io/en/stable/index.html}{\texttt{mypy}}: write annotations indicating the types of your variables, parameters, and return values, then run \texttt{mypy} to check if your code is coherent (are you assigning a list to a variable that should a dictionary? and so on\ldots). The annotations do not interfere with the code when you are running directly the script.
    \end{itemize}
  \item \texttt{python} is nice, \texttt{C} is better: hence why not \href{https://cython.readthedocs.io/en/latest/index.html}{\texttt{Cython}}?
  \item Dealing with \texttt{zip} files: module \href{https://docs.python.org/3/library/zipfile.html}{\texttt{zipfile}}. See a discussion \href{https://realpython.com/python-zipfile/}{here}. For instance, use without extracting
\begin{lstlisting}[language=python]
with zipfile.ZipFile('my_file.zip', mode='r') as archive:
  # Get list of files in archive
  fl = archive.namelist()
  for f in fl:
    with open(f, 'r') as op_f:
      # Do something
\end{lstlisting}
  \item Run shell commands from \texttt{python} script
    \begin{itemize}
      \item \verb|os.system('echo Ciao')|
      \item It is advised to used the \href{https://docs.python.org/3/library/subprocess.html#subprocess.Popen.communicate}{\texttt{subprocess}} module and its \texttt{run} function or the more flexible \texttt{Popen} class
        \begin{itemize}
          \item The argument is a list of strings which joined form the command
\begin{verbatim}
list_dir = subprocess.Popen(["ls", "-l"])
\end{verbatim}
          \item Mind that, differently from \verb|os.system|, \texttt{subprocess} does not wait for the command to finish, hence the python script continues. In order to wait use the \texttt{wait} method.
\begin{verbatim}
list_dir = subprocess.Popen(["ls", "-l"])
list_dir.wait()
\end{verbatim}
          \item These \href{https://stackoverflow.com/questions/13332268/how-to-use-subprocess-command-with-pipes}{two} \href{https://stackoverflow.com/questions/295459/how-do-i-use-subprocess-popen-to-connect-multiple-processes-by-pipes}{examples} address the piping. For instance, one can store the output in a \texttt{PIPE} object so that it can be fed to a second command
\begin{verbatim}
ps = subprocess.Popen(('ps', '-A'), stdout=subprocess.PIPE)
output = subprocess.check_output(('grep', 'process_name'), stdin=ps.stdout)
\end{verbatim}
        \end{itemize}
    \end{itemize}
  \item \href{https://numpy.org/doc/stable/index.html}{\texttt{numpy}}
    \begin{itemize}
      \item \texttt{numpy} and the \texttt{axis} keyword
        \begin{itemize}
          \item TL;DR: \verb|axis=0| acts over a column, \verb|axis=1| over a row. Hence,
\begin{lstlisting}[language=python]
x=numpy.ones([3,4])
x.sum(axis=0) # Gives [3, 3, 3, 3]
x.sum(axis=1) # Gives [4, 4, 4]
\end{lstlisting}
          \item The value of \texttt{axis} indicate on which dimension the operation is done (in a certain sense, which direction collapses after the operation).
          \item The value correspond to the index of the direction in the result of \verb|size()|, for instance. Think about it: above \verb|x| was a 3-rows and 4-columns matrix. Then, \verb|x.size() # =(3,4)|
        \end{itemize}
      \item From matrix to array:
        \begin{itemize}
          \item \texttt{flatten} returns a copy
          \item \texttt{ravel} does it in place
        \end{itemize}
      \item \texttt{numpy} and memory: here is an interesting \href{https://pythonspeed.com/articles/numpy-memory-views/}{article}
      \item To complete the above item, see the \href{https://numpy.org/doc/stable/user/basics.copies.html}{official doc} about views and copies
      \item Sorting \& alike
        \begin{itemize}
          \item Get a indexes with \verb|np.argmin| and \verb|np.argsort|
        \end{itemize}
      \item Types
        \begin{itemize}
          \item Change type with \verb|.astype(<type>)|. It usually copy the array, hence allocating memory, however one can avoid this by adding arguments \texttt{copy=False}
          \item A \texttt{np} array can have type string, however all the elements have to have the same length. If it is not the case, one may try generic type \texttt{object}
        \end{itemize}
    \end{itemize}
  \item \href{https://docs.python.org/3/library/functools.html}{\texttt{functools}}: functions for callable objects (e.g.\ functions)
    \begin{itemize}
      \item \verb|partial(foo, *args, **kwargs)|: Return a new partial object which when called will behave like \texttt{foo} called with the positional arguments \texttt{args} and keyword arguments \texttt{kwargs}.
\begin{lstlisting}[language=python]
def foo(a,b): print(f'a:{a}, b:{b}')
ptf_a = partial(foo, 3) # argument a is 3
ptf_a(4) # print a:3, b:4
ptf_b = partial(foo, b=3) # argument b is 3
ptf_b(4) # print a:4, b:3
\end{lstlisting}
        \begin{itemize}
          \item For class methods use \texttt{partialmethod}
        \end{itemize}
      \item \verb|reduce(foo, iter)|: reduce iterable \texttt{iter} by function \texttt{foo}. For instance if \texttt{foo} is addition, then reducing will be equivalent to accumulate
    \end{itemize}
  \item \href{https://docs.python.org/3/library/timeit.html}{\texttt{timeit}}: useful built-in module to measure performances
    \begin{itemize}
      \item \lstinline[language=python]{timeit.timeit(stmt='pass', setup='pass', number=1000000, globals=None)}: run \texttt{stmt} \texttt{number} times after having run \texttt{setup} as a pre-process step and return the elapsed time
        \begin{itemize}
          \item Time in seconds
          \item Time include all the \texttt{number} iterations
          \item Suppose that you want to measure function \lstinline[language=python]{foo.bar(baz))} from module \texttt{foo} and which needs a parameter \texttt{baz}. Then, should import the module and create the parameter in the setup:
\begin{lstlisting}[language=python]
setup = """
import foo
baz = foo.Baz()
"""
timeit.timeit("foo.bar(baz)", setup=setup)
\end{lstlisting}
          \item If you want to use objects inside the same scope, pass the current globals
\begin{lstlisting}[language=python]
def foo(n): return list(range(n))
N = 200
timeit.timeit("foo(N)", globals=globals())
\end{lstlisting}
        \end{itemize}
      \item \lstinline[language=python]{timeit.repeat(<as above>, repeat=5)}: call \texttt{timeit} \texttt{repeat} times
        \begin{itemize}
          \item Return a list of length \texttt{repeat} with the result of each \texttt{timeit} call
          \item See this note from the developers: ``Its tempting to calculate mean and standard deviation from the result vector and report these. However, this is not very useful. In a typical case, the lowest value gives a lower bound for how fast your machine can run the given code snippet; higher values in the result vector are typically not caused by variability in Pythons speed, but by other processes interfering with your timing accuracy. So the min of the result is probably the only number you should be interested in. After that, you should look at the entire vector and apply common sense rather than statistics.''
        \end{itemize}
      \item It can be used as command-line tool: \lstinline[language=bash]{python3 -m timeit [OPT] [stmt]}
        \begin{itemize}
          \item \verb|-s|: setup
          \item \verb|-n|: number
          \item \verb|-r|: repeat
          \item \verb|-u|: unit
        \end{itemize}
      \item An idea (notice: it evaluates the statement and return what it gets):
\begin{lstlisting}[language=python]
REPEAT = 20
N_LOOPS = 10_000

def run_perf_analysis_eval(
    statement, label, repeat=REPEAT, n_loops=N_LOOPS
):
    measures = timeit.repeat(
        statement, repeat=repeat,
        number=n_loops, globals=globals(),
    )
    measures = np.array(measures) / n_loops
    print(
        f"* {label:15}: {np.mean(measures):>5.1f} mus"
        f" +- {np.std(measures):>6.2f} mus,"
        f" in [{np.min(measures):>5.1f},"
        f" {np.max(measures):>5.1f}]"
    )
    return eval(statement), measures
\end{lstlisting}
    \end{itemize}
  \item \href{https://docs.python.org/3/library/itertools.html}{\texttt{itertools}}: functions for creating iterators for efficient looping
    \begin{itemize}
      \item \verb|reduce(foo, iter)|: as \texttt{map} but will star elements of \texttt{iter} (that is \verb|*iter[0]|)
    \end{itemize}
  \item \href{https://docs.python.org/3/library/tkinter.html}{\texttt{tkinter}}: manage windows and dialogue
    \begin{itemize}
      \item \href{https://tkcalendar.readthedocs.io/en/stable/index.html}{Calendar}
    \end{itemize}
  \item Concurrency, Parallelization, Threading, Asynchronous programming: Couple of resources:
    \begin{itemize}
      \item An \href{https://www.machinelearningplus.com/python/parallel-processing-python/}{intro} with simple examples.
      \item Overviews of \href{https://realpython.com/python-concurrency/}{concurrency} and \href{https://realpython.com/async-io-python/}{asynchronous programming}
      \item \href{https://docs.python.org/3/library/multiprocessing.html}{\texttt{multiprocessing}} module.
        \begin{itemize}
          \item Get ID of pool workers: \href{https://stackoverflow.com/questions/10190981/get-a-unique-id-for-worker-in-python-multiprocessing-pool}{here}
          \item Use proxy-objects and \texttt{Manager}'s if you want objects to be modified inside the parallel functions (for instance if you want to append to lists,\ldots)
        \end{itemize}
      \item \href{https://docs.python.org/3/library/threading.html}{\texttt{threading}} module.
      \item \href{https://docs.python.org/3/library/asyncio.html}{\texttt{asyncio}} module.
    \end{itemize}
  \item \texttt{matplotlib}
    \begin{itemize}
      \item An example showing the basics
\begin{lstlisting}[language=python]
x  = np.linspace(0,1,20)
y1 = 2*x + 1
y2 = x**2
plt.plot(x, y1, marker="o", color = "red", linestyle='dashed')
plt.plot(x, y2, marker="*", color = "green") # Same plot
plt.legend([r"$y=2*x+1$", r"$y=x^2$"])
# or directly, then just called legend
plt.plot(x, y1, label=r"$y=2*x+1$")
plt.xlabel("X")
plt.ylabel("Y")
plt.title(r"Title with LaTeX $\alpha$")
plt.tight_layout()
plt.savefig("myfig.jpg", dpi=400) # dpi ~ quality
# or
plt.savefig("myfig.png", dpi=400, transparent=True)
# consider also...
plt.semilogx(...)
plt.semilogy(...)
plt.loglog(...)
\end{lstlisting}
      \item List of accepted key for \texttt{rcParams} \href{https://matplotlib.org/stable/api/matplotlib_configuration_api.html#matplotlib.rcParams}{here}
      \item \texttt{matplotlib.ion()} switch the interaction with the plot on, so that \texttt{plt.plot()} is not blocking and the plot can be kept and redrawn multiple times. This of course works in a plot environment, if you use it on a script the plot will disappear as soon as the script reaches its end.
      \item Equal unit-length for x and y-axis: \verb|plt.gca().set_aspect('equal', adjustable = 'box')|
      \item Remove axis (no axis, no ticks, no labels, etc): \verb|ax.axis('off')|
      \item Every names color \href{https://matplotlib.org/stable/gallery/color/named_colors.html}{here}
      \item 3D plots. A nice introduction can be found \href{https://jakevdp.github.io/PythonDataScienceHandbook/04.12-three-dimensional-plotting.html}{here}. To activate 3D-plotting (scatter, surface, mesh plot or any other) the axis should be called with \lstinline[language=python]{projection='3d'} which should be imported as follows: \lstinline[language=python]{from mpl_toolkits import mplot3d}
      \item Interactive plots: \href{https://matplotlib.org/stable/gallery/event_handling/legend_picking.html}{legend picking}, \href{https://matplotlib.org/stable/gallery/event_handling/cursor_demo.html}{grids moving with the mouse}, in general, checkout the whole \href{https://matplotlib.org/stable/gallery/event_handling/index.html}{event handling} session
    \end{itemize}
  \item Argument parsing: \href{https://docs.python.org/3/library/argparse.html#module-argparse}{\texttt{argparse}}
  \item Working with datasets:
    \begin{itemize}
      \item \href{https://pandas.pydata.org/docs/user_guide/10min.html}{\texttt{pandas}}
      \item \href{http://xarray.pydata.org/en/stable/user-guide/index.html}{\texttt{xarray}}
    \end{itemize}
  \item \texttt{pandas}
    \begin{itemize}
      \item Access data: \verb|df.loc[row,col]| works with labels. Slices, arrays, booleans are accepted. \verb|df.at[row,col]|, same but can access a scalar value only (no slices), hence its faster. There are also equivalent version that works with index: \verb|df.iloc[]|, \verb|df.iat[]|. See \href{https://stackoverflow.com/questions/28754603/indexing-pandas-data-frames-integer-rows-named-columns}{here} for hybrid access.
        \begin{itemize}
          \item Pay attention to whether the function returns a view or a copy, see \href{https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#indexing-view-versus-copy}{here}
        \end{itemize}
      \item Build dataframe from dict of dict: just pass it to default constructor, or use \verb|from_dictionary|, see \href{https://stackoverflow.com/questions/33157522/create-pandas-dataframe-from-dictionary-of-dictionaries}{here}
    \end{itemize}
  \item Progress bar: \href{https://github.com/tqdm/tqdm#manual}{\texttt{tqdm}}
    \begin{itemize}
      \item \href{https://www.analyticsvidhya.com/blog/2021/05/how-to-use-progress-bars-in-python/}{here} is a nice show of what is capable
      \item Standard usage: \verb|for i in tqdm.tqdm(range(6))|, \verb|for l in tqdm.tqdm(my_list)|
      \item Manual usage, with \texttt{with}: \verb|with tqdm.tqdm(...) as bar: [iterate] bar.update()|. In this case you have to update manually
      \item It could deal with parallel code, it uses a wrapper to \texttt{multiprocessing}, have a look \href{https://tqdm.github.io/docs/contrib.concurrent/}{here}
    \end{itemize}
  \item Statistics and data analysis:
    \begin{itemize}
      \item \texttt{scipy.stats}: hypothesis testing and all the basics.
      \item \texttt{statsmodels}: regressions.
      \item \href{https://seaborn.pydata.org/introduction.html}{\texttt{seaborn}}: powerful data visualization tool.
    \end{itemize}
  \item \texttt{re}: \href{https://docs.python.org/3/library/re.html}{regex'ing}
    \begin{itemize}
      \item Main functions:
        \begin{itemize}
          \item \verb|re.search(pattern, string)|: Search \emph{anywhere} in the string.
          \item \verb|re.match(pattern, string)|: Search at the \emph{beginning} of the string.
          \item \verb|re.fullmatch(pattern, string)|: The \emph{whole} string should math the pattern.
          \item \verb|re.sub(pattern, repl, string)|: Replace the pattern with the alternative text.
          \item The functions take a key argument for flags. E.g.:
\begin{lstlisting}[language=python]
# Case-insensitive
re.search(ptrn, string, flag=re.I)
# Multi-line
re.search(ptrn, string, flag=re.M)
\end{lstlisting}
        \end{itemize}
      \item One can compile a regex in advance, then use the usual functions:
\begin{lstlisting}[language=python]
foo_re = re.compile("foo")
foo_re.search("Foo foo bar")
\end{lstlisting}
      \item \verb|re.escape(pattern)|: escape all the ambiguous characters
\begin{lstlisting}[language=python]
foo_re = re.compile(re.escape("/foo.bar"))
\end{lstlisting}
      \item Matches\&Groups: The above-mentioned function return a \emph{match} object
        \begin{itemize}
          \item Access full match and groups with brackets
\begin{lstlisting}[language=python]
m = re.match(r"(\w+) (\w+)", "Isaac Newton, physicist")
m[0]  # The entire match
# 'Isaac Newton'
m[1]  # The first parenthesized subgroup.
\end{lstlisting}
          \item Access groups with group ad-hoc function:
\begin{lstlisting}[language=python]
m.group(0)  # The entire match
# 'Isaac Newton'
m.group(1)  # The first parenthesized subgroup.
# 'Isaac'
m.group(1, 2)  # Multiple arguments give us a tuple.
# ('Isaac', 'Newton')
\end{lstlisting}
          \item Access groups with names: one should use a special constructor \texttt{(?P<foo>pattern)}.
\begin{lstlisting}[language=python]
m = re.match(
  r"(?P<name>\w+) (?P<surname>\w+)",
  "Isaac Newton, physicist",
)
m.group("name")
# 'Isaac'
m.group("surname")
# 'Newton'
\end{lstlisting}
          \item All the groups as tuple: \verb|m.groups(default=None)| (default value is for groups that did not participate to the match).
          \item All the groups as dict: \verb|m.groupdict(default=None)|, to use in case where one gave name to a group (see \texttt{name} and \texttt{surname} above).
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsection{Data structures}
Let us discuss the native data structures. The \href{https://docs.python.org/3/library/stdtypes.html}{manual} of all the predefined types.
\subsubsection{General intro}
The most common types (and how to create them) are:
\begin{itemize}
  \item Dictionaries: \verb|d = {'key':item}|
  \item Lists: \verb|l = [1, 2]|
  \item Tuples: \verb|t = (1, 2)|. ATTENTION: tuples are similar to lists, however they are immutable, for instance, you won't be able to do: \verb|t[0] = 2|
  \item Sets: \verb|s = {1, 2}|. Unordered, unique elements.
    \begin{itemize}
      \item Frozen sets: \verb|f = frozenset{[1, 2]}|. As sets, but immutable.
    \end{itemize}
\end{itemize}

\subsubsection{Access and indexing}
\begin{itemize}
  \item Operator square brackets, 0-based, separate dimensions with commas ``\texttt{,}''
  \item Negative indices means starting from the end, hence \texttt{a[-1]} is the last element
  \item \verb|a[start:end:range]|: \verb|a[i:j:n]| gives every \texttt{n}-th elements starting from \texttt{i} to \texttt{j}. If \texttt{i} (resp.\ \texttt{j}) is omitted, defaults to first, \texttt{0}, (resp.\ last, \texttt{-1}) element. E.g.: \verb|a[::2]| yields every other element.
  \item \verb|a[start:end]|: \verb|a[i:j]|: elements from \texttt{i} to \texttt{j}. If \texttt{i} (resp.\ \texttt{j}) is omitted, defaults to first, \texttt{0}, (resp.\ last, \texttt{-1}) element
  \item If \texttt{n} is negative, then \texttt{i} should be greater then \texttt{j} and the order is reversed. Some examples:
    \begin{itemize}
      \item \verb|a[::-1]| list in reversed order
      \item \verb|a[-1:-5:-1]| last five elements in reversed order
      \item \verb|a[10:0:-2]| (equivalent to \verb|a[10::-2]|, notice \texttt{0} omitted): from tenth to first element
    \end{itemize}
  \item ``\verb|:|'': everything. \verb|a[:,n]|: the \texttt{n}-th column
  \item Use objects \texttt{slice} to build indexing instances:
    \begin{itemize}
      \item \texttt{slice(N)}: from beginning to \texttt{N}, equivalent to ``\texttt{:N}''
      \item \texttt{slice(N, M)}: from \texttt{N} to \texttt{M}, equivalent to ``\texttt{N:M}''
        \begin{itemize}
          \item \texttt{slice(None, M)}: equivalent to \texttt{slice(M)}
          \item \texttt{slice(N, None)}: equivalent to ``\texttt{N:}''
        \end{itemize}
      \item \texttt{slice(N,M,q)}: from \texttt{N} to \texttt{M} but only every \texttt{q} elements, equivalent to ``\texttt{N:M:q}''
        \begin{itemize}
          \item Usage of \texttt{None} instead of \texttt{N} and/or \texttt{M} leads to the same behaviour as the item above
        \end{itemize}
    \end{itemize}
\end{itemize}

Dictionaries are different since they work with a hash table and on can access the elements with the related key.

\subsubsection{Lists}
Lists, let \verb|l| be a list of natural integers for the sake of simplicity (notation: \verb|i| stands for index, \verb|n| for natural integer)
\begin{itemize}
  \item Insertion, elimination: \verb|l.append(n)|, \verb|l.insert(i,n)| \verb|l.remove(n)|, \verb|l.pop(i)| (remove \texttt{i}-th element, default 0). Methods \texttt{append} and \texttt{remove} return \texttt{None}.
  \item It accepts \verb|l.max()|
    \begin{itemize}
      \item Argmax:
\begin{verbatim}
index_max = max(range(len(l)), key = l.__getitem__)
# or
from operator import itemgetter
index_max = max(range(len(l)), key = itemgetter)
\end{verbatim}
    \end{itemize}
  \item Loop both on indices and values: \verb|for i, v in enumerate(l):|
  \item Initialize (list comprehension): \verb|l = [0 for _ in range(3)]|
  \item Search for: \verb|l.index(n)|
  \item Reverse: \verb|l.reverse()| in-place, \verb|l[::-1]|
  \item Sorting: \verb|l.sort()| in-place, \verb|sorted(l)| returns a new list
    \begin{itemize}
      \item Argsort:
\begin{verbatim}
l = sorted(range(len(l)), key = l.__getitem__)
# or
from operator import itemgetter
l = sorted(range(len(l)), key = itemgetter)
\end{verbatim}
    \end{itemize}
  \item List comprehension: \href{https://www.programiz.com/python-programming/list-comprehension}{here}.
\end{itemize}

\subsubsection{Dictionaries}
Have a look \href{https://realpython.com/python-dicts/}{here}
\begin{itemize}
  \item In recent versions, they are ordered
  \item Create: empty \verb|d = {}| or \verb|d = dict()|; not empty \verb|d={key:value}| or \verb|dict()| plus list of tuples. \verb|key| has to be hashable and \verb|value| can be of any type.
  \item Add new item or update existing:
    \begin{itemize}
      \item \verb|d[key] = value|
      \item \verb|d.update(<>)|: accepts either another dictionary object or an iterable of key/value pairs (as tuples or other iterables of length two). If keyword arguments are specified, the dictionary is then updated with those key/value pairs: \verb|d.update(red=1, blue=2)|
    \end{itemize}
  \item Access: by key \verb|d[k]=val|; by index \verb|d[2]=val|; \verb|d.get(<key>[, <default>])| returns the value if \texttt{k} is a key (otherwise, \texttt{default})
  \item \verb|d.items()|: returns a list of key-value pairs
  \item \verb|d.keys()|: returns a list of keys
  \item \verb|d.values()|: returns a list of values
  \item \verb|d.pop(k,[default])|: If \texttt{k} is in the dictionary, removes it and return its value, else return \texttt{default}
  \item \verb|d.clear()|: remove everything
  \item \verb|for k in d| loops over keys
\end{itemize}

\subsubsection{Sets}
Operation and stuff (see \href{https://realpython.com/python-sets/}{here})
\begin{itemize}
  \item Union (any element): \verb!s1 | s2! or better \verb|s1.union(s2)|
  \item Intersection (elements in both): \verb|s1 & s2| or \verb|s1.intersection(s2)|
  \item Difference (elements in \verb|s1| only): \verb|s1 - s2| or \verb|s1.difference(s2)|
  \item Symmetric difference (not in intersection): \verb|s1 ^ s2| or \verb|s1.symmetric_difference(s2)|
  \item And many others: \verb|s1.isdisjoint(s2)|, \verb|s1.issubset(s2)| or \verb|s1 <= s2| or \verb|s1 < s2| for proper subset\ldots
\end{itemize}

\subsubsection{Tuples}%
\begin{itemize}
  \item Tuples are immutable
  \item Addition extends tuples
\begin{verbatim}
(1, 0) + (0,-1) # Gives (1, 0, 0, -1)
\end{verbatim}
  \item Tuples have support for comparisons and it works element-wise. Hence, a ``\texttt{t1} greater than \texttt{t2}'' (for two-elements tuples) works roughly as follows:
\begin{verbatim}
def tuple_gt(t1, t2):
  if t1[0] > t2[0]:
    return True
  elif t1[0] < t2[0]:
    return False
  else:
    # Here t1[0] = t2[0]
    return t1[1] > t2[1]
\end{verbatim}
\end{itemize}

\subsection{\texttt{argparse}}
Have a look at the official \href{https://docs.python.org/3/library/argparse.html}{documentation} and \href{https://docs.python.org/3/howto/argparse.html}{tutorial}. Otherwise, below a very basic example:
\begin{lstlisting}[language=python]
import argparse

# CREATING A PARSER
parser = argparse.ArgumentParser(
  # Optional
  prog="ProgName",
  usage="Describe the usage",
  desciption="Description of the program",
  epilog="Test displayed after argument help",
)

# ADD ARGUMENTS
# Help option added by default
# Positional argument
parser.add_argument(
  "FOO",  # Name
  help="A nice little foo",  # Description of option
)
# Flag argument (mind the name starts with -)
# Commonly used for optional argument
parser.add_argument(
  "-t", "-T",  # short name
  "--test", "--Test",  # Full name
  dest="myTest",  # Name of the member in which the value will be stored
  help="Activate test mode",  # Description of option
)

# PARSING ARGUMENTS
args = parser.parse_args()
# or
import sys
args = parser.parse_args(sys.argv[1:])
# Actually, any sequence of strings
args = parser.parse_args(["--test"])

# USING STORED ARGUMENTS
print(args.myTest)
\end{lstlisting}

\medskip
\href{https://docs.python.org/3/library/argparse.html#quick-links-for-add-argument}{Options for \texttt{add\_argument}} (they are all optional):
\begin{itemize}
  \item \texttt{dest}: Specify the attribute name used in the result namespace. It can be the same for more than one argument.
  \item \texttt{help}: Help message for an argument.
  \item \texttt{required}: Indicate whether an argument is required or optional.
  \item \texttt{nargs}: Number of times the argument can be used. Valid options:
    \begin{itemize}
      \item \texttt{N} (an integer): \texttt{N} options will be consumed and gathered into a list.
      \item \texttt{"?"}: One argument will be consumed from the command line if possible, and produced as a single item. If no command-line argument is present, the value from default will be produced.
      \item \texttt{"*"}: All command-line arguments present are gathered into a list.
      \item \texttt{"+"}: As \texttt{"*"}, but raises an error if no argument is found.
    \end{itemize}
  \item \texttt{default}: Default value used when an argument is not provided (default is \texttt{None}).
  \item \texttt{const}: Store a constant value.
    \begin{itemize}
      \item It is required by some \texttt{nargs} and \texttt{action}.
      \item When \texttt{nargs="?"}, it's the value that will taken when the argument is passed but without a value.
    \end{itemize}
  \item \texttt{choices}: Limit values to a specific set of choices. E.g.: \verb|["one", "un", "uno"]|.
  \item \texttt{type}: Automatically convert an argument to the given type. Valid options:
    \begin{itemize}
      \item Standard types, e.g., \texttt{int}, \texttt{float},\ldots
      \item A callable function that returns a value or raises \verb|argparse.ArgumentTypeError| if argument is not valid.
      \item A \verb|argparse.FileType| object (for file IO).
    \end{itemize}
  \item \texttt{action}: Specify how an argument should be handled: Valid options:
    \begin{itemize}
      \item \verb|"store"|: Store the argument's value (the default).
      \item \verb|"store_const"|: Store the argument specified by \texttt{const} keyword; commonly used with optional arguments that specify some sort of flag.
      \item \verb|"store_true"| and \verb|"store_false"|: These are special cases of \verb|store_const| used for storing the values \texttt{True} and \texttt{False} respectively
      \item \verb|"append"|: This stores a list, and appends each argument value to the list. It is useful to allow an option to be specified multiple times.
      \item \verb|"append_const"|: This stores a list, and appends the value specified by the \texttt{const} keyword argument to the list.
      \item \verb|"count"|: This counts the number of times a keyword argument occurs.
      \item \verb|"help"|: This prints a complete help message for all the options in the current parser and then exits.
      \item \verb|"version"|: This expects a \verb|version=| keyword argument in the \verb|add_argument| call, and prints version information and exits when invoked.
      \item \verb|"extend"|: This stores a list, and extends each argument value to the list.
    \end{itemize}
  \item \texttt{metavar}: Alternate display name for the argument as shown in help
\end{itemize}

Tircks\&Tips:
\begin{itemize}
  \item Mutually exclusive arguments: create a related group
\begin{lstlisting}[language=python]
parser = argparse.ArgumentParser()
mutEx = parser.add_mutually_exclusive_group()
mutEx.add_argument("--foo")
mutEx.add_argument("--bar")
\end{lstlisting}
  \item Sub-parsers:
\begin{lstlisting}[language=python]
# create the top-level parser
parser = argparse.ArgumentParser(prog='PROG')
parser.add_argument('--foo', action='store_true', help='foo help')
subparsers = parser.add_subparsers(help='sub-command help')

# create the parser for the "a" command
parser_a = subparsers.add_parser('a', help='a help')
parser_a.add_argument('bar', type=int, help='bar help')

# create the parser for the "b" command
parser_b = subparsers.add_parser('b', help='b help')
parser_b.add_argument('--baz', choices='XYZ', help='baz help')
\end{lstlisting}
  \item Parse only known arguments
\begin{lstlisting}[language=python]
parser = argparse.ArgumentParser()
parser.add_argument('--foo', action='store_true')
parser.add_argument('bar')
parser.parse_known_args(['--foo', '--badger', 'BAR', 'spam'])
# Gives (Namespace(bar='BAR', foo=True), ['--badger', 'spam'])
\end{lstlisting}
  \item \texttt{default} vs.\ \texttt{const}: Consider the following 3 examples (mind the presence or absence of \texttt{default} and \texttt{const} in the parser definition)

    \begin{minipage}[T]{.45\textwidth}
      \begin{lstlisting}[language=python,frame=single]
p = argparse.ArgumentParser()
p.add_argument(
    "-f",
    dest="f"
    nargs="?",
    default=4,
)
# Not passed
a = p.parse_args([])
print(a.f) # 4 (default)
# Passed but no value
a = p.parse_args(["-f"])
print(a.f) # None (const)
a = p.parse_args(["-f", "12"])
print(a.f) # 12
      \end{lstlisting}
    \end{minipage}\hfill%
    \begin{minipage}[T]{.45\textwidth}
      \begin{lstlisting}[language=python, frame=single]
p = argparse.ArgumentParser()
p.add_argument(
    "-f",
    dest="f"
    nargs="?",
    const=8,
)
# Not passed
a = p.parse_args([])
print(a.f) # None (default)
# Passed but no value
a = p.parse_args(["-f"]
print(a.f) # 8 (const)
a = p.parse_args(["-f", "12"])
print(a.f) # 12
      \end{lstlisting}
    \end{minipage}

    \begin{center}
    \begin{minipage}[T]{.45\textwidth}
        \begin{lstlisting}[language=python,frame=single]
p = argparse.ArgumentParser()
p.add_argument(
    "-f",
    dest="f"
    nargs="?",
    default=4,
    const=8,
)
# Not passed
a = p.parse_args([])
print(a.f) # 4 (default)
# Passed but no value
a = p.parse_args(["-f"])
print(a.f) # 8 (const)
a = p.parse_args(["-f", "12"])
print(a.f) # 12
        \end{lstlisting}
      \end{minipage}
    \end{center}

  \item More than one argument with the same destination:
\begin{lstlisting}[language=python]
p = argparse.ArgumentParser()
p.add_argument("-t", dest="boolean", action="store_true")
p.add_argument("-f", dest="boolean", action="store_false")
a = p.parse_args(["-t"])
print(a.boolean) # True
a = p.parse_args(["-f"])
print(a.boolean) # False
a = p.parse_args(["-f", "-t"])
print(a.boolean) # True (last one prevails)
\end{lstlisting}
\end{itemize}

\subsection{\texttt{pathlib}}
\href{https://docs.python.org/3/library/pathlib.html}{\texttt{pathlib}} and \texttt{Path}: filesystem paths. Similarities and differences w.r.t.\ \texttt{os} module \href{https://docs.python.org/3/library/pathlib.html#correspondence-to-tools-in-the-os-module}{here}. Examples below
\begin{lstlisting}[language=python]
from pathlib import Path
Path()  # .
p = Path("path")
# Operator / overloaded
foo = p / "to" / "foo.py"  # path/to/foo.py
# Some functions
Path.cwd(), Path.home()
foo.exists(), foo.is_dir(), foo.is_file(), foo.is_symlink()
# Properties
foo.parts  # ("path", "to", "foo.py")
foo.name  # foo.py
foo.suffix  # .py
tgz = Path("t.tar.gz")
tgz.suffix  # ".gz"
tgz.suffixes  # [".tar", ".gz"]
foo.stem  # foo final component without suffix
foo.match("*.py")
foo.relative_to(other)
foo.with_suffix(".txt")  # path/to/foo.txt
foo.open()
foo.rename("new.py"), foo.replace("new.py")
# Similarly with_stem(), with_name()
drc = Path("a/directory")
drc.glob("*.py")
for child in drc.iterdir(): pass
# Path as string
str(foo), f"{foo}"
# Consider this file tree
# dir
#   |_ foo
#   |    |_ toto
#   |    |_ bar.py
#   |_ __pycache__
#   |    |_ ...
#   |_ baz.txt
for root, dirs, files in Path("dir").walk():
    print(f"Dir {root} contains",
          f"sub-dirs {dirs},",
          f"files {files}")
    if "__pycache__" in dirs:
        dirs.remove("__pycache__")
# Dir "dir" contains sub-dirs ["foo"] and files ["baz.txt"]
# Dir "dir/foo" contains sub-dirs ["toto"] and files ["bar.py"]
# Dir "dir/foo/toto" contains sub-dirs [] and files []
\end{lstlisting}

\subsection{Files\&Co}
Open'n'Close
\begin{itemize}
  \item Open: \verb|f = open('path/to/file.txt', 'w')|
    \begin{itemize}
      \item The second argument is the mode. For instance, \verb|w| for writing (creates file if it doesn't exist), \verb|a| for appending (creates file if it doesn't exist), \verb|r| for reading (error if file doesn't exist), \verb|x| for creating a file (error if file already exists), \verb|t| for using text mode (default) or \verb|b| for using binary mode. For instance, for reading in binary use \verb|'rt'|
    \end{itemize}
  \item Close \verb|f.close()|
  \item Use the \verb|with| construction which closes the file by itself
\begin{verbatim}
with open('path/to/file.txt', 'w') as f:
  # [do stuff]
\end{verbatim}
\end{itemize}

Reading
\begin{itemize}
  \item Read one line and store it: \verb|line = f.readline()|
  \item Read \emph{all} the lines and store them in a list: \verb|lines = f.readlines()|
  \item Read the content and store it in a string: \verb|cont = f.read()|
    \begin{itemize}
      \item Pass a number to specify how many characters to read: \verb|c = f.read(5)|
    \end{itemize}
  \item Conveniently loop line by line: \verb|for line in f:| (also \verb|enumerate|, for instance)
\end{itemize}

Writing
\begin{itemize}
  \item Write a string: \verb|f.write(s)|
  \item Write a list of strings: \verb|f.writlines(l)|
    \begin{itemize}
      \item It does NOT automatically add the newline after each string
    \end{itemize}
\end{itemize}

\subsection{Working with \texttt{jupyter} notebooks}
\begin{itemize}
  \item \texttt{jupyter-lab}: advanced browser-based (it uses a browser, but no need to be online) environment for editing and running notebooks
  \item Plots and semi-prints (I mean what you get when in a \texttt{python} interface you run "\texttt{a}", \texttt{a} being a variable, and not "\texttt{print(a)}") overwrite. To make them stay, use \verb|plt.show()| for plots or simply \verb|print()| for other stuff
  \item \texttt{jupyter} magic:
    \begin{itemize}
      \item \href{https://ipython.readthedocs.io/en/stable/interactive/reference.html#magic}{Some info}
      \item Complete built-in \href{https://ipython.readthedocs.io/en/stable/interactive/magics.html}{list}
      \item \href{https://nbviewer.org/github/ipython/ipython/blob/1.x/examples/notebooks/Cell%20Magics.ipynb}{Online example}
      \item \verb|[%]%timeit|: compute performances
        \begin{itemize}
          \item Starts the cell with \verb|%%timeit| to run the performance analysis on the whole cell
          \item \verb|%timeit|: same as above, but inline, hence only for the current line
          \item Option \verb|-r <N>|: repeat \verb|N| times
          \item Option \verb|-o|: capture output. E.g., \verb|res = %timeit -o -r 5 foo()|
            \begin{itemize}
              \item Access data: \verb|res.average|, \verb|res.stdev|, \ldots
              \item If in whole-cell mode (i.e., \verb|%%timeit|), results are stored in underscore operator, ``\verb|_|''
            \end{itemize}
        \end{itemize}
      \item \verb|%%matplotlib|: Interactive support with \texttt{matplotlib}
        \begin{itemize}
          \item Intro \href{https://matplotlib.org/stable/users/explain/figure/interactive.html#ipython-integration}{here}
          \item Add \verb|%%matplotlib widget| at the beginning of the selected code-cell
          \item Needs dependency \texttt{ipympl}
        \end{itemize}
    \end{itemize}
  \item Download images:
    \begin{itemize}
      \item "(Shift + ) Right click > Save image as..." easy-peasy.
      \item Download images in batch: \href{https://github.com/damienmarlier51/JupyterNotebookImageExporter}{\texttt{junix}}
      \item Here the gist (used by the \texttt{junix} above): images are stored as ASCII strings in base64. Recover the data-string associated with an image: open the \texttt{ipynb} with a simple editor, there you will find a structure composed of dictionaries and lists, find the items associated to the image, they are inside a \texttt{data} cell and their key is \texttt{image/<type>} with \texttt{type} being \texttt{png}, for instance. Mind to remove \verb|\n| at the end if present. Use base64 utilities to convert the string into image: you can use \texttt{base64} \texttt{bash} command with option \verb|-d| (see \href{https://askubuntu.com/questions/907540/how-to-decode-an-image-string-using-base64-in-command-line}{here}) or \texttt{python} \verb|base64.b64decode|
    \end{itemize}
  \item Use \LaTeX{} commands, see \href{https://stackoverflow.com/questions/13208286/how-to-write-latex-in-ipython-notebook}{here} or, even better, \href{https://jupyterbook.org/content/math.html}{here}
  \item Sub-command \href{https://nbconvert.readthedocs.io/en/latest/usage.html}{\texttt{jupyter nbconvert}}: it enables one to convert notebooks in several format directly from command line. Options:
    \begin{itemize}
      \item \verb|--to <fmt>|: choose the output format. Available: pdf, latex, markdown, python, asciidoc, html, notebook (see executing below),\ldots
      \item \verb|--output <ouname>|: basename for output
      \item \verb|--no-input|: do not render code-cells (but do render their output)
      \item \verb|--execute|: execute the notebook before converting it
        \begin{itemize}
          \item It format notebook is chosen, then a new one is generated with the results with the following name \texttt{basename.nbconvert.ipynb}
          \item \verb|--inplace|: Save in-place instead of into a new file
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsection{Writing documentation}
We give here some tips about writing documentation for your \texttt{python} code using \href{https://www.sphinx-doc.org/en/master/index.html}{\texttt{sphinx}}, basic ideas are \href{https://docs.python-guide.org/writing/documentation/}{here}. The main features of \texttt{sphinx} are that it provides building procedures, it is highly customizable, it uses reStructured Text (a markup language similar to \texttt{markdown}, \autoref{sec:markdown}) and can automatically process the docstrings.

First of all, here some info about docstrings, defined \href{https://www.python.org/dev/peps/pep-0257/}{here}. They are the comment-like lines just after function / class declarations, included in triple single- or double-quotes (\verb|'''| or \verb|"""|), that are read by python when invoking \texttt{help( )} or \texttt{doc( )}, \href{https://www.geeksforgeeks.org/python-docstrings/}{here} is basic stuff, also \href{https://www.programiz.com/python-programming/docstrings}{here}.

There are docstrings conventions that can be read and processed by \texttt{sphinx} so that it can generate automatically the documentation. The two most well-known and used are \href{https://www.programiz.com/python-programming/docstrings}{Google style} (example \href{https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html}{here}), and the \href{https://numpydoc.readthedocs.io/en/latest/format.html}{NumPy style} (example \href{https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_numpy.html#example-numpy}{here}, mind that this format needs an additional extension of \texttt{sphinx}, we'll come back on this later). In short, choose one of the styles, used it coherently, so that you may create your doc in no times. In order for the docstrings to be understood by \texttt{sphinx}, you may use \texttt{sphinx} directive, like \href{https://sphinx-rtd-tutorial.readthedocs.io/en/latest/docstrings.html#an-example-class-with-docstrings}{this}, but the docstrings are a little less readable.

Now comes the real part about using \texttt{sphinx}. I am no wiz, I just figured out a couple of tricks by trial'n'error. Before getting into the detail myself, let me just give some web posts which (somehow) details the procedure: \href{https://betterprogramming.pub/auto-documenting-a-python-project-using-sphinx-8878f9ddc6e9}{here}, \href{https://samnicholls.net/2016/06/15/how-to-sphinx-readthedocs/}{here}, \href{https://eikonomega.medium.com/getting-started-with-sphinx-autodoc-part-1-2cebbbca5365}{here} (keep this for \texttt{automodule} / \texttt{autodoc}), \href{https://medium.com/@richdayandnight/a-simple-tutorial-on-how-to-document-your-python-project-using-sphinx-and-rinohtype-177c22a15b5b}{here}.
\begin{enumerate}
  \item Install \texttt{sphinx} if you don't have it with \texttt{pip install Sphinx}. It is advised to use virtual environments.
  \item \texttt{sphinx} uses a configuration file \texttt{conf.py}. The default configuration may be set up by running \texttt{sphinx-quickstart} and answering its question. You may want to activate the \texttt{autodoc} (automatically generates from docstrings), \texttt{intersphinx} (generates links within documentations), \texttt{coverage} (checks if you forgot to document something), \texttt{viewcode} (provides links to the code), and possibly even \texttt{doctest} (runs some examples found in the docstrings) extensions. The \texttt{Makefile} is quite useful, too. Now, you have set your doc up.
  \item You should say to \texttt{sphinx} where your scripts are. Open \texttt{conf.py} and uncomment the first imports (\texttt{os} and \texttt{sys}) and the path insertion: default is current directory, adjust with the path which is right for you.
  \item In the \texttt{conf.py}, you may also change a number of settings and extensions:
    \begin{itemize}
      \item Theme: default is ``alabaster''. See \href{https://sphinx-themes.org/}{here} for a gallery. Among the most used ones, is the ReadTheDocs theme: \verb|sphinx_rtd_theme|
      \item Extensions: the above mentioned \texttt{autodoc}, \texttt{intersphix},\ldots are already loaded if you asked for them in the quickstart. If using the NumPy style, you should activate also the Napoleon extension, hence add \texttt{sphinx.ext.napoleon} to the list.
      \item And a lot of more stuff
    \end{itemize}
  \item If you want \texttt{sphinx} to automatically generate the doc from your docstrings, you should tell it in the \texttt{index.rst} file as explained in item 8 \href{https://medium.com/@richdayandnight/a-simple-tutorial-on-how-to-document-your-python-project-using-sphinx-and-rinohtype-177c22a15b5b}{here} or \href{https://eikonomega.medium.com/getting-started-with-sphinx-autodoc-part-1-2cebbbca5365}{here}.
    \begin{itemize}
      \item This enables \texttt{sphinx} to do it all by itself, otherwise, you can also do it yourself using the utility \texttt{sphinx-apidoc} as mentioned \href{https://samnicholls.net/2016/06/15/how-to-sphinx-readthedocs/}{here}.
    \end{itemize}
  \item Now, if you asked for the \texttt{Makefile}, you just need to run \verb|make html| (or \texttt{latexpdf}, or anything that pleases you) and your doc is generated in the \verb|[]_build| directory.
  \item That's it.
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{markdown}}
\label{sec:markdown}
\begin{itemize}
  \item \texttt{markdown} files are usually used for \texttt{README} and such.
  \item Common extension: \texttt{.md}, \texttt{.markdown}
  \item Compile them with \texttt{pandoc} in order to get an \texttt{html} or a \texttt{pdf}, for instance, that you can open with a browser.
\begin{verbatim}
pandoc --from=markdown --to=html -o out.html in.md
\end{verbatim}
  \item Guides, cheat-sheets and tutorials:
    \href{https://daringfireball.net/projects/markdown/syntax}{official \texttt{markdown}},
    \href{https://docs.github.com/en/github/writing-on-github/basic-writing-and-formatting-syntax}{\texttt{GitHub}-flavoured},
    \href{https://docs.gitlab.com/ee/user/markdown.html}{\texttt{GitLab}-flavoured},
    \href{https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet}{\texttt{GitHub} cheat-sheet},
    quick \href{https://commonmark.org/help/}{cheat-sheet} and a
    \href{https://agea.github.io/tutorial.md/}{tutorial} and
    \href{https://enterprise.github.com/downloads/en/markdown-cheatsheet.pdf}{cheat sheet again}.
  \item Special text: \textit{italic} \verb|*italic*| or \verb|_italic_|; \textbf{bold} \verb|**bold**| or \verb|__italic__|; code / \texttt{typewriter} \verb|`typewriter`| (backticks); \sout{strikethrough} \verb|~strikethrough~| or \verb|~~strikethrough~~|
  \item Links: e.g.\ \verb|[Shown label](https://link.to)|
    \begin{itemize}
      \item One can even link sections of the current file (notice: all lowercase letters, blanks converted into dashes):
\begin{verbatim}
# Section One
Here is a section.
# Section Two
Here is a [link](#section-one) to the previous section.
\end{verbatim}
    \end{itemize}
  \item Images: similar to links, prepend a ``!'': \verb|![Alternative description text](path/to/img.png)|
    \begin{itemize}
      \item The image is rendered \textbf{inline}
      \item Without the ``!'', it will be a link
      \item URLs are accepted as valid path, especially in READMEs for online repositories.
      \item See \href{https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax#images}{this section} of the GitHub documentation for notions about relative paths
      \item Centering images: \texttt{markdown} does not support it and one should switch to \texttt{html} syntax. Mind that not all \texttt{markdown} interpreters can deal with \texttt{html}, however, rest assure, GitHub and GitLab can. See \href{https://stackoverflow.com/questions/12090472/how-do-i-center-an-image-in-the-readme-md-file-on-github}{here}
\begin{verbatim}
<div align="center">
<img src="path/to/img.png" alt="Alternative description text"/>
</div>
\end{verbatim}
        Sometimes using \verb|<p align="center"> ... </p>| works as well
    \end{itemize}
  \item Render code: main idea use backticks, ``\texttt{`}''
    \begin{itemize}
      \item \href{https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax#quoting-code}{GitHub docs}
        (for more \href{https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/creating-and-highlighting-code-blocks}{advanced settings})
      \item Display: three backticks with, optionally, the language of the code to highlight syntax as well. E.g., python and terminal (see \href{https://stackoverflow.com/a/49004070/12152457}{here}) examples:
\begin{verbatim}
```python
for i in range(5):
    if i % 2 == 0:
        print("Even")
    else:
        pass
```

```console
foo@bar:~$ whoami
foo
```
\end{verbatim}
        \begin{itemize}
          \item \href{https://github.com/github-linguist/linguist/blob/3c3b037910006fc2f1a9bb34b2c4e9cde062206c/lib/linguist/languages.yml}{Official list} of languages supported by GitHub and their definitions. For a non-official but user-friendly (and possible incomplete) list, see \href{https://github.com/jincheng9/markdown_supported_languages?tab=readme-ov-file#heres-a-full-list-of-supported-languages}{here}
        \end{itemize}
      \item Inline: one backtick \verb|`code goes here`|
        \begin{itemize}
          \item Syntax highlighting is not available for inline code with default renderers. However, some extensions can, see this \href{https://stackoverflow.com/questions/23226224/inline-code-syntax-highlighting-in-github-markdown}{SO question}: \verb|`a = None`{:.python}| or \verb|`a = None`{.python}|
        \end{itemize}
    \end{itemize}
  \item Citations, references, bibliography: similar to links, see \href{https://stackoverflow.com/questions/26587527/cite-a-paper-using-github-markdown-syntax}{here}.
    \begin{itemize}
      \item Reference sections
\begin{verbatim}
# A section
...
[Link to the section](#a-section)
\end{verbatim}
      \item Reference a point: create an anchor with \texttt{html}, \verb|<a name="ref"></a>| then reference it. See \href{https://stackoverflow.com/a/7335259/12152457}{here}
      \item Reference a enumeration item: that's not that straight-forward and take advantage of \texttt{html} syntax, have a look \href{https://stackoverflow.com/a/37148268/12152457}{here}
    \end{itemize}
  \item Math\&Equations:
    \begin{itemize}
      \item \texttt{GitLab}:
        \begin{itemize}
          \item Inline: dollar+backticks, e.g., \verb|$`\alpha`$|
          \item Display: double dollar, e.g., \verb|$$ \alpha $$| or code-block
\begin{verbatim}
```math
\alpha
```
\end{verbatim}
        \end{itemize}
      \item \texttt{GitHub}
        \begin{itemize}
          \item \href{https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/writing-mathematical-expressions}{Official docs}
          \item Inline: dollar, e.g., \verb|$\alpha$|
          \item Display: double dollar, e.g., \verb|$$ \alpha $$| or code-block
\begin{verbatim}
```math
\alpha
```
\end{verbatim}
          \item {[Deprecated workaround]} However, there seems to be some workarounds, see \href{https://stackoverflow.com/questions/11256433/how-to-show-math-equations-in-general-githubs-markdownnot-githubs-blog}{here} (linking to third-party render) or \href{https://gist.github.com/cyhsutw/d5983d166fb70ff651f027b2aa56ee4e}{here} (write \LaTeX{} code inside a \texttt{jupyter} notebook, for tips about \LaTeX{} and \texttt{jupyter} see \texttt{python} section, \ref{sec:python}, and/or \href{https://jupyterbook.org/content/math.html}{here})
        \end{itemize}
    \end{itemize}
  \item \texttt{grip}: \texttt{python}-based script which allows you to have a \texttt{GitHub} rendering of your documents (needs internet to send request for translation to \texttt{GitHub}).
  \item Draw graphs and charts with \href{https://mermaid-js.github.io/mermaid/#/}{\texttt{mermaid}}: all the info about syntax and configuration are in the link
    \begin{itemize}
      \item A \href{https://mermaid-js.github.io/mermaid-live-editor}{live editor}
    \end{itemize}
  \item Collapsed section: use html tags \texttt{<details>} and \texttt{<summary>}. Tested on \href{https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/organizing-information-with-collapsed-sections}{GitHub}
\begin{verbatim}
<details>

<summary>Tips for collapsed sections</summary>

### You can add a header

You can add text within a collapsed section.
You can add an image or a code block, too.

</details>
\end{verbatim}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{gnuplot}}
\begin{itemize}
  \item Keep the plot-windows open after closing the platform / having run the script: \verb|gnuplot --persist|
  \item Scripts: A script is just a sequence of \texttt{gnuplot} commands.
    \begin{itemize}
      \item There is no official extension, although the most common are: \texttt{gpi} (recognized by \texttt{vim}), \texttt{plt}, \texttt{gp}, \texttt{gnu}.
      \item To launch: \verb|gnuplot script.gpi| from terminal, or \verb|load 'script.gpi'| inside a \verb|gnuplot| session
    \end{itemize}
  \item Variables: simply \verb|var = 8.5|, or \verb|var = 'smth'|
  \item New figure: \verb|set term xterm <n>| where \verb|n| is the ID
  \item Basic plotting from file: e.g.\ use column 1 as x and 2 as y (mind \texttt{u} is equivalent to \texttt{using})
\begin{verbatim}
plot "file.dat" using 1:2 [options]
\end{verbatim}
  \item Size of the picture: \verb|set <width>,<height>|
  \item Multiple plots in the same picture. Usually, when executing \texttt{plot}, the old picture is cleared. To plot several curves separate them with a comma or use \verb|replot|. Indeed, the following
\begin{verbatim}
plot "file.dat" u 1:2 [options], "file2.dat" u 1:3 [options]
\end{verbatim}
    is equivalent to
\begin{verbatim}
plot "file.dat" u 1:2 [options]
replot "file2.dat" u 1:3 [options]
\end{verbatim}
  \item Subplots: \verb|set multiplot <n_rows>,<n_cols>| dispose the following plots in \verb|n_rows|$\times$\verb|n_cols| structure. Each \verb|plot|-like command will automatically switch to the following slot in the structure.
  \item Save:
    \begin{enumerate}
      \item Change terminal to the chosen output: \verb|set term postscript|, for \texttt{.ps} files. Use \texttt{png} for \texttt{.png} files instead. In this latter case, you can choose the size in pixels: \verb|set term png size 600,400|
      \item Choose name (according to the output): \verb|set output "plot.ps"|
      \item Plot into file: \verb|replot|
      \item Go back to initial terminal: \verb|set term x11|
    \end{enumerate}
  \item Column separator: for instance, with a \texttt{.csv} file one would use \verb|set datafile separator ','|
  \item Column names/headers: if columns has names/headers, you can use them instead of indices, using \verb|(column('name'))|. Yes, the brackets are necessary
\begin{verbatim}
plot file u (column('time')):(column('price'))
\end{verbatim}
  \item If a plot is already shown, and you run a \verb|set <cmd>| command, this will be active starting from the next \verb|plot|-like command only. Hence, you may want to run a \verb|replot| to update the figure with the new setting.
  \item Log scale: \verb!set log x|y!
  \item Plot title: \verb|set title 'Plot title'|
  \item Axis labels: \verb!set x|ylabel 'Label'!
  \item Legend:
    \begin{itemize}
      \item Deactivate: \verb|unset key| or \verb|set nokey|
      \item Place: \verb|set key <pos>| where \verb|pos| may assume: \verb|left top|,\ldots, \verb|outside|
      \item If columns have names and you want to use as legend labels: \texttt{set key autotitle columnhead}
    \end{itemize}
  \item Axis limits: \verb!set x|yrange [<min>:<max>]! or simply put \verb![<xmin>:<xmax>] [<ymin>:<ymax>]! after plot
  \item Color cycles: \verb!set colorsequence default|classic|podo!
  \item Loops: have a look \href{https://stackoverflow.com/a/18592561}{here} and \href{https://stackoverflow.com/a/14947085}{here}. From the first link (\verb|word| extract a word from a string)
\begin{verbatim}
colors = "red green #0000FF"
files = "file1 file2 file3"
plot for [i=1:words(files)] word(files, i).'.dat' lc rgb word(colors, i)
\end{verbatim}
\end{itemize}

Useful options of \texttt{plot}-like commands:
\begin{itemize}
  \item \verb!linecolor|lc!: e.g. \verb|lc "black"|. For more advance setting: \verb|linetype rgb "<parameters>"|
  \item \verb!with|w!: lines and marks \verb|linespoints|, lines/marks only \verb!lines|points!, \verb|impulses| (default: \verb|points| only)
  \item \verb|pointtype <n>| (or \verb|pt|): set style \texttt{n} for the point. There are also \verb|pointsize| (or \verb|ps|)
  \item \verb|title "<legend_entry>"|. If columns have names, \verb|title columnhead|
  \item \verb!linewidth|w!
  \item Solid/dashed lines: \verb|dashtype| or \verb|dt|
    \begin{itemize}
      \item \verb|dt N|: predefined type
      \item \verb|dt "<pattern>"|: custom pattern where \verb|pattern| is a combination of dots, hyphens, underscores and spaces
      \item ATTENTION: set dash type before giving line type: \verb|plot x:sin(x) dt 1 w linespoints|
    \end{itemize}
  \item Check out \verb!linetype|lt! too (doc \href{http://www.gnuplot.info/docs_4.2/node62.html}{here})
\end{itemize}

General coding tips:
\begin{itemize}
  \item Define variables: \verb|var="this_is_a_var"|, \verb|list="this is a list"|
  \item Concatenate, ``\texttt{.}'' (dot): \verb|"var holds '".var."'"|
  \item Number of words in a list: \verb|words(list)|
  \item Loops:
    \begin{itemize}
      \item General structure
\begin{verbatim}
do for [j=1:10] {
  # do something
}
\end{verbatim}
      \item Even inside commands: \verb|plot for [i=1:100] 'data'.i.'.dat' u 1:2 title 'Flow '.i|
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{R}}
\begin{itemize}
  \item Docs
    \begin{itemize}
      \item \texttt{R} \href{https://cran.r-project.org/manuals.html}{manuals}
      \item An \href{https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf}{intro} to \texttt{R}
      \item Other \href{https://www.r-project.org/other-docs.html}{docs}
      \item \href{https://www.rdocumentation.org/}{Browse} functions and packages
    \end{itemize}
  \item The \href{https://www.tidyverse.org/}{\texttt{tidyverse}}: a collection of useful library for data science. Here they are, find related cheat-sheets at the provided links
    \begin{itemize}
      \item \href{https://ggplot2.tidyverse.org/}{\texttt{ggplot2}}: plotting
      \item \href{https://dplyr.tidyverse.org/}{\texttt{dplyr}}: data manipulation
      \item \href{https://tidyr.tidyverse.org/}{\texttt{tidyr}}: create and manage tidy data
      \item \href{https://readr.tidyverse.org/}{\texttt{readr}}: utilities for reading data
      \item \href{https://purrr.tidyverse.org/}{\texttt{purrr}}: working with functions and vectors (basically, stuff as \verb|map()|)
      \item \href{https://tibble.tidyverse.org/}{\texttt{tibble}}: modern version of data sets
      \item \href{https://stringr.tidyverse.org/}{\texttt{stringr}}: working with strings
      \item \href{https://forcats.tidyverse.org/}{\texttt{forcats}}: working with factors
    \end{itemize}
  \item Install given version of package: from package \texttt{devtools} use, for instance,
\begin{verbatim}
install_version("ggplot2",version="0.9.1"[,repos="http://cran.us.r-project.org"])
\end{verbatim}
  \item \href{https://github.com/rstudio/reticulate}{\texttt{reticulate}}: get the best of \texttt{python} in \texttt{R}
  \item \texttt{R} is \textbf{1-based} (access first element of something with 1, \verb|a[1]|)
  \item Unload a package: \verb|detach('package:<pkg>', unload=TRUE)|
  \item \verb|cbind| / \verb|rbind|: combine by columns or rows, respectively
  \item Data frames:
    \begin{itemize}
      \item Extract rows - use positional index: \verb|row <- df[1:5,10:15]|
      \item Extract columns - use headers: as lists / vectors \verb|df$col1| (use dollar sign to access), as data frame \verb|cols <- data.frame(df$col1, df$col2)|
    \end{itemize}
  \item Statistical analysis
    \begin{itemize}
      \item An \href{https://cran.r-project.org/web/packages/HSAUR/vignettes/Ch_introduction_to_R.pdf}{intro} (well, at least a chapter)
      \item A cheat-sheet \href{https://www.dummies.com/programming/r/statistical-analysis-with-r-for-dummies-cheat-sheet/}{\emph{for dummies}}
    \end{itemize}
  \item Plotting and stuff: we will use \href{https://ggplot2.tidyverse.org/}{\texttt{ggplot2}}
    \begin{itemize}
      \item Basics:
\begin{verbatim}
plt <- ggplot(data = <data>) +
       <function>(mapping = aes(<args>)) [+
       <theme> [+ <color> [ +
       ggtitle('.') [+ xlab('.') [+ ylab('.')]]
       ]]]
plt
\end{verbatim}
        \begin{itemize}
          \item \verb|function| can be, for instance, \verb|geom_point| for scatter-plots, \verb|geom_boxplot|,\ldots
          \item \verb|aes| sets the aesthetic of the plot, for instance, \texttt{linetype}, \texttt{color}\ldots{} For instance, with scatter-plots, if you want to color the points according to a categorical variable \texttt{cat}, you can use \verb|color = cat|
          \item \verb|theme|: choose the theme of the current plot: \verb|theme_classic()|, \verb|theme_bw()|,\ldots
          \item \verb|color| sets additional colors, basically, \verb|scale_fill_manual| or \verb|scale_color_manual| according to the type of plot
          \item \verb|ggtitle|, \verb!x|ylab!: plot title and x/y labels
        \end{itemize}
      \item Colors: a couple of \href{http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually#change-colors-by-groups}{tutorials} with \href{https://www.datanovia.com/en/blog/ggplot-colors-best-tricks-you-will-love/}{examples}
      \item Themes: set and \href{https://bookdown.org/rdpeng/RProgDA/building-a-new-theme.html}{pimp} \href{https://ggplot2.tidyverse.org/reference/theme_get.html}{your theme} (all options \href{https://ggplot2.tidyverse.org/reference/theme.html}{here})
      \item Nice tricks about \href{http://www.sthda.com/english/wiki/ggplot2-scatter-plots-quick-start-guide-r-software-and-data-visualization}{scatter-plots}.
    \end{itemize}
  \item \texttt{Rstudio} is possibly the most well-known and used IDE for \texttt{R}
    \begin{itemize}
      \item The \texttt{notebook} mode provide a very handy way of working with \texttt{R}. It is really similar to the one proposed with \texttt{jupyter} and \texttt{python}. Indeed, one can add the \texttt{R} engine to \texttt{jupyter}. However, the \texttt{R}-notebooks use the \href{https://rmarkdown.rstudio.com/index.html}{\texttt{Rmarkdown}} language (here is a \href{https://raw.githubusercontent.com/rstudio/cheatsheets/master/rmarkdown-2.0.pdf}{cheat-sheet} and a \href{https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf}{reference guide}, both are also available in the \texttt{Help} tab of \texttt{Rstudio}), which is indeed similar to \texttt{markdown} (see \autoref{sec:markdown}).
      \item \texttt{Rmarkdown} and plots: plots are usually included in the rendering. However, issues may arise when plots are inside loops. In this case, force them to appear with a \verb|print| statement
      \item \href{https://support.rstudio.com/hc/en-us/articles/200713843?version=1.4.1717&mode=desktop}{Debugging} with \texttt{Rstudio}
\begin{verbatim}
for (i in 1:n) {
  plt <- <your_plot>
  print(plt)
}
\end{verbatim}
    \end{itemize}
  \item Read from any file: use \href{https://stat.ethz.ch/R-manual/R-devel/library/utils/html/read.table.html}{\texttt{read.table}}. One may choose between lots of options: \texttt{header}, \texttt{sep}, \texttt{dec}, \texttt{na.strings}, \texttt{comment.char},\ldots
  \item \href{https://stackoverflow.com/questions/46085274/is-there-a-string-formatting-operator-in-r-similar-to-pythons}{Formatting strings}
  \item \href{https://www.geeksforgeeks.org/printing-output-of-an-r-program/}{Several ways} of printing
  \item \href{https://www.datamentor.io/r-programming/factor/}{Factors}: a class for categorical variables
  \item Two packages may contain functions with the same names, hence the function from the most recently loaded package will prevail and mask the others. \href{https://stackoverflow.com/questions/39137110/what-does-the-following-object-is-masked-from-packagexxx-mean}{Here} is a brief explanation. See a work around to specify the function: \verb|<package>::foo|
  \item \verb|lapply(lst, foo[, args])|: apply to every element of list or vector \verb|lst| function \verb|foo| with arguments \verb|args| if provided / needed. It returns a list / vector with the same dimension as \verb|lst|. Linked functions:
    \begin{itemize}
      \item \verb|sapply|: more user-friendly version of \verb|lapply| returning vector, matrix or array
      \item \verb|vapply|: as \verb|sapply| but the return value will have a pre-defined type, the same as \verb|foo|
      \item An alternative is the \verb|map| function from \texttt{purrr}: \href{https://stackoverflow.com/questions/45101045/why-use-purrrmap-instead-of-lapply}{here} is a comparison. Basically, \verb|map| is more user-friendly, it is smart, meaning that it can interpret more compact inputs hence saving you some keystrokes, all the related functions are more consistent (among the \verb|*apply|-like functions, some has the function as first arguments, others the functions)
    \end{itemize}
\end{itemize}

\subsection{Notes on statistics and data analysis}
\begin{itemize}
  \item QQ-plots and how to analyze them: \href{https://www.ucd.ie/ecomodel/Resources/QQplots_WebVersion.html}{here}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Computer Vision with \texttt{OpenCV}}
\texttt{OpenCV} is available for \texttt{C}, \texttt{python}, \texttt{Java}, and even \texttt{Android}. We'll try to be consistent and use \texttt{python} code examples, however, some of the provided links may concern other languages. In any case, the tip will give the function to use and, if it is not the language of your predilection, you just have to adapt the call to the function to the language. In fact, most of the time, we deal with general question about computer vision and not with the subtleties of a particular implementation.

Another popular computer vision \texttt{python} library is \href{https://scikit-image.org/}{\texttt{scikit-image}}.

\begin{itemize}
  \item Docs and tutorials:
    \begin{itemize}
      \item \href{https://docs.opencv.org/3.4/index.html}{Official documentation} with tutorials and Doxygen with all functions
        \begin{itemize}
          \item There are also nice \href{https://opencv24-python-tutorials.readthedocs.io/en/latest/index.html}{\texttt{ReadTheDocs} tutorials}. It dates back to 2016, but the general and basic ideas remains the same.
        \end{itemize}
      \item O'Reilly books
        \begin{itemize}
          \item \href{https://www.bogotobogo.com/cplusplus/files/OReilly%20Learning%20OpenCV.pdf}{With \texttt{C}}
            \item \href{http://programmingcomputervision.com/downloads/ProgrammingComputerVision_CCdraft.pdf}{With \texttt{python}} (draft)
        \end{itemize}
      \item \href{https://www.pyimagesearch.com/}{\texttt{pyimagesearch}}: it is one of the best and well-known pages online for learning and working with computer vision problems (included machine learning techniques applied to vision applications)
        \begin{itemize}
          \item You may want to check put its \texttt{python} library, \href{https://github.com/jrosebr1/imutils}{\texttt{imutils}} which simplifies using \texttt{OpenCV}
        \end{itemize}
      \item \href{https://www.geeksforgeeks.org/}{\texttt{GeeksForGeeks}} has nice tutorials on \texttt{OpenCv}
    \end{itemize}
  \item The bases. \texttt{OpenCV} images are simply \texttt{numpy} matrices where each element of the matrix correspond to a pixel. However, there are some things that are worth mentioning explicitly. Let \texttt{W} and \texttt{H} be, respectively, the width and height in pixels of an image:
    \begin{itemize}
      \item The origin, the pixel (0, 0), is the top left corner of the image
      \item The vertical direction, let's call it \texttt{y}, grows downwards: \texttt{y=0} corresponds to top edge, \texttt{y=H} corresponds to the bottom edge
      \item \texttt{x} and \texttt{y} coordinates are switched, hence: \verb|im[y,x,:]|
      \item For one-channel images (e.g.\ gray scale), the matrix dimension is 2, that means that the shape is \texttt{(H,W)}; for \texttt{RGB} (however, see below) and \texttt{HSV} is 3, last dimension being 3, that means that the shape is \texttt{(H,W,3)}.
      \item \texttt{OpenCV} uses \texttt{BGR} instead of the \emph{usual} \texttt{RGB} structure. Hence, if you want to use \texttt{matplotlib} to show an image, one should convert it, here are two possible ways to perform the conversion
\begin{verbatim}
# Use OpenCV functions
img_cvt = cv.cvtColor(img, cv.COLOR_BGR2RGB)
# Use python: inverse order of last dimensionim[:,:,::-1]
img_cvt = im[:,:,::-1]
\end{verbatim}
      \item Extract the green channel of an image: \verb|green = im[:,:,1]|. Use \texttt{0} for blue, or \texttt{2} for red
      \item Crop an image: simply use \texttt{numpy} slices
\begin{verbatim}
crop = im[y_0:y_1, x_0:x_1, :]
\end{verbatim}
      \item \texttt{GBR} formats accepts values in $[0,\,255]^3$, \texttt{HSV} in $[0,\,120]\times[0,\,255]\times[0,\,255]$
      \item The type of an element of a standard image is \verb|numpy.uint8|
    \end{itemize}
  \item \href{https://docs.opencv.org/4.5.2/d9/d61/tutorial_py_morphological_ops.html}{Morphological transformations}: erosion (separate zones), dilation (merge zones), opening (erosion then dilation), closing (dilation then erosion),\ldots
  \item Thresholding: roughly speaking, in its simplest case, one chooses a threshold \texttt{T}, then all pixels with values less than \texttt{T} are set to \texttt{0}, the others to a user-defined value. See \href{https://docs.opencv.org/3.4/db/d8e/tutorial_threshold.html}{these} \href{https://www.pyimagesearch.com/2021/04/28/opencv-thresholding-cv2-threshold/}{three} \href{https://www.pyimagesearch.com/2021/05/12/adaptive-thresholding-with-opencv-cv2-adaptivethreshold/}{tutorials}.
\begin{verbatim}
# Simplest thresholding
T = 125; final_value = 255
_, th = cv.threshold(im, T, final_value, cv.THRESH_BINARY)
\end{verbatim}
  \item Color-range--based segmentation. We give the rule of thumb for using \texttt{inRange} as presented in the \href{https://docs.opencv.org/3.1.0/df/d9d/tutorial_py_colorspaces.html}{tutorials}: let \texttt{clr[RGB]} (or whatever other color code) the target color; transform it into \texttt{HSV}, \texttt{clr[HSV]} (usually, it has full \texttt{S} and \texttt{V} values, which in \texttt{OpenCV} translates to 255: for instance \texttt{blue[HSV]=[120,255,255]}); then use as lower bound \texttt{[clr[HSV][H]-D, L, L]} and as upper bound \texttt{[clr[HSV][H]+D, 255, 255]} with \texttt{D=10} and \texttt{L=50}. You may adjust \texttt{D} and \texttt{L}.
\begin{verbatim}
clr = cv.cvtColor(np.uint8([[[R,G,B]]]), cv.COLOR_RGB2HSV)
D = 10; L = 100
lower = np.uint8([clr[0,0,0]-D,  L,  L])
upper = np.uint8([clr[0,0,0]+D,255,255])
# Segmentation
mask = cv.inRange(hsv.copy(), lower, upper)
\end{verbatim}
    \begin{itemize}
      \item Red colors can be hard to extract, see for instance \href{https://stackoverflow.com/a/32523532}{here}
      \item Segmentation with black and white can be a little tricky. One may try to use simple thresholding, otherwise see this \href{https://stackoverflow.com/a/25401596}{answer}.
    \end{itemize}
  \item Histogram and histogram / lighting correction: see \href{https://docs.opencv.org/4.5.0/d5/daf/tutorial_py_histogram_equalization.html}{here}
    \begin{itemize}
      \item Histogram equalization, \verb|equalizeHist| works globally on the image. Sometimes, the results does not meet the expectations
      \item CLAHE works locally, on a small windows, \verb|createCLAHE([clip,tile])|. The results are often more natural than those obtained with the histogram equalization. CLAHE needs two parameters: the tile is the window, the clip is a threshold. If an histogram bin is above this limit, the related pixels are redistributed uniformly.
    \end{itemize}
  \item Intensity transformation: see \href{https://www.geeksforgeeks.org/python-intensity-transformation-operations-on-images/}{here} and \href{https://docs.opencv.org/4.5.0/dc/dfe/group__intensity__transform.html}{here} for the functions already included in \texttt{OpenCV} but only in \texttt{C}
  \item Example of image matching and alignment: \href{https://www.pyimagesearch.com/2020/08/31/image-alignment-and-registration-with-opencv/}{here}
  \item Camera calibration:
    \begin{itemize}
      \item Simple camera calibration, that is, for instance, fix lens deformations: use chessboard and/or AruCo, see basic stuff, insights and small tutorial \href{https://docs.opencv.org/master/dc/dbb/tutorial_py_calibration.html}{here}
      \item Fisheye cameras is trickier. Have a look at this \href{https://medium.com/@kennethjiang/calibrate-fisheye-lens-using-opencv-333b05afa0b0}{medium post}, this \href{https://docs.opencv.org/3.2.0/dd/d12/tutorial_omnidir_calib_main.html}{tutorial} but also this \href{https://stackoverflow.com/a/53500300}{SO answer} (and its referenced \href{http://paulbourke.net/dome/fish2/}{link})
    \end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\texttt{ImageJ} - \texttt{Fiji}}
\texttt{ImageJ} is a \texttt{Java}-based image processing program especially adapted to scientific researches. \texttt{Fiji} Is Just \texttt{ImageJ}, with many many plugins (you are advised to use this latter). Just a couple of tools that I have used (so that I don't forget them)
\begin{itemize}
  \item Rotate: \texttt{Image > Transform > Rotate}
  \item Set origin: usually the origin (the point (0,0)) is the upper left corner of the image. You can however change it: \texttt{Image > Transform > Properties > Origin} (do you need the \texttt{Global} case?)
  \item Since the origin point is by default at the top of the image, the y axis, that is the vertical one, has positive values towards the bottom. Sometimes is destabilizing. Change it with \texttt{Analyze > Set measurements > Invert y}
  \item Set a dimension scale from a part of the image whose dimension is known: draw a line than \texttt{Analyze > Set scale}
  \item Perspective: \texttt{Plugins > Transform > Interactive perspective}
  \item Make points from two different images correspond. Consider this. You have some photo of the same thing but you are a bad photographer and all the pictures have their own perspective and angle. Well, choose a reference photo than make all the other correspond to it with \texttt{Plugins > Transform > Landscape correspondences}
  \item Macros: in order to automate your process, you may write your own macros. See \texttt{Plugins > Macros > [...]}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%      SECTION      %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Miscellaneous}
\label{sec:misc}
\begin{itemize}
  \item{} [Linux] Add personal apps to regular menu: It comes down to create \texttt{your\_app.desktop} file in \url{~/.local/share/applications}. You can get inspiration from other similar files that are already there or in \url{/usr/share/applications}. Another idea is to use the user-interface \texttt{alacarte}, see \href{https://askubuntu.com/questions/79583/adding-custom-applications-to-gnome-3-launcher}{here}: this produces a \texttt{.desktop} file, usually the name is little something like \texttt{alacarte-n.desktop}, so it might be hard to see which file corresponds to which app.
  \item \texttt{PETSc} \href{https://www.mcs.anl.gov/petsc/petsc-current/docs/manual.pdf}{manual}
    \begin{itemize}
      \item Use \verb|MatView(Mat a, PETSC_VIEWER_DRAW_WORLD)| or with any another \texttt{PetscViewer} to draw the nonzero structure of a matrix.
    \end{itemize}
  \item Create QR-codes: \href{https://www.qrcode-monkey.com/}{here} is a pretty simple, 100\% free and highly customizable QR-code generator.
\end{itemize}

\appendix
\begin{lstlisting}[language=bash,numbers=left,float,frame=single,caption={script.sh, an example for \texttt{getopts}},label={lst:getopt_ex},numberfirstline=true,stepnumber=5,firstnumber=1]
#!/bin/bash

usage () {
  echo "Usage: script.sh [ -p prefix ] [ -s suffix ]"
}

prfx=""
sffx=""

OPTIND=1 # Variable used by getopts, reset if it has already been used

while getopts ":hp:s:" opt; do
  case "${opt}" in
    h )
      usage
      exit 0
      ;;
    p )
      prfx=${OPTARG}
      ;;
    s )
      sffx=${OPTARG}
      ;;
    : )
      echo "-${OPTARG}: An argument is required" 1>&2
      usage
      exit 1
      ;;
    \? )
      echo "-${OPTARG}: Unknown option" 1>&2
      usage
      exit 1
      ;;
  esac
done

shift $((OPTIND-1)) # Shift processed options

echo "PFX = ${prfx}"
echo "SFX = ${sffx}"
\end{lstlisting}

\end{document}

